<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Modelado Bayesiano - 6&nbsp; Regresión lineal</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./06_Generalizando_modelos_lineales.html" rel="next">
<link href="./04_Diagnóstico_MCMC.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="citation_title" content="[6]{.chapter-number}&nbsp; [Regresión lineal]{.chapter-title}">
<meta name="citation_publication_date" content="2023-04-21">
<meta name="citation_cover_date" content="2023-04-21">
<meta name="citation_year" content="2023">
<meta name="citation_doi" content="https://doi.org/10.5281/zenodo.7851296">
<meta name="citation_language" content="es">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Regresión lineal</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Modelado Bayesiano</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="" title="github" id="sidebar-tool-dropdown-0" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-github"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-0">
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/Grupo-de-modelado-probabilista/Modelado_Bayesiano">
          Fuente
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/Grupo-de-modelado-probabilista/Modelado_Bayesiano/issues/new">
          Reportar errores
          </a>
        </li>
    </ul>
    <a href="https://cafecito.app/aloctavodia" title="donaciones" class="sidebar-tool px-1"><i class="bi bi-cup"></i></a>
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle sidebar-tool" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">‎</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00_Probabilidad.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Probabilidad</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_Inferencia_Bayesiana.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Inferencia Bayesiana</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_Programación_probabilística.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Programación probabilista</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_Modelos_jerárquicos.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Modelado Jerárquico</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_Diagnóstico_MCMC.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Diagnóstico del muestreo</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_Regresión_lineal.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Regresión lineal</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_Generalizando_modelos_lineales.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Regresión polinomial</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_Comparación_de_modelos.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Comparación de modelos</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#la-idea-central-en-regresión-lineal" id="toc-la-idea-central-en-regresión-lineal" class="nav-link active" data-scroll-target="#la-idea-central-en-regresión-lineal"><span class="toc-section-number">6.1</span>  La idea central en regresión lineal</a></li>
  <li><a href="#bicicletas-lineales" id="toc-bicicletas-lineales" class="nav-link" data-scroll-target="#bicicletas-lineales"><span class="toc-section-number">6.2</span>  Bicicletas lineales</a>
  <ul class="collapse">
  <li><a href="#interpretando-la-media-a-posteriori" id="toc-interpretando-la-media-a-posteriori" class="nav-link" data-scroll-target="#interpretando-la-media-a-posteriori"><span class="toc-section-number">6.2.1</span>  Interpretando la media a posteriori</a></li>
  <li><a href="#interpretando-las-predicciones-a-posteriori" id="toc-interpretando-las-predicciones-a-posteriori" class="nav-link" data-scroll-target="#interpretando-las-predicciones-a-posteriori"><span class="toc-section-number">6.2.2</span>  Interpretando las predicciones a posteriori</a></li>
  </ul></li>
  <li><a href="#generalizando-el-modelo-lineal" id="toc-generalizando-el-modelo-lineal" class="nav-link" data-scroll-target="#generalizando-el-modelo-lineal"><span class="toc-section-number">6.3</span>  Generalizando el modelo lineal</a></li>
  <li><a href="#generalizando-el-modelo-lineal-para-datos-de-conteo" id="toc-generalizando-el-modelo-lineal-para-datos-de-conteo" class="nav-link" data-scroll-target="#generalizando-el-modelo-lineal-para-datos-de-conteo"><span class="toc-section-number">6.4</span>  Generalizando el modelo lineal para datos de conteo</a></li>
  <li><a href="#regresión-robusta" id="toc-regresión-robusta" class="nav-link" data-scroll-target="#regresión-robusta"><span class="toc-section-number">6.5</span>  Regresión robusta</a></li>
  <li><a href="#regresión-logística" id="toc-regresión-logística" class="nav-link" data-scroll-target="#regresión-logística"><span class="toc-section-number">6.6</span>  Regresión logística</a></li>
  <li><a href="#el-modelo-logístico-aplicado-al-conjunto-de-datos-del-iris." id="toc-el-modelo-logístico-aplicado-al-conjunto-de-datos-del-iris." class="nav-link" data-scroll-target="#el-modelo-logístico-aplicado-al-conjunto-de-datos-del-iris."><span class="toc-section-number">6.7</span>  El modelo logístico aplicado al conjunto de datos del iris.</a></li>
  <li><a href="#clasificación-con-regresión-logística" id="toc-clasificación-con-regresión-logística" class="nav-link" data-scroll-target="#clasificación-con-regresión-logística"><span class="toc-section-number">6.8</span>  Clasificación con regresión logística</a></li>
  <li><a href="#interpretación-de-los-coeficientes-de-una-regresión-logística" id="toc-interpretación-de-los-coeficientes-de-una-regresión-logística" class="nav-link" data-scroll-target="#interpretación-de-los-coeficientes-de-una-regresión-logística"><span class="toc-section-number">6.9</span>  Interpretación de los coeficientes de una regresión logística</a></li>
  <li><a href="#varianza-variable" id="toc-varianza-variable" class="nav-link" data-scroll-target="#varianza-variable"><span class="toc-section-number">6.10</span>  Varianza variable</a></li>
  <li><a href="#regresión-lineal-jerárquica" id="toc-regresión-lineal-jerárquica" class="nav-link" data-scroll-target="#regresión-lineal-jerárquica"><span class="toc-section-number">6.11</span>  Regresión lineal jerárquica</a></li>
  <li><a href="#ejercicios" id="toc-ejercicios" class="nav-link" data-scroll-target="#ejercicios"><span class="toc-section-number">6.12</span>  Ejercicios</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Regresión lineal</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<blockquote class="blockquote">
<p>En más de tres siglos de ciencia todo ha cambiado excepto tal vez una cosa: a amor por lo simple. - Jorge Wagensberg</p>
</blockquote>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> arviz <span class="im">as</span> az</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">import</span> pymc <span class="im">as</span> pm</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="im">from</span> scipy.stats <span class="im">import</span> linregress</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="im">from</span> scipy.special <span class="im">import</span> expit <span class="im">as</span> logistic</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="im">from</span> scipy.interpolate <span class="im">import</span> PchipInterpolator</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="im">import</span> xarray <span class="im">as</span> xr</span>
<span id="cb1-10"><a href="#cb1-10"></a></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="im">import</span> warnings</span>
<span id="cb1-12"><a href="#cb1-12"></a>warnings.simplefilter(action<span class="op">=</span><span class="st">'ignore'</span>, category<span class="op">=</span><span class="pp">FutureWarning</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a>plt.style.use(<span class="st">'arviz-doc'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La música, ya sea la Suite para violonchelo N° 1 de Bach, <em>el pibe cantina</em> de damas gratis o Libertango de Piazzolla, se construye con patrones recurrentes. Las mismas escalas, progressiones de acordes, riffs, etc. aparecen una y otra vez dando lugar a un maravilloso paisaje sonoro capaz de provocar y modular toda la gama de emociones humanas. De manera similar, el universo estadístico está compuesto de patrones recurrentes, pequeños motivos que aparecen una y otra vez. En este capítulo, vamos a ver uno de los más populares y útiles de ellos, el modelo lineal. Este es un modelo muy útil en sí mismo y también el componente básico de muchos otros modelos. Es probable que algunos de los siguientes términos te resulten familiares: regresión lineal simple, regresión múltiple, regresión logística, ANOVA, ANCOVA. Todos estos métodos son variaciones del mismo motivo subyacente, el modelo de regresión lineal. En este capítulo, cubriremos los siguientes temas:</p>
<ul>
<li>Regresión lineal simple</li>
<li>Regresión lineal robusta</li>
<li>Regresión jerárquica</li>
<li>Regresión polinomial</li>
<li>Regresión múltiple</li>
<li>Interacciones</li>
<li>Varianza variable</li>
</ul>
<p>Supongamos que tenemos una variable <span class="math inline">\(X\)</span>, y a partir de esta queremos predecir o modelar una variable <span class="math inline">\(Y\)</span>. Además, estás variables se encuentran apareadas ${(x_1,y_1), (x_2,y_2),(x_n,y_n)} $. En el caso más simple <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> son variables aleatorias continuas y unidimensionales, usando un lenguaje de programación, como Python, las representaríamos usando <em>arrays</em> de dimensión 1 y de tipo flotante.</p>
<p>Las variable <span class="math inline">\(Y\)</span> suele recibir distintos nombres como variable dependiente, predicha o respuesta, mientras que <span class="math inline">\(X\)</span> recibe nombres como variable independiente, predictora o <em>de entrada</em>. En <em>Machine learning</em> es común hablar de <em>features</em> en vez de variables y es común pensar que una regresión lineal es un ejemplo de <a href="https://es.wikipedia.org/wiki/Aprendizaje_supervisado">aprendizaje supervisado</a>.</p>
<p>Algunas situaciones típicas en las que se pueden utilizar modelos de regresión lineal:</p>
<ul>
<li><p>Modelar la relación entre la salinidad del suelo y la productividad de los cultivos. Luego, responder preguntas como: ¿Es la relación lineal? ¿Qué tan fuerte es esta relación?</p></li>
<li><p>Encuentrar una relación entre el consumo promedio de chocolate por país y el número de premios Nobel en ese país, y luego comprender por qué esta relación es probablemente espuria.</p></li>
<li><p>Predecir la factura de gas de una casa utilizando la radiación solar del informe meteorológico local. ¿Qué tan precisa es esta predicción?</p></li>
</ul>
<section id="la-idea-central-en-regresión-lineal" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="la-idea-central-en-regresión-lineal"><span class="header-section-number">6.1</span> La idea central en regresión lineal</h2>
<p>En un capítulo previo vimos el modelo normal, que (omitiendo las distribuciones a priori) definimos como:</p>
<p><span class="math display">\[
Y \sim \mathcal{N}(\mu, \sigma)
\]</span></p>
<p>La idea central de la regresión lineal es extender este modelo, agregando una variable predictora <span class="math inline">\(X\)</span> a la estimación de la media <span class="math inline">\(\mu\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
\mu = \alpha + \beta X \\
Y &amp;\sim \mathcal{N}(\mu, \sigma)
\end{aligned}
\]</span></p>
<p>Este modelo dice que existe una relación lineal entre la variable <span class="math inline">\(X\)</span> y la variable <span class="math inline">\(Y\)</span>. Pero esa relación no es determinista, debido al término de ruido <span class="math inline">\(\sigma\)</span>. Además, el modelo dice que la media de <span class="math inline">\(Y\)</span> es una función lineal de <span class="math inline">\(X\)</span>, con <strong>intercepto</strong> <span class="math inline">\(\alpha\)</span> y <strong>pendiente</strong> <span class="math inline">\(\beta\)</span>. El intercepto nos dice el valor de <span class="math inline">\(Y\)</span> cuando <span class="math inline">\(X=0\)</span>, la pendiente nos dice el cambio en <span class="math inline">\(Y\)</span> por unidad de cambio en <span class="math inline">\(X\)</span>. Debido a que no conocemos los valores de <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span> o <span class="math inline">\(\sigma\)</span>, debmos determinar una distribución a priori para estos parámetros.</p>
<p>Una suposición típica cuando se establecen priors para modelos lineales es suponer que son independientes. Esta suposición simplifica enormemente la elección de priors, ya que en vez de definir una dristribución conjunta para los 3 parámetros, podemos definir 3 distribuciones por separado. Al menos en principio, <span class="math inline">\(\alpha\)</span> y <span class="math inline">\(\beta\)</span> pueden tomar cualquier valor en los reales, por lo que es común usar a prioris normales para ellos. En cambio <span class="math inline">\(\sigma\)</span> debe ser un número positivo, por lo que es común usar distribuciónes como seminormal, exponencial, gamma-inversa, etc.</p>
<p>Los valores que puede tomar el intercepto pueden variar mucho de un problema a otro. Por ejemplo, yo solía trabajar con problemas donde era esperable que <span class="math inline">\(\alpha\)</span> estuviera alrededor de cero y con una desviación estándar muy por debajo de 1. Pero esta experiencia (casi anecdótica) es dificil de trasladar a cualquier otro problema. Con respecto a la pendiente (<span class="math inline">\(\beta\)</span>), puede ser más fácil tener una noción informada. Usualmente tenemos una idea del signo de la pendiente, por ejemplo esperamos que el peso de un animal aumente, en promedio, con la variable largo (o altura). Para <span class="math inline">\(\sigma\)</span>, podemos establecerlo en un valor grande en la escala de la variable <span class="math inline">\(Y\)</span>, por ejemplo, 2 veces el valor de su desviación estándar. Debemos tener cuidado al usar los datos observados para estimar a prioris, por lo general, está bien si los datos se usan para evitar el uso de a prioris muy restrictivos. Si no tenemos demasiado conocimiento del parámetro, tiene sentido asegurarse que la distribución a priori sea realmente vaga. En cambio, si queremos definir distribuciones a priori más informativas, entonces no deberíamos obtener esa información de los datos observados, sino que deberíamos obtenerla de nuestro conocimiento del dominio.</p>
</section>
<section id="bicicletas-lineales" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="bicicletas-lineales"><span class="header-section-number">6.2</span> Bicicletas lineales</h2>
<p>Ahora que tenemos una idea general de cómo luce un modelo lineal Bayesiano, tratemos de cimentar esta idea con un ejemplo.</p>
<p>Vamos a empezar muy sencillo, tenemos un registro de temperaturas y del número de bicicletas alquiladas en una ciudad. Queremos modelar la relación entre la temperatura y el número de bicicletas alquiladas. Usaremos <a href="https://archive.ics.uci.edu/ml/datasets/bike+sharing+dataset">bike-sharing dataset</a> del repositorio <a href="https://archive.ics.uci.edu/ml/index.php">UCI Machine Learning Repository</a>. El conjunto de datos original contiene 17379 registros, cada registro tiene 17 variables, pero para este ejemplo usaremos tan solo 348 registros y dos variables <code>temperatura</code> y <code>alquiladas</code>. La variable ‘temperatura’ es la temperatura en Celsius y ‘alquiladas’ es el número de bicicletas alquiladas.</p>
<p>Carguemos los datos y grafiquémoslos</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a>bicis <span class="op">=</span> pd.read_csv(<span class="st">"datos/bicis.csv"</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a>bicis.plot(x<span class="op">=</span><span class="st">"temperatura"</span>, y<span class="op">=</span><span class="st">"alquiladas"</span>, kind<span class="op">=</span><span class="st">"scatter"</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="05_Regresión_lineal_files/figure-html/cell-4-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Construyamos un modelo lineal bayesiano para estos datos. La temperatura será nuestra variable independiente (nuestra “X”) y el número de bicicletas alquiladas será nuestra variable dependiente (nuestra “Y”). Vamos a utilizar el siguiente modelo:</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="cf">with</span> pm.Model() <span class="im">as</span> modelo_bl:</span>
<span id="cb4-2"><a href="#cb4-2"></a>    α <span class="op">=</span> pm.Normal(<span class="st">'α'</span>, mu<span class="op">=</span><span class="dv">0</span>, sigma<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb4-3"><a href="#cb4-3"></a>    β <span class="op">=</span> pm.Normal(<span class="st">'β'</span>, mu<span class="op">=</span><span class="dv">0</span>, sigma<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb4-4"><a href="#cb4-4"></a>    σ <span class="op">=</span> pm.HalfCauchy(<span class="st">'σ'</span>, <span class="dv">10</span>)</span>
<span id="cb4-5"><a href="#cb4-5"></a>    μ <span class="op">=</span> pm.Deterministic(<span class="st">'μ'</span>, α <span class="op">+</span> β <span class="op">*</span> bicis.temperatura)</span>
<span id="cb4-6"><a href="#cb4-6"></a>    _ <span class="op">=</span> pm.Normal(<span class="st">'y_pred'</span>, mu<span class="op">=</span>μ, sigma<span class="op">=</span>σ, observed<span class="op">=</span>bicis.alquiladas)</span>
<span id="cb4-7"><a href="#cb4-7"></a></span>
<span id="cb4-8"><a href="#cb4-8"></a>pm.model_to_graphviz(modelo_bl)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<p><img src="05_Regresión_lineal_files/figure-html/cell-5-output-1.svg" class="img-fluid"></p>
</div>
</div>
<p>Antes de calcular la distribución a posteriori tomemos un momento para leer el código línea por línea y asegurarnos de entender lo que está pasando. Comparemos el código con la representación visual del modelo.</p>
<p>Como ya dijimos, este modelo es similar a un modelo normal, la diferenciea principal es que la media se modela como una función lineal de la temperatura. El intercepto es <span class="math inline">\(\alpha\)</span> y la pendiente es <span class="math inline">\(\beta\)</span>. El término de ruido es <span class="math inline">\(\sigma\)</span> y la media es <span class="math inline">\(\mu\)</span>.</p>
<p>Algo importante a notar es que la variable <span class="math inline">\(\mu\)</span> es una variable determinista (<code>pm.Deterministic</code>). Le llamamos así ya que una vez conocidos los valores de <span class="math inline">\(\alpha\)</span> y <span class="math inline">\(\beta\)</span>, el valor de <span class="math inline">\(\mu\)</span> queda determinado. En vez que <code>μ = pm.Deterministic('μ', α + β * bikes.temperatura)</code> podríamos haber escrito <code>μ = α + β * bicicletas.temperatura</code> o incluso <code>_ = pm.Normal('y_pred', mu=α + β * bicicletas.temperatura, sigma=ϵ, observado=bicicletas.alquiladas)</code> y el modelo sería el mismo. La única razón de usar <code>pm.Deterministic</code>, es que de esta forma le pedimos a PyMC que guarde los valores de <span class="math inline">\(\mu\)</span> en el InferenceData.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a><span class="cf">with</span> modelo_bl:</span>
<span id="cb5-2"><a href="#cb5-2"></a>    idata_bl <span class="op">=</span> pm.sample(random_seed<span class="op">=</span><span class="dv">123</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [α, β, σ]</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="8000" class="" max="8000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [8000/8000 00:03&lt;00:00 Sampling 4 chains, 0 divergences]
    </div>
    
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 4 seconds.</code></pre>
</div>
</div>
<p>Veamos un trace plot de <code>idata_bl</code> combinando todas las cadenas en una sola curva</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a>az.plot_trace(idata_bl, combined<span class="op">=</span><span class="va">True</span>)<span class="op">;</span>  </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="05_Regresión_lineal_files/figure-html/cell-7-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Algo que suele resultar confuso o inesperado para muchos estudiantes es la gráfica para <span class="math inline">\(\mu\)</span>, por qué hay tantas curvas? Porque a cada observaciones le corresponde una curva, para cáda valor de <span class="math inline">\(X\)</span>, hacemos</p>
<p><span class="math display">\[
\mu_i = \alpha + \beta + x_i
\]</span></p>
<p>Es decir un valor de <span class="math inline">\(\mu\)</span> por cada valor de <span class="math inline">\(X\)</span>, además como <span class="math inline">\(\alpha\)</span> y <span class="math inline">\(\beta\)</span> son distribuciones. Entonces cada <span class="math inline">\(\mu_i\)</span> es también una distribución.</p>
<p>Podemos comprobar que hay 348 distribuciones para mu inspeccionado el InfereceData, por ejemplo:</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a>cadenas, muestras, mus <span class="op">=</span> idata_bl.posterior[<span class="st">"μ"</span>].shape</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="ss">f"</span><span class="sc">{</span>cadenas<span class="op">=</span><span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>muestras<span class="op">=</span><span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>mus<span class="op">=</span><span class="sc">}</span><span class="ss">"</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>'cadenas=4, muestras=1000, mus=348'</code></pre>
</div>
</div>
<section id="interpretando-la-media-a-posteriori" class="level3" data-number="6.2.1">
<h3 data-number="6.2.1" class="anchored" data-anchor-id="interpretando-la-media-a-posteriori"><span class="header-section-number">6.2.1</span> Interpretando la media a posteriori</h3>
<p>Habiendo aclarado este punto vamos a focalizarnos en intepretar los parámetros del modelo, pero omitiendo <code>μ</code>. Hagamos un gráfico de las distribuciones a posteriori marginales para <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span> y <span class="math inline">\(\sigma\)</span>,</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a>az.plot_posterior(idata_bl, var_names<span class="op">=</span>[<span class="st">'~μ'</span>], figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">3</span>))<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="05_Regresión_lineal_files/figure-html/cell-9-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Si solo leemos las medias de cada distribución podemos decir que <span class="math inline">\(\mu = 69 + 7,9 X\)</span>. Con esta información podemos decir que el valor esperado de bicicletas alquiladas cuando la temperatura es 0 es de 69 y por cada grado de temperatura el número de bicicletas alquiladas aumenta en 7,9. Así que para una temperatura de 28 grados esperamos alquilar <span class="math inline">\(69 + 7.9 * 28 \approx 278\)</span> bicicletas. Esta es nuestro valor esperado, pero la distribución a posteriori también nos informa sobre la incertidumbre en torno a esta estimación. Por ejemplo, el HDI 94% para <span class="math inline">\(\beta\)</span> es (6,1, 9,7), por lo que por cada grado de temperatura el número de bicicletas alquiladas podría aumentar de 6 a unas 10.</p>
<p>Incluso si omitimos la incertidumbre a posteriori, y solo prestaramos atención a las medias, tenemos incertidumbre sobre el número de bicicletas alquiladas debido al valor de <span class="math inline">\(\sigma\)</span> de 170. Entonces, si decimos que para una temperatura de 28 grados, esperamos alquilar 278 bicicletas, no debería sorprendernos que el número real resulte estar entre <span class="math inline">\(\approx 100\)</span> y <span class="math inline">\(\approx 500\)</span> bicicletas.</p>
<p>Ahora vamos a crear algunas gráficas que nos ayudarán a visualizar la incertidumbre combinada de estos parámetros. En una primer lectura recomiendo saltearse el código y focalizarse en las figuras y su interpretación.</p>
<p>La siguiente figura tiene dos paneles. Ambos muestran del número medio de bicicletas alquiladas en función de la temperatura. La diferencia está en como se representa la incertidumbre. Para el panel izquierdo, tomamos 50 muestras de la distribución a posteriori de <span class="math inline">\(\mu\)</span> y las dibujamos como líneas individuales. Para el panel derecho tomamos todas las muestras a posteriori de <span class="math inline">\(\mu\)</span> y las usamos para calcular el HDI 94%.</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a>posterior <span class="op">=</span> az.extract(idata_bl, num_samples<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb12-2"><a href="#cb12-2"></a>x_plot <span class="op">=</span> xr.DataArray(np.linspace(bicis.temperatura.<span class="bu">min</span>(), bicis.temperatura.<span class="bu">max</span>(), <span class="dv">50</span>), dims<span class="op">=</span><span class="st">"plot_id"</span>)</span>
<span id="cb12-3"><a href="#cb12-3"></a>linea_media <span class="op">=</span> posterior[<span class="st">'α'</span>].mean() <span class="op">+</span> posterior[<span class="st">'β'</span>].mean() <span class="op">*</span> x_plot</span>
<span id="cb12-4"><a href="#cb12-4"></a>lineas <span class="op">=</span> posterior[<span class="st">'α'</span>] <span class="op">+</span> posterior[<span class="st">'β'</span>] <span class="op">*</span> x_plot</span>
<span id="cb12-5"><a href="#cb12-5"></a>hdi_lines <span class="op">=</span> az.hdi(idata_bl.posterior[<span class="st">'μ'</span>])</span>
<span id="cb12-6"><a href="#cb12-6"></a></span>
<span id="cb12-7"><a href="#cb12-7"></a></span>
<span id="cb12-8"><a href="#cb12-8"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">4</span>), sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-9"><a href="#cb12-9"></a>axes[<span class="dv">0</span>].plot(bicis.temperatura, bicis.alquiladas,  <span class="st">'.'</span>, color<span class="op">=</span><span class="st">"0.75"</span>,  zorder<span class="op">=-</span><span class="dv">3</span>)</span>
<span id="cb12-10"><a href="#cb12-10"></a>lines_ <span class="op">=</span> axes[<span class="dv">0</span>].plot(x_plot, lineas.T, c<span class="op">=</span><span class="st">'C1'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, label<span class="op">=</span><span class="st">'lineas'</span>)</span>
<span id="cb12-11"><a href="#cb12-11"></a>plt.setp(lines_[<span class="dv">1</span>:], label<span class="op">=</span><span class="st">"_"</span>)</span>
<span id="cb12-12"><a href="#cb12-12"></a>axes[<span class="dv">0</span>].plot(x_plot, linea_media, c<span class="op">=</span><span class="st">'C0'</span>, label<span class="op">=</span><span class="st">'linea media'</span>)</span>
<span id="cb12-13"><a href="#cb12-13"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'temperatura'</span>)</span>
<span id="cb12-14"><a href="#cb12-14"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'bicis alquiladas'</span>)</span>
<span id="cb12-15"><a href="#cb12-15"></a>axes[<span class="dv">0</span>].legend()</span>
<span id="cb12-16"><a href="#cb12-16"></a></span>
<span id="cb12-17"><a href="#cb12-17"></a>axes[<span class="dv">1</span>].plot(bicis.temperatura, bicis.alquiladas, <span class="st">'.'</span>, color<span class="op">=</span><span class="st">"0.75"</span>,  zorder<span class="op">=-</span><span class="dv">3</span>)</span>
<span id="cb12-18"><a href="#cb12-18"></a>idx <span class="op">=</span> np.argsort(bicis.temperatura.values)</span>
<span id="cb12-19"><a href="#cb12-19"></a>axes[<span class="dv">1</span>].fill_between(bicis.temperatura[idx], hdi_lines[<span class="st">"μ"</span>][:,<span class="dv">0</span>][idx], hdi_lines[<span class="st">"μ"</span>][:,<span class="dv">1</span>][idx],</span>
<span id="cb12-20"><a href="#cb12-20"></a>                     color<span class="op">=</span><span class="st">"C1"</span>, label<span class="op">=</span><span class="st">'HDI'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb12-21"><a href="#cb12-21"></a>axes[<span class="dv">1</span>].plot(x_plot, linea_media, c<span class="op">=</span><span class="st">'C0'</span>, label<span class="op">=</span><span class="st">'linea media'</span>)</span>
<span id="cb12-22"><a href="#cb12-22"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">'temperatura'</span>)</span>
<span id="cb12-23"><a href="#cb12-23"></a>axes[<span class="dv">1</span>].legend()<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="05_Regresión_lineal_files/figure-html/cell-10-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Ambos paneles transmiten esencialmente la misma información, si volvemos a correr el código para generar el gráfico, las lineas serán diferentes, porque las 50 muestras serán distintas cada vez (salvo que fijemos una semilla). Sin embargo, el área sombreada será la misma, porque estamos utilizando todas las muestras ya calculadas. Si reajustamos el modelo (sin fijar una semillar), no solo obtendremos líneas diferentes, sino que el área sombreada también podría cambiar, pero la diferencia debería ser muy pequeña, caso contrario es probable que necesitemos más muestras (incrementar la candidad de <code>draws</code> en <code>pm.sample(.)</code>)</p>
<p>OK, pero ¿Por qué mostramos dos gráficos ligeramente diferentes si transmiten la misma información? Bueno, por un lado para resaltar que hay diferentes formas de representar la incertidumbre. ¿Cuál es mejor? Como de costumbre, eso depende del contexto, el área sombreada es una buena opción, es muy común y es simple de calcular e interpretar. Pero pueden darse situaciones donde nos interese mostrar muestras individuales de la distribución a posteriori, por ejemplo, la mayoría de las líneas podrían abarcar una determinada región, pero algunas podróian tener una pendiente muy alta. Un área sombreada podría opacar esta información. Al mostrar muestras individuales, puede ser una buena idea animarlas si las está mostrando en una presentación o en un video (ver <a href="http://users.eecs.northwestern.edu/~jhullman/hops_jobs_pfs.pdf">Hypothetical Outcome Plots</a> para obtener más información al respecto).</p>
<p>Otra razón para mostrar estas figuras es que vean diferentes formas de extraer información de la distribución a posteriori. Si prestamos atención al código veremos que en la primera línea usamos <code>az.extract</code> toma la dimensión <code>chain</code> y <code>draw</code> y las apila en una sola dimensión <code>sample</code>, que puede ser útil para el procesamiento posterior. Además, usamos el argumento <code>num_samples</code> para solicitar una submuestra de la distribución a posteriori. Por defecto <code>az.extract</code> opera sobre el grupo <code>posterior</code> de un InferenceData. Si deseamos extraer información de otro grupo, podemos usar el argumento <code>group</code>. En la segunda línea, definimos un DataArray llamado <code>x_plot</code>, con valores igualmente espaciados empezando por la temperatura mínima observada y terminado en la máxima observada. La razón para crear un DataArray es poder usar las capacidades de alineación automática de Xarray (esto lo hacemos en las próximas dos líneas). Si usaramos un arreglo NumPy necesitariamos agregar dimensiones adicionales, lo que puede resultar confuso, la mejor manera de entender completamente lo que quiero decir es definir <code>x_plot = np.linspace(bikes.temperature.min(), bikes.temperature.max())</code> e intentar rehacer el gráfico. En la tercer y cuarta línea de código, calculamos la media del posterior de <span class="math inline">\(\mu\)</span> para cada valor de <code>x_plot</code> las líneas individuales, respectivamente. Podríamos haber usado <code>posterior['μ']</code>, pero en su lugar reescribimos explícitamente el modelo lineal, lo hacemos para ser explícitos y con la esperanza de que te ayude a obtener más intuición sobre los modelos lineales.</p>
</section>
<section id="interpretando-las-predicciones-a-posteriori" class="level3" data-number="6.2.2">
<h3 data-number="6.2.2" class="anchored" data-anchor-id="interpretando-las-predicciones-a-posteriori"><span class="header-section-number">6.2.2</span> Interpretando las predicciones a posteriori</h3>
<p>¿Qué pasa si no solo estamos interesados en el valor esperado (promedio), sino que queremos pensar en términos de predicciones, es decir, en términos de bicicletas alquiladas? Bueno, para eso podemos usar la distribución predictiva a posteriori. Después de ejecutar la siguiente línea de código <code>idata_lb</code> contendrá un nuevo grupo <code>posterior_predictive</code> con una variable <code>y_pred</code> que representa la distribución predictiva a posteriori para el número de bicicletas alquiladas.</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a>pm.sample_posterior_predictive(idata_bl, model<span class="op">=</span>modelo_bl, extend_inferencedata<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Sampling: [y_pred]</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="4000" class="" max="4000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [4000/4000 00:00&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-display" data-execution_count="10">


            <div>
              <div class="xr-header">
                <div class="xr-obj-type">arviz.InferenceData</div>
              </div>
              <ul class="xr-sections group-sections">
              
            <li class="xr-section-item">
                  <input id="idata_posterior8052effc-7731-468c-988f-3789670e5a39" class="xr-section-summary-in" type="checkbox">
                  <label for="idata_posterior8052effc-7731-468c-988f-3789670e5a39" class="xr-section-summary">posterior</label>
                  <div class="xr-section-inline-details"></div>
                  <div class="xr-section-details">
                      <ul id="xr-dataset-coord-list" class="xr-var-list">
                          <div style="padding-left:2rem;"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.Dataset&gt;
Dimensions:  (chain: 4, draw: 1000, μ_dim_0: 348)
Coordinates:
  * chain    (chain) int64 0 1 2 3
  * draw     (draw) int64 0 1 2 3 4 5 6 7 8 ... 992 993 994 995 996 997 998 999
  * μ_dim_0  (μ_dim_0) int64 0 1 2 3 4 5 6 7 ... 340 341 342 343 344 345 346 347
Data variables:
    α        (chain, draw) float64 73.42 59.66 105.3 101.8 ... 66.61 54.51 91.06
    β        (chain, draw) float64 7.644 8.523 7.453 6.508 ... 7.588 9.33 6.69
    σ        (chain, draw) float64 158.8 164.1 177.3 177.7 ... 179.7 171.3 169.5
    μ        (chain, draw, μ_dim_0) float64 98.49 69.77 91.31 ... 113.0 144.5
Attributes:
    created_at:                 2023-06-07T19:47:52.360560
    arviz_version:              0.15.1
    inference_library:          pymc
    inference_library_version:  5.3.1
    sampling_time:              4.0339789390563965
    tuning_steps:               1000</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.Dataset</div></div><ul class="xr-sections"><li class="xr-section-item"><input id="section-94636bc9-ce86-4e48-986c-4beae0b54e70" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-94636bc9-ce86-4e48-986c-4beae0b54e70" class="xr-section-summary" title="Expand/collapse section">Dimensions:</label><div class="xr-section-inline-details"><ul class="xr-dim-list"><li><span class="xr-has-index">chain</span>: 4</li><li><span class="xr-has-index">draw</span>: 1000</li><li><span class="xr-has-index">μ_dim_0</span>: 348</li></ul></div><div class="xr-section-details"></div></li><li class="xr-section-item"><input id="section-a78581f6-1356-4ecd-a3c4-50a20dea46f2" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-a78581f6-1356-4ecd-a3c4-50a20dea46f2" class="xr-section-summary">Coordinates: <span>(3)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">chain</span></div><div class="xr-var-dims">(chain)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3</div><input id="attrs-5a4e8aee-c3d1-4c58-bfc0-ff8abf47394f" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-5a4e8aee-c3d1-4c58-bfc0-ff8abf47394f" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-95e82a0f-b29b-4f08-80a4-ebdd27fac5be" class="xr-var-data-in" type="checkbox"><label for="data-95e82a0f-b29b-4f08-80a4-ebdd27fac5be" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([0, 1, 2, 3])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">draw</span></div><div class="xr-var-dims">(draw)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3 4 5 ... 995 996 997 998 999</div><input id="attrs-e1e99408-e88c-4350-85c9-86c1051f790f" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-e1e99408-e88c-4350-85c9-86c1051f790f" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-8a7bb061-65bb-41a3-96d8-52f845d4e7ec" class="xr-var-data-in" type="checkbox"><label for="data-8a7bb061-65bb-41a3-96d8-52f845d4e7ec" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([  0,   1,   2, ..., 997, 998, 999])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">μ_dim_0</span></div><div class="xr-var-dims">(μ_dim_0)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3 4 5 ... 343 344 345 346 347</div><input id="attrs-0e717e5f-013f-4457-bb33-9e323f3a5712" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-0e717e5f-013f-4457-bb33-9e323f3a5712" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-6fe104c8-6603-46c4-9555-467fe55bf9e0" class="xr-var-data-in" type="checkbox"><label for="data-6fe104c8-6603-46c4-9555-467fe55bf9e0" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([  0,   1,   2, ..., 345, 346, 347])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-e197fb5d-fb8e-4deb-86ea-6c3f39e44a4c" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-e197fb5d-fb8e-4deb-86ea-6c3f39e44a4c" class="xr-section-summary">Data variables: <span>(4)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span>α</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">73.42 59.66 105.3 ... 54.51 91.06</div><input id="attrs-a6fd97a6-c7cb-4aac-946b-cda9ce1dec23" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-a6fd97a6-c7cb-4aac-946b-cda9ce1dec23" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-f284216b-4adf-4523-b6a2-b92ee698ed21" class="xr-var-data-in" type="checkbox"><label for="data-f284216b-4adf-4523-b6a2-b92ee698ed21" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[ 73.42493495,  59.66146328, 105.30661831, ...,  86.34407703,
         52.13609249,  46.6912159 ],
       [ 51.07711738,  60.0991086 ,  57.05908282, ...,  64.36408103,
         62.11259321,  79.29587821],
       [ 89.62434939,  38.06868629,  43.45446492, ...,  53.22270313,
         52.63631534,  49.41615315],
       [ 85.43886153,  74.92029525,  93.92565962, ...,  66.60543029,
         54.50932903,  91.05801517]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>β</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">7.644 8.523 7.453 ... 9.33 6.69</div><input id="attrs-81d98b0d-54aa-480c-aac1-f06e52634686" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-81d98b0d-54aa-480c-aac1-f06e52634686" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-ed8bd331-df50-40bf-9e44-99b138c7b8a5" class="xr-var-data-in" type="checkbox"><label for="data-ed8bd331-df50-40bf-9e44-99b138c7b8a5" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[ 7.64371429,  8.52294793,  7.45278168, ...,  6.64794795,
         8.66049442,  8.89524135],
       [ 9.13508929,  9.17475969,  7.85022692, ...,  8.74030562,
         7.66118314,  7.9627473 ],
       [ 6.69511288,  9.32164185,  8.7747248 , ...,  9.27577966,
        10.19153659,  9.70369026],
       [ 7.48102715,  7.13436707,  6.48973363, ...,  7.58828659,
         9.33015254,  6.69023439]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>σ</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">158.8 164.1 177.3 ... 171.3 169.5</div><input id="attrs-7b752dcf-03ce-4a54-8513-85c750431e60" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-7b752dcf-03ce-4a54-8513-85c750431e60" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-dbc8e236-58c1-40b7-99e7-d38e5e99b3dc" class="xr-var-data-in" type="checkbox"><label for="data-dbc8e236-58c1-40b7-99e7-d38e5e99b3dc" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[158.82715774, 164.07548464, 177.32797301, ..., 162.66349201,
        171.82795902, 162.15154898],
       [164.28367687, 163.81114793, 174.88247442, ..., 172.19881704,
        173.36118572, 169.56808389],
       [166.38825808, 172.10488338, 162.33551845, ..., 182.2517708 ,
        184.45444216, 184.70103686],
       [167.23414142, 166.51661423, 171.89238525, ..., 179.74754127,
        171.30089775, 169.47478241]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>μ</span></div><div class="xr-var-dims">(chain, draw, μ_dim_0)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">98.49 69.77 91.31 ... 113.0 144.5</div><input id="attrs-c93fa5bc-5b2e-45d1-b7a0-4caed4589eb8" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-c93fa5bc-5b2e-45d1-b7a0-4caed4589eb8" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-e79deb41-7fa6-44a1-b0f7-84589f0b49c3" class="xr-var-data-in" type="checkbox"><label for="data-e79deb41-7fa6-44a1-b0f7-84589f0b49c3" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[[ 98.48836712,  69.7690919 ,  91.3087509 , ..., 105.68065948,
          98.48461903, 134.4299879 ],
        [ 87.60786724,  55.58509951,  79.6024012 , ...,  95.62746752,
          87.60368801, 127.68374538],
        [129.74399011, 101.74209469, 122.74371378, ..., 136.75662594,
         129.74033564, 164.78782387],
        ...,
        [108.14243135,  83.16449007, 101.89812223, ..., 114.39776526,
         108.13917153, 139.40184464],
        [ 80.53350587,  47.99394286,  72.39884466, ...,  88.68252944,
          80.5292592 , 121.25614339],
        [ 75.85835504,  42.43679128,  67.50319985, ...,  84.22826186,
          75.85399325, 117.68479952]],

       [[ 81.03070826,  46.70797806,  72.45026782, ...,  89.6262981 ,
          81.02622887, 123.98494522],
        [ 90.18277713,  55.71099567,  81.56507493, ...,  98.81569452,
          90.17827829, 133.32354887],
        [ 82.79966159,  53.30446871,  75.42607143, ...,  90.18627036,
          82.79581223, 119.7123284 ],
...
        [ 83.63761211,  48.78627428,  74.92502349, ...,  92.36558344,
          83.63306373, 127.25339135],
        [ 86.0539545 ,  47.76189738,  76.48121033, ...,  95.64360005,
          86.04895708, 133.9757278 ],
        [ 81.23416378,  44.7750628 ,  72.11964572, ...,  90.3647742 ,
          81.22940558, 126.8620277 ]],

       [[109.96884911,  81.86082865, 102.94204227, ..., 117.0080623 ,
         109.96518079, 145.14549633],
        [ 98.31359835,  71.50806328,  91.61240367, ..., 105.02662448,
          98.31010001, 131.86021013],
        [115.20523554,  90.82174356, 109.10953455, ..., 121.31169894,
         115.2020533 , 145.72070696],
        ...,
        [ 91.48711725,  62.97609726,  84.35956337, ...,  98.62725535,
          91.48339633, 127.16811062],
        [ 85.10252448,  50.04689466,  76.33886431, ...,  93.88165754,
          85.09794944, 128.97397123],
        [112.99502503,  87.85820341, 106.71099694, ..., 119.29014803,
         112.99174447, 144.453274  ]]])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-5b1a8958-b7e7-430f-9e21-5b729b8503d4" class="xr-section-summary-in" type="checkbox"><label for="section-5b1a8958-b7e7-430f-9e21-5b729b8503d4" class="xr-section-summary">Indexes: <span>(3)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-index-name"><div>chain</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-e527b5a8-3da3-4a35-b714-5b6d049325cd" class="xr-index-data-in" type="checkbox"><label for="index-e527b5a8-3da3-4a35-b714-5b6d049325cd" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([0, 1, 2, 3], dtype='int64', name='chain'))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>draw</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-450ea1bc-b7d5-4ce5-8862-4c7af6ebc623" class="xr-index-data-in" type="checkbox"><label for="index-450ea1bc-b7d5-4ce5-8862-4c7af6ebc623" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
       ...
       990, 991, 992, 993, 994, 995, 996, 997, 998, 999],
      dtype='int64', name='draw', length=1000))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>μ_dim_0</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-b8f539c3-286f-4538-a2ae-020875b53dfb" class="xr-index-data-in" type="checkbox"><label for="index-b8f539c3-286f-4538-a2ae-020875b53dfb" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
       ...
       338, 339, 340, 341, 342, 343, 344, 345, 346, 347],
      dtype='int64', name='μ_dim_0', length=348))</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-0afa52b5-9023-4c01-93ab-17e0bda525b5" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-0afa52b5-9023-4c01-93ab-17e0bda525b5" class="xr-section-summary">Attributes: <span>(6)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"><dt><span>created_at :</span></dt><dd>2023-06-07T19:47:52.360560</dd><dt><span>arviz_version :</span></dt><dd>0.15.1</dd><dt><span>inference_library :</span></dt><dd>pymc</dd><dt><span>inference_library_version :</span></dt><dd>5.3.1</dd><dt><span>sampling_time :</span></dt><dd>4.0339789390563965</dd><dt><span>tuning_steps :</span></dt><dd>1000</dd></dl></div></li></ul></div></div><br></div>
                      </ul>
                  </div>
            </li>
            
            <li class="xr-section-item">
                  <input id="idata_posterior_predictive8de2479c-74fe-43a2-8f94-9b7175922135" class="xr-section-summary-in" type="checkbox">
                  <label for="idata_posterior_predictive8de2479c-74fe-43a2-8f94-9b7175922135" class="xr-section-summary">posterior_predictive</label>
                  <div class="xr-section-inline-details"></div>
                  <div class="xr-section-details">
                      <ul id="xr-dataset-coord-list" class="xr-var-list">
                          <div style="padding-left:2rem;"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.Dataset&gt;
Dimensions:       (chain: 4, draw: 1000, y_pred_dim_2: 348)
Coordinates:
  * chain         (chain) int64 0 1 2 3
  * draw          (draw) int64 0 1 2 3 4 5 6 7 ... 993 994 995 996 997 998 999
  * y_pred_dim_2  (y_pred_dim_2) int64 0 1 2 3 4 5 6 ... 342 343 344 345 346 347
Data variables:
    y_pred        (chain, draw, y_pred_dim_2) float64 101.1 31.19 ... 3.604
Attributes:
    created_at:                 2023-06-07T19:48:05.320755
    arviz_version:              0.15.1
    inference_library:          pymc
    inference_library_version:  5.3.1</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.Dataset</div></div><ul class="xr-sections"><li class="xr-section-item"><input id="section-b3d60833-2e3a-40ef-ac36-6cc4c5bfd9f7" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-b3d60833-2e3a-40ef-ac36-6cc4c5bfd9f7" class="xr-section-summary" title="Expand/collapse section">Dimensions:</label><div class="xr-section-inline-details"><ul class="xr-dim-list"><li><span class="xr-has-index">chain</span>: 4</li><li><span class="xr-has-index">draw</span>: 1000</li><li><span class="xr-has-index">y_pred_dim_2</span>: 348</li></ul></div><div class="xr-section-details"></div></li><li class="xr-section-item"><input id="section-665b27b8-cf90-445a-91cd-e1a748e68abf" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-665b27b8-cf90-445a-91cd-e1a748e68abf" class="xr-section-summary">Coordinates: <span>(3)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">chain</span></div><div class="xr-var-dims">(chain)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3</div><input id="attrs-20b05d3e-502a-4d91-916b-52abeaced790" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-20b05d3e-502a-4d91-916b-52abeaced790" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-c419910e-604d-4373-83aa-58fb33141c72" class="xr-var-data-in" type="checkbox"><label for="data-c419910e-604d-4373-83aa-58fb33141c72" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([0, 1, 2, 3])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">draw</span></div><div class="xr-var-dims">(draw)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3 4 5 ... 995 996 997 998 999</div><input id="attrs-fdb8f5fc-6635-4566-9ba2-3a8c5b0a8a28" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-fdb8f5fc-6635-4566-9ba2-3a8c5b0a8a28" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-96834190-8735-4661-8ecb-e08c0ab30957" class="xr-var-data-in" type="checkbox"><label for="data-96834190-8735-4661-8ecb-e08c0ab30957" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([  0,   1,   2, ..., 997, 998, 999])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">y_pred_dim_2</span></div><div class="xr-var-dims">(y_pred_dim_2)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3 4 5 ... 343 344 345 346 347</div><input id="attrs-355ec874-180d-466c-98bb-2bc47e1db8a5" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-355ec874-180d-466c-98bb-2bc47e1db8a5" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-92920b81-8675-4412-8648-fd14b5870ca6" class="xr-var-data-in" type="checkbox"><label for="data-92920b81-8675-4412-8648-fd14b5870ca6" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([  0,   1,   2, ..., 345, 346, 347])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-9fef635c-87b7-402d-b350-4f5c11b2a38a" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-9fef635c-87b7-402d-b350-4f5c11b2a38a" class="xr-section-summary">Data variables: <span>(1)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span>y_pred</span></div><div class="xr-var-dims">(chain, draw, y_pred_dim_2)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">101.1 31.19 371.1 ... 242.3 3.604</div><input id="attrs-6179cee0-1fd6-43e3-9298-d2bc4cc50940" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-6179cee0-1fd6-43e3-9298-d2bc4cc50940" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-3ba4d757-e7d7-427c-8ab5-cd3d465add91" class="xr-var-data-in" type="checkbox"><label for="data-3ba4d757-e7d7-427c-8ab5-cd3d465add91" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[[ 1.01128384e+02,  3.11932574e+01,  3.71075234e+02, ...,
          2.64342022e+02, -4.92384491e+01,  2.78505806e+02],
        [-7.78529676e+01,  3.94602057e+02,  1.70790304e+02, ...,
          3.56958385e+02,  1.17429236e+02,  2.65028953e+02],
        [-2.80070026e+00,  2.42567900e+02,  1.37176371e+02, ...,
         -3.16229312e+02,  3.25971565e+02,  6.85863325e+01],
        ...,
        [ 1.26418736e+02,  1.51704242e+02,  1.68112593e+02, ...,
          5.41905332e+02,  8.97159482e+01,  2.93741173e+02],
        [-6.62406224e+01, -2.30677407e+02,  4.22298188e+01, ...,
         -2.80094197e+01,  4.90735784e+01,  9.58480294e+01],
        [ 3.02118397e+02, -6.61412581e+01,  4.75596103e+01, ...,
          1.37296598e+02,  2.52983687e+02,  1.82969671e+02]],

       [[ 3.07350410e+01,  7.97926435e+01,  8.40360996e+01, ...,
         -7.38381418e+01,  9.65976825e+01,  5.61232999e+01],
        [ 1.01148120e+02,  1.52581195e+02,  1.67574625e+02, ...,
          7.45247964e+01, -3.61422496e+01,  1.33014253e+02],
        [ 2.12393327e+02, -3.38707883e-01,  2.61328305e+02, ...,
          1.75252293e+02,  3.19818146e+02,  1.90087202e+02],
...
        [ 2.51727958e+01,  1.99583319e+02,  2.50544204e+02, ...,
         -6.11547961e+01, -1.84468776e+02, -6.20910669e+01],
        [-2.93758696e+02, -9.62974690e+01,  2.72602211e+02, ...,
          2.84644958e+02, -2.97339892e+01,  1.05415509e+02],
        [-1.79201906e+02,  2.30560703e+02, -1.11299174e+02, ...,
          4.54075506e+02,  7.87947138e+00, -2.29120815e+01]],

       [[ 9.17065261e+01,  4.52318920e+02, -1.61736107e+02, ...,
         -1.34065759e+02,  1.70506038e+02, -1.14991416e+02],
        [-4.75565111e+01,  9.90648277e+01, -6.82824050e+01, ...,
          6.82263782e+01, -1.27188568e+02,  2.59935622e+02],
        [ 3.33982419e+02,  4.95977259e+01,  9.19289381e+01, ...,
          2.19773471e+02, -1.59762193e+02, -5.85404825e+01],
        ...,
        [ 2.14288331e+02,  2.33329417e+02,  2.36238557e+02, ...,
         -9.26429306e+01, -2.71764373e+02,  9.39724927e+01],
        [ 5.82965632e+00, -1.46444723e+02,  3.35982332e+02, ...,
         -2.06081273e+02, -1.29716251e+02,  3.07826501e+02],
        [ 3.45693983e+02, -2.94646886e+01,  1.80236700e+02, ...,
          2.40608407e+02,  2.42260142e+02,  3.60424781e+00]]])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-c9bc3752-ecab-4d82-a470-3397c90cd43a" class="xr-section-summary-in" type="checkbox"><label for="section-c9bc3752-ecab-4d82-a470-3397c90cd43a" class="xr-section-summary">Indexes: <span>(3)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-index-name"><div>chain</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-0afece94-2e52-404d-8d8e-8530d7530bfc" class="xr-index-data-in" type="checkbox"><label for="index-0afece94-2e52-404d-8d8e-8530d7530bfc" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([0, 1, 2, 3], dtype='int64', name='chain'))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>draw</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-0b64e78c-bc8a-4a55-9fff-9bfac9f58c04" class="xr-index-data-in" type="checkbox"><label for="index-0b64e78c-bc8a-4a55-9fff-9bfac9f58c04" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
       ...
       990, 991, 992, 993, 994, 995, 996, 997, 998, 999],
      dtype='int64', name='draw', length=1000))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>y_pred_dim_2</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-39a22796-03bd-421f-be9c-58a662443c5c" class="xr-index-data-in" type="checkbox"><label for="index-39a22796-03bd-421f-be9c-58a662443c5c" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
       ...
       338, 339, 340, 341, 342, 343, 344, 345, 346, 347],
      dtype='int64', name='y_pred_dim_2', length=348))</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-4a2afb4e-74f9-4435-ad2b-8ec26cf59b06" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-4a2afb4e-74f9-4435-ad2b-8ec26cf59b06" class="xr-section-summary">Attributes: <span>(4)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"><dt><span>created_at :</span></dt><dd>2023-06-07T19:48:05.320755</dd><dt><span>arviz_version :</span></dt><dd>0.15.1</dd><dt><span>inference_library :</span></dt><dd>pymc</dd><dt><span>inference_library_version :</span></dt><dd>5.3.1</dd></dl></div></li></ul></div></div><br></div>
                      </ul>
                  </div>
            </li>
            
            <li class="xr-section-item">
                  <input id="idata_sample_stats9ac3dcb8-8565-4cc5-b1cb-2da4d15767e0" class="xr-section-summary-in" type="checkbox">
                  <label for="idata_sample_stats9ac3dcb8-8565-4cc5-b1cb-2da4d15767e0" class="xr-section-summary">sample_stats</label>
                  <div class="xr-section-inline-details"></div>
                  <div class="xr-section-details">
                      <ul id="xr-dataset-coord-list" class="xr-var-list">
                          <div style="padding-left:2rem;"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.Dataset&gt;
Dimensions:                (chain: 4, draw: 1000)
Coordinates:
  * chain                  (chain) int64 0 1 2 3
  * draw                   (draw) int64 0 1 2 3 4 5 ... 994 995 996 997 998 999
Data variables: (12/17)
    tree_depth             (chain, draw) int64 2 3 3 2 2 3 2 2 ... 3 3 3 3 3 3 3
    index_in_trajectory    (chain, draw) int64 -2 2 5 -1 -2 4 ... -3 3 4 -2 -4 5
    lp                     (chain, draw) float64 -2.292e+03 ... -2.292e+03
    step_size_bar          (chain, draw) float64 0.5271 0.5271 ... 0.5269 0.5269
    energy_error           (chain, draw) float64 0.06236 -0.06208 ... -0.2526
    smallest_eigval        (chain, draw) float64 nan nan nan nan ... nan nan nan
    ...                     ...
    reached_max_treedepth  (chain, draw) bool False False False ... False False
    energy                 (chain, draw) float64 2.292e+03 ... 2.293e+03
    perf_counter_start     (chain, draw) float64 2.948e+04 ... 2.948e+04
    perf_counter_diff      (chain, draw) float64 0.0007082 ... 0.0009681
    max_energy_error       (chain, draw) float64 0.08135 -0.06315 ... 0.3578
    largest_eigval         (chain, draw) float64 nan nan nan nan ... nan nan nan
Attributes:
    created_at:                 2023-06-07T19:47:52.369931
    arviz_version:              0.15.1
    inference_library:          pymc
    inference_library_version:  5.3.1
    sampling_time:              4.0339789390563965
    tuning_steps:               1000</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.Dataset</div></div><ul class="xr-sections"><li class="xr-section-item"><input id="section-6e0c3027-8472-4bfc-a8b7-66a080b712f8" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-6e0c3027-8472-4bfc-a8b7-66a080b712f8" class="xr-section-summary" title="Expand/collapse section">Dimensions:</label><div class="xr-section-inline-details"><ul class="xr-dim-list"><li><span class="xr-has-index">chain</span>: 4</li><li><span class="xr-has-index">draw</span>: 1000</li></ul></div><div class="xr-section-details"></div></li><li class="xr-section-item"><input id="section-f5419ead-ef42-4143-9e57-6bb7916588f9" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-f5419ead-ef42-4143-9e57-6bb7916588f9" class="xr-section-summary">Coordinates: <span>(2)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">chain</span></div><div class="xr-var-dims">(chain)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3</div><input id="attrs-ec730a92-99f3-4774-aab1-4d08398c1a15" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-ec730a92-99f3-4774-aab1-4d08398c1a15" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-197e9757-facb-4f96-abf1-05f68d1b489c" class="xr-var-data-in" type="checkbox"><label for="data-197e9757-facb-4f96-abf1-05f68d1b489c" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([0, 1, 2, 3])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">draw</span></div><div class="xr-var-dims">(draw)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3 4 5 ... 995 996 997 998 999</div><input id="attrs-3af08689-309e-47b8-9b78-c474b8afcf55" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-3af08689-309e-47b8-9b78-c474b8afcf55" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-033a1da8-4773-4414-9769-5a7f9fa46ac8" class="xr-var-data-in" type="checkbox"><label for="data-033a1da8-4773-4414-9769-5a7f9fa46ac8" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([  0,   1,   2, ..., 997, 998, 999])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-7c493df8-646c-429c-95d6-16ab0eb39bc8" class="xr-section-summary-in" type="checkbox"><label for="section-7c493df8-646c-429c-95d6-16ab0eb39bc8" class="xr-section-summary">Data variables: <span>(17)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span>tree_depth</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">2 3 3 2 2 3 2 2 ... 2 3 3 3 3 3 3 3</div><input id="attrs-dc973eb5-5570-4f37-9843-1ba9d92c70c1" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-dc973eb5-5570-4f37-9843-1ba9d92c70c1" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-6f3d558f-4ce8-40c1-9beb-ebc4392bb984" class="xr-var-data-in" type="checkbox"><label for="data-6f3d558f-4ce8-40c1-9beb-ebc4392bb984" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[2, 3, 3, ..., 3, 3, 4],
       [2, 2, 3, ..., 2, 3, 2],
       [3, 3, 3, ..., 2, 2, 3],
       [3, 2, 3, ..., 3, 3, 3]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>index_in_trajectory</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">-2 2 5 -1 -2 4 ... -3 3 4 -2 -4 5</div><input id="attrs-24671502-a5c6-4d63-8980-ef7494c59dbc" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-24671502-a5c6-4d63-8980-ef7494c59dbc" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-17c1621b-bff9-415c-a2e1-5e105b7cf7dc" class="xr-var-data-in" type="checkbox"><label for="data-17c1621b-bff9-415c-a2e1-5e105b7cf7dc" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[-2,  2,  5, ..., -4, -3,  4],
       [-2, -1, -6, ...,  3,  2, -2],
       [ 4,  6, -4, ...,  2,  1, -1],
       [-3, -1,  1, ..., -2, -4,  5]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>lp</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">-2.292e+03 ... -2.292e+03</div><input id="attrs-9a3273ce-b0bf-4ad5-9035-ddaddb2e3a59" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-9a3273ce-b0bf-4ad5-9035-ddaddb2e3a59" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-85bd1096-c466-447d-8165-2b965cbd5f9a" class="xr-var-data-in" type="checkbox"><label for="data-85bd1096-c466-447d-8165-2b965cbd5f9a" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[-2292.31218358, -2291.46251508, -2296.66232091, ...,
        -2292.38811041, -2291.61891404, -2292.47256581],
       [-2292.05909703, -2292.82904493, -2292.48827727, ...,
        -2291.86093814, -2292.03634414, -2291.71536542],
       [-2291.87548445, -2292.72076885, -2293.00496567, ...,
        -2294.00524692, -2297.70072343, -2295.47763832],
       [-2291.68012935, -2291.64101552, -2292.21666314, ...,
        -2292.77661558, -2292.40257033, -2291.84911534]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>step_size_bar</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.5271 0.5271 ... 0.5269 0.5269</div><input id="attrs-d313bcad-1ad1-44f4-9929-51655b8a637f" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-d313bcad-1ad1-44f4-9929-51655b8a637f" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-a1b60f46-681e-4fd1-892d-9068f6098987" class="xr-var-data-in" type="checkbox"><label for="data-a1b60f46-681e-4fd1-892d-9068f6098987" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[0.52706571, 0.52706571, 0.52706571, ..., 0.52706571, 0.52706571,
        0.52706571],
       [0.61751936, 0.61751936, 0.61751936, ..., 0.61751936, 0.61751936,
        0.61751936],
       [0.52500971, 0.52500971, 0.52500971, ..., 0.52500971, 0.52500971,
        0.52500971],
       [0.52687759, 0.52687759, 0.52687759, ..., 0.52687759, 0.52687759,
        0.52687759]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>energy_error</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.06236 -0.06208 ... -0.2526</div><input id="attrs-b583c07d-3bd3-4221-a257-0d63a6c0e0c6" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-b583c07d-3bd3-4221-a257-0d63a6c0e0c6" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-12479bf0-50ab-47df-b362-475ae60a9594" class="xr-var-data-in" type="checkbox"><label for="data-12479bf0-50ab-47df-b362-475ae60a9594" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[ 0.0623559 , -0.06208129,  2.13462506, ...,  0.04302744,
        -0.079441  ,  0.04188887],
       [ 0.00240051,  0.52532953, -0.06526068, ...,  0.16843362,
         0.13962037, -0.0957667 ],
       [-0.10119859,  0.21952694,  0.27717663, ..., -0.29848284,
         1.15620248, -0.93007826],
       [ 0.12564641, -0.00828786, -0.12476424, ...,  0.01490099,
        -0.02458915, -0.25263189]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>smallest_eigval</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">nan nan nan nan ... nan nan nan nan</div><input id="attrs-e4382c19-2433-45f7-8956-bfa46e692430" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-e4382c19-2433-45f7-8956-bfa46e692430" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-1da86cde-267b-4462-a958-1f8597261d7d" class="xr-var-data-in" type="checkbox"><label for="data-1da86cde-267b-4462-a958-1f8597261d7d" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>acceptance_rate</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.9538 0.9985 ... 0.7794 0.8962</div><input id="attrs-0a37570b-7aae-4498-8b3a-3fdad4273a33" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-0a37570b-7aae-4498-8b3a-3fdad4273a33" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-817c3e14-982a-4d80-a01c-2b90f2885af8" class="xr-var-data-in" type="checkbox"><label for="data-817c3e14-982a-4d80-a01c-2b90f2885af8" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[0.95380647, 0.99852501, 0.40836033, ..., 0.9863736 , 0.99085177,
        0.79584152],
       [0.92006504, 0.71966705, 1.        , ..., 0.86995056, 0.70726883,
        0.95957316],
       [0.92146427, 0.52071409, 0.88501896, ..., 0.5674322 , 0.56543205,
        0.98237713],
       [0.91279773, 0.95056309, 0.95711029, ..., 0.96283568, 0.7793867 ,
        0.89617318]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>n_steps</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">3.0 7.0 7.0 3.0 ... 7.0 7.0 7.0 7.0</div><input id="attrs-fb998a5f-6eff-4356-9573-80bd5e426838" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-fb998a5f-6eff-4356-9573-80bd5e426838" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-f6e4208e-9a31-44d5-9901-b0db4a5f0f34" class="xr-var-data-in" type="checkbox"><label for="data-f6e4208e-9a31-44d5-9901-b0db4a5f0f34" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[ 3.,  7.,  7., ...,  7.,  7., 15.],
       [ 3.,  3.,  7., ...,  3.,  7.,  3.],
       [ 7.,  7.,  7., ...,  3.,  3.,  7.],
       [ 7.,  3.,  7., ...,  7.,  7.,  7.]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>step_size</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.4355 0.4355 ... 0.5838 0.5838</div><input id="attrs-704f5efd-0c0d-4a04-9a7c-5a8cde2aa58b" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-704f5efd-0c0d-4a04-9a7c-5a8cde2aa58b" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-685cbc1f-6cfb-4f24-a619-6f2539b42f01" class="xr-var-data-in" type="checkbox"><label for="data-685cbc1f-6cfb-4f24-a619-6f2539b42f01" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[0.43553391, 0.43553391, 0.43553391, ..., 0.43553391, 0.43553391,
        0.43553391],
       [0.43077189, 0.43077189, 0.43077189, ..., 0.43077189, 0.43077189,
        0.43077189],
       [0.42874467, 0.42874467, 0.42874467, ..., 0.42874467, 0.42874467,
        0.42874467],
       [0.58379123, 0.58379123, 0.58379123, ..., 0.58379123, 0.58379123,
        0.58379123]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>diverging</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">bool</div><div class="xr-var-preview xr-preview">False False False ... False False</div><input id="attrs-9a203744-ca24-487d-a422-e0d6ecddfc55" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-9a203744-ca24-487d-a422-e0d6ecddfc55" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-4a1b958b-3f40-46fd-ad1a-80a47c7c2cdd" class="xr-var-data-in" type="checkbox"><label for="data-4a1b958b-3f40-46fd-ad1a-80a47c7c2cdd" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>process_time_diff</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.0007087 0.001334 ... 0.0009681</div><input id="attrs-c68ab075-5227-45ff-8688-984ce3eb45c0" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-c68ab075-5227-45ff-8688-984ce3eb45c0" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-013256b8-bf71-4d84-be52-6a0a5e92db56" class="xr-var-data-in" type="checkbox"><label for="data-013256b8-bf71-4d84-be52-6a0a5e92db56" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[0.00070865, 0.00133362, 0.0014526 , ..., 0.00145896, 0.00142973,
        0.00219725],
       [0.00178472, 0.00119337, 0.00116159, ..., 0.00077074, 0.00153468,
        0.00079175],
       [0.00086522, 0.00091497, 0.0008957 , ..., 0.00087924, 0.00109934,
        0.00114098],
       [0.00144682, 0.00074238, 0.00142757, ..., 0.00163314, 0.0013432 ,
        0.00096808]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>reached_max_treedepth</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">bool</div><div class="xr-var-preview xr-preview">False False False ... False False</div><input id="attrs-f4d7461a-48d4-49cb-adac-3d4b3dcbce7c" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-f4d7461a-48d4-49cb-adac-3d4b3dcbce7c" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-86a3b557-3cdf-4408-99cb-7630b8a050a5" class="xr-var-data-in" type="checkbox"><label for="data-86a3b557-3cdf-4408-99cb-7630b8a050a5" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>energy</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">2.292e+03 2.293e+03 ... 2.293e+03</div><input id="attrs-2940fdab-a1c3-4746-9693-3a6c7d6a093a" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-2940fdab-a1c3-4746-9693-3a6c7d6a093a" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-33c92773-830d-4886-bcf2-df26e6afcf14" class="xr-var-data-in" type="checkbox"><label for="data-33c92773-830d-4886-bcf2-df26e6afcf14" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[2292.38465229, 2292.87857743, 2296.83507411, ..., 2293.18134085,
        2293.46476754, 2293.45301363],
       [2292.72643713, 2293.24223652, 2293.91795788, ..., 2292.89153382,
        2293.16993969, 2292.45660984],
       [2293.53792431, 2293.841904  , 2294.87522651, ..., 2296.67502416,
        2298.25521888, 2297.20715421],
       [2292.92607978, 2292.00036353, 2295.95017591, ..., 2294.56324392,
        2295.15392614, 2293.31094089]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>perf_counter_start</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">2.948e+04 2.948e+04 ... 2.948e+04</div><input id="attrs-0bb553fe-f523-4ab2-8801-b3a7b08388bd" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-0bb553fe-f523-4ab2-8801-b3a7b08388bd" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-b1e5229b-6d73-4659-92e3-fa3d4e53b953" class="xr-var-data-in" type="checkbox"><label for="data-b1e5229b-6d73-4659-92e3-fa3d4e53b953" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[29479.10931543, 29479.11023083, 29479.11172964, ...,
        29480.36387183, 29480.36547186, 29480.36732682],
       [29478.56439302, 29478.56635452, 29478.56774356, ...,
        29479.79651658, 29479.79746422, 29479.79917424],
       [29478.61745475, 29478.61843262, 29478.61945761, ...,
        29479.91472649, 29479.91580755, 29479.91707811],
       [29478.70578033, 29478.70740004, 29478.70831109, ...,
        29480.17606575, 29480.17791467, 29480.17940754]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>perf_counter_diff</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.0007082 0.001333 ... 0.0009681</div><input id="attrs-ed50db83-fb0d-4926-a15d-69e50d1808f7" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-ed50db83-fb0d-4926-a15d-69e50d1808f7" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-52717b0c-b184-4358-889a-20da4dc0acdb" class="xr-var-data-in" type="checkbox"><label for="data-52717b0c-b184-4358-889a-20da4dc0acdb" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[0.00070824, 0.00133335, 0.00145202, ..., 0.00145847, 0.00142931,
        0.00219723],
       [0.00178483, 0.00119311, 0.00116153, ..., 0.00077064, 0.00153462,
        0.0007918 ],
       [0.0008652 , 0.00091482, 0.00089552, ..., 0.00087918, 0.00109901,
        0.0011409 ],
       [0.0014467 , 0.00074219, 0.00142755, ..., 0.00163253, 0.00134321,
        0.00096809]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>max_energy_error</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.08135 -0.06315 ... 0.7102 0.3578</div><input id="attrs-9339f830-14b4-41e5-83ea-70d0f912a0a1" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-9339f830-14b4-41e5-83ea-70d0f912a0a1" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-99ae7ffb-6088-4b47-9698-5a98a0ae771e" class="xr-var-data-in" type="checkbox"><label for="data-99ae7ffb-6088-4b47-9698-5a98a0ae771e" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[ 0.08135002, -0.06314573,  2.65701788, ..., -0.08585883,
        -0.09571448,  0.52633044],
       [ 0.16019574,  0.5271793 , -0.58674622, ...,  0.25821806,
         0.68699359, -0.0957667 ],
       [ 0.19397877,  1.42807737,  0.27717663, ...,  1.21665203,
         1.15620248, -1.56591606],
       [ 0.22721783,  0.07821551, -0.17150318, ..., -0.20146886,
         0.71023613,  0.35783961]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>largest_eigval</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">nan nan nan nan ... nan nan nan nan</div><input id="attrs-000a26e0-8fea-42b7-9db8-ec4b48068967" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-000a26e0-8fea-42b7-9db8-ec4b48068967" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-50477f31-9a28-4fc6-b79b-3ba197d4579f" class="xr-var-data-in" type="checkbox"><label for="data-50477f31-9a28-4fc6-b79b-3ba197d4579f" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-1534c8e9-8285-450a-8f99-894a37f2948b" class="xr-section-summary-in" type="checkbox"><label for="section-1534c8e9-8285-450a-8f99-894a37f2948b" class="xr-section-summary">Indexes: <span>(2)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-index-name"><div>chain</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-d9d49646-9b01-4f0e-957d-ba2e4a4ff3e6" class="xr-index-data-in" type="checkbox"><label for="index-d9d49646-9b01-4f0e-957d-ba2e4a4ff3e6" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([0, 1, 2, 3], dtype='int64', name='chain'))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>draw</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-7bc3f956-38a2-4649-afa0-f608bf940131" class="xr-index-data-in" type="checkbox"><label for="index-7bc3f956-38a2-4649-afa0-f608bf940131" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
       ...
       990, 991, 992, 993, 994, 995, 996, 997, 998, 999],
      dtype='int64', name='draw', length=1000))</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-50fc017f-6361-4baf-aa8f-1ad7cfc7d50a" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-50fc017f-6361-4baf-aa8f-1ad7cfc7d50a" class="xr-section-summary">Attributes: <span>(6)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"><dt><span>created_at :</span></dt><dd>2023-06-07T19:47:52.369931</dd><dt><span>arviz_version :</span></dt><dd>0.15.1</dd><dt><span>inference_library :</span></dt><dd>pymc</dd><dt><span>inference_library_version :</span></dt><dd>5.3.1</dd><dt><span>sampling_time :</span></dt><dd>4.0339789390563965</dd><dt><span>tuning_steps :</span></dt><dd>1000</dd></dl></div></li></ul></div></div><br></div>
                      </ul>
                  </div>
            </li>
            
            <li class="xr-section-item">
                  <input id="idata_observed_data9bef8252-d42d-42e7-980e-007dbc841ed6" class="xr-section-summary-in" type="checkbox">
                  <label for="idata_observed_data9bef8252-d42d-42e7-980e-007dbc841ed6" class="xr-section-summary">observed_data</label>
                  <div class="xr-section-inline-details"></div>
                  <div class="xr-section-details">
                      <ul id="xr-dataset-coord-list" class="xr-var-list">
                          <div style="padding-left:2rem;"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.Dataset&gt;
Dimensions:       (y_pred_dim_0: 348)
Coordinates:
  * y_pred_dim_0  (y_pred_dim_0) int64 0 1 2 3 4 5 6 ... 342 343 344 345 346 347
Data variables:
    y_pred        (y_pred_dim_0) float64 16.0 3.0 115.0 ... 13.0 271.0 102.0
Attributes:
    created_at:                 2023-06-07T19:47:52.373181
    arviz_version:              0.15.1
    inference_library:          pymc
    inference_library_version:  5.3.1</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.Dataset</div></div><ul class="xr-sections"><li class="xr-section-item"><input id="section-9b4ee539-37a3-4ea8-8b4b-d59537d8c267" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-9b4ee539-37a3-4ea8-8b4b-d59537d8c267" class="xr-section-summary" title="Expand/collapse section">Dimensions:</label><div class="xr-section-inline-details"><ul class="xr-dim-list"><li><span class="xr-has-index">y_pred_dim_0</span>: 348</li></ul></div><div class="xr-section-details"></div></li><li class="xr-section-item"><input id="section-34f5794e-17a0-4a10-985c-f987ecad4ee0" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-34f5794e-17a0-4a10-985c-f987ecad4ee0" class="xr-section-summary">Coordinates: <span>(1)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">y_pred_dim_0</span></div><div class="xr-var-dims">(y_pred_dim_0)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3 4 5 ... 343 344 345 346 347</div><input id="attrs-e1ed985b-df7b-461f-a992-c2abc2994409" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-e1ed985b-df7b-461f-a992-c2abc2994409" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-ed28a460-732d-465b-8a33-2dcc3695a210" class="xr-var-data-in" type="checkbox"><label for="data-ed28a460-732d-465b-8a33-2dcc3695a210" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([  0,   1,   2, ..., 345, 346, 347])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-8ac79f38-f3ae-4cb0-be0a-f662caedf4bc" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-8ac79f38-f3ae-4cb0-be0a-f662caedf4bc" class="xr-section-summary">Data variables: <span>(1)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span>y_pred</span></div><div class="xr-var-dims">(y_pred_dim_0)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">16.0 3.0 115.0 ... 13.0 271.0 102.0</div><input id="attrs-cb499399-21ca-4314-96a1-c53abb799401" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-cb499399-21ca-4314-96a1-c53abb799401" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-e4664cc7-572d-48e9-95ea-251c10c24303" class="xr-var-data-in" type="checkbox"><label for="data-e4664cc7-572d-48e9-95ea-251c10c24303" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([ 16.,   3., 115.,  73.,  82.,  51.,  15.,  16.,  61., 152.,  30.,
         2.,  16.,  64.,  52.,  78.,  84.,  78.,  16.,   1., 256.,  86.,
       191., 146.,   4.,  11.,  59.,  78.,  68., 164.,  54.,  18.,   1.,
       241.,  88., 173., 226., 135.,  33.,  20.,   8.,  92.,  87., 124.,
       112.,  25., 236., 103., 104.,  33.,  13.,   6.,  11., 353.,  92.,
       223., 238., 271., 520., 219., 116.,  44.,  52.,   6., 101., 517.,
       305., 170., 189., 402., 249., 256., 171.,  29.,   7.,   4.,  14.,
       486., 121., 420., 175., 258., 452., 213., 134.,  68.,  69.,   5.,
       118., 182., 117., 174., 265., 317., 530., 237., 125.,  28.,   7.,
        10., 100., 437., 163., 370., 148., 298., 292., 285., 171., 128.,
         8.,   7., 105., 186.,  93.,  32.,  43.,  72.,  69., 360., 189.,
       277., 482., 180., 148.,  52., 106.,   8., 111.,  67., 101., 214.,
       256., 470., 539., 181., 166.,  31.,   1.,   8., 285., 240., 168.,
       345., 186., 498., 204., 139.,  66.,  54.,   7.,  13., 216., 138.,
        32., 175., 314., 416., 190., 102.,  24.,   6.,   2.,  10., 400.,
       109., 244., 137., 101.,  95.,  19.,  10.,   6.,   5., 354.,  86.,
       376.,  50., 134., 206.,  72.,  17.,  11.,   2.,  89., 530., 191.,
       134., 192., 311., 181., 190.,  84.,  24.,   3.,  20.,  41., 143.,
       190.,  94., 287., 306., 126.,  72.,   4.,   2.,  12., 281., 220.,
       260., 554., 750., 586., 104.,  48.,  33.,  31., 110., 684., 238.,
       457., 224., 656., 459., 271.,  70.,  88.,   1.,  24., 315., 185.,
       229., 265., 541., 769.,  98., 270.,  74.,  21.,  14.,   8., 324.,
       301., 520., 556., 275., 227., 453., 283., 177., 116.,  12.,  40.,
        78., 250., 188., 300., 487., 900., 571., 213., 102.,  30.,  31.,
        28., 497., 414., 451., 221., 292., 241., 582., 397., 189.,  19.,
         7.,  37.,  68., 327., 260., 569., 274., 851., 491., 190., 136.,
        42.,  53.,  42., 532., 237., 459., 234., 331., 671., 596., 317.,
       229.,   5.,   6.,  17., 530., 334., 361., 594., 209., 901., 341.,
       151., 136., 146.,   4.,  41., 154., 269., 253., 313., 711.,  24.,
       357., 217., 216., 182., 605., 551., 267., 162.,  27.,   8.,   4.,
        11., 500., 163., 509., 268., 605., 352.,  96.,  64.,  26.,  38.,
        36., 350.,  90., 135.,  13., 271., 102.])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-96f6dada-36d9-4364-aacc-0e18b12a0db6" class="xr-section-summary-in" type="checkbox"><label for="section-96f6dada-36d9-4364-aacc-0e18b12a0db6" class="xr-section-summary">Indexes: <span>(1)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-index-name"><div>y_pred_dim_0</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-61df85a5-6a80-4b7e-bf6a-bdafa555057c" class="xr-index-data-in" type="checkbox"><label for="index-61df85a5-6a80-4b7e-bf6a-bdafa555057c" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
       ...
       338, 339, 340, 341, 342, 343, 344, 345, 346, 347],
      dtype='int64', name='y_pred_dim_0', length=348))</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-15e1a4be-27b4-4850-b5d8-4e1cf82a0347" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-15e1a4be-27b4-4850-b5d8-4e1cf82a0347" class="xr-section-summary">Attributes: <span>(4)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"><dt><span>created_at :</span></dt><dd>2023-06-07T19:47:52.373181</dd><dt><span>arviz_version :</span></dt><dd>0.15.1</dd><dt><span>inference_library :</span></dt><dd>pymc</dd><dt><span>inference_library_version :</span></dt><dd>5.3.1</dd></dl></div></li></ul></div></div><br></div>
                      </ul>
                  </div>
            </li>
            
              </ul>
            </div>
            <style> /* CSS stylesheet for displaying InferenceData objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-sections.group-sections {
  grid-template-columns: auto;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt, dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
.xr-wrap{width:700px!important;} </style>
</div>
</div>
<p>En la siguiente figura la línea azul es la media del número de bicicletas alquiladas, esto es lo mismo que ya vimos en la figura anterior. Los nuevos elementos son la banda turquesa oscuro, que representa el 50% central (cuartiles 0,25 y 0,5) para las bicicletas alquiladas y la banda turquesa claro, que representa el 94% central (cuartiles 0,03 y 0,97).</p>
<p>Podemos notar que nuestro modelo predice un número negativo de bicicletas, lo cual no tiene sentido para nuestro problema, ya que no estemas modelando robo o pérdida de bicicletas. Pero detengamonos un momento a reflexionar sobre nuestro modelo. Tiene sentido, según el modelo, que tengamos valores negativos de bicicletas?</p>
<p>Si, esto debería esperarse ya que usamos una distribución Normal como likelihood en <code>modelo_bl</code>. Una <em>solución</em> muy sucia podría ser recortar las predicciones para valores inferiores a cero, pero eso es feo, feo. En la siguiente sección, veremos que podemos mejorar fácilmente este modelo para evitar predicciones sin sentido.</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a>linea_media <span class="op">=</span> idata_bl.posterior[<span class="st">'μ'</span>].mean((<span class="st">"chain"</span>, <span class="st">"draw"</span>))</span>
<span id="cb15-2"><a href="#cb15-2"></a>idx <span class="op">=</span> np.argsort(bicis.temperatura.values)</span>
<span id="cb15-3"><a href="#cb15-3"></a>x <span class="op">=</span> np.linspace(bicis.temperatura.<span class="bu">min</span>(), bicis.temperatura.<span class="bu">max</span>(), <span class="dv">15</span>)</span>
<span id="cb15-4"><a href="#cb15-4"></a>y_pred_q <span class="op">=</span> idata_bl.posterior_predictive[<span class="st">'y_pred'</span>].quantile([<span class="fl">0.03</span>, <span class="fl">0.97</span>, <span class="fl">0.25</span>, <span class="fl">0.75</span>], dim<span class="op">=</span>[<span class="st">'chain'</span>, <span class="st">'draw'</span>])</span>
<span id="cb15-5"><a href="#cb15-5"></a>y_hat_bounds <span class="op">=</span> <span class="bu">iter</span>([PchipInterpolator(bicis.temperatura.values[idx], y_pred_q[i][idx])(x) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">4</span>)])</span>
<span id="cb15-6"><a href="#cb15-6"></a></span>
<span id="cb15-7"><a href="#cb15-7"></a>_, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">5</span>))</span>
<span id="cb15-8"><a href="#cb15-8"></a>ax.plot(bicis.temperatura, bicis.alquiladas, <span class="st">'.'</span>, color<span class="op">=</span><span class="st">"0.75"</span>,  zorder<span class="op">=-</span><span class="dv">3</span>)</span>
<span id="cb15-9"><a href="#cb15-9"></a>ax.plot(bicis.temperatura[idx], linea_media[idx], c<span class="op">=</span><span class="st">'C0'</span>)</span>
<span id="cb15-10"><a href="#cb15-10"></a></span>
<span id="cb15-11"><a href="#cb15-11"></a><span class="cf">for</span> lb, ub <span class="kw">in</span> <span class="bu">zip</span>(y_hat_bounds, y_hat_bounds): </span>
<span id="cb15-12"><a href="#cb15-12"></a>    ax.fill_between(x,</span>
<span id="cb15-13"><a href="#cb15-13"></a>                    lb, ub,</span>
<span id="cb15-14"><a href="#cb15-14"></a>                    color<span class="op">=</span><span class="st">"C1"</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb15-15"><a href="#cb15-15"></a></span>
<span id="cb15-16"><a href="#cb15-16"></a></span>
<span id="cb15-17"><a href="#cb15-17"></a>ax.set_xlabel(<span class="st">'temperatura'</span>)</span>
<span id="cb15-18"><a href="#cb15-18"></a>ax.set_ylabel(<span class="st">'bicis alquiladas'</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="05_Regresión_lineal_files/figure-html/cell-12-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="generalizando-el-modelo-lineal" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="generalizando-el-modelo-lineal"><span class="header-section-number">6.3</span> Generalizando el modelo lineal</h2>
<p>El modelo lineal que hemos estado usando es un caso especial de un modelo más general, el modelo lineal generalizado (GLM). El GLM es una generalización del modelo lineal que nos permite utilizar diferentes distribuciones para el likelihood. De forma general (y omitiendo priors), podemos escribir un GLM como:</p>
<p><span class="math display">\[
\begin{aligned}
\mu &amp;= \alpha + \beta X \\
Y &amp;\sim \phi(f(\mu), \theta)
\end{aligned}
\]</span></p>
<p>donde <span class="math inline">\(\phi\)</span> es una distribución arbitraria algunos casos comunes son Normal, Student’s T, Gamma, NegativeBinomial, pero podemos usar otras. <span class="math inline">\(\theta\)</span> representa cualquier parámetro <em>auxiliar</em> o <em>ruido</em> que pueda tener la distribución, por ejemplo <span class="math inline">\(\sigma\)</span> para la distribución Normal. También tenemos <span class="math inline">\(f\)</span>, generalmente llamada función de enlace inverso. Cuando <span class="math inline">\(\phi\)</span> es Normal, entonces <span class="math inline">\(f\)</span> es la función identidad. Para distribuciones como Gamma y NegativeBinomial, <span class="math inline">\(f\)</span> suele ser la función exponencial. ¿Por qué necesitamos <span class="math inline">\(f\)</span>? Porque <span class="math inline">\(\mu\)</span> generalmente tomará valores en los reales, para una distribución como la Normal esto es correcto ya que la media está definida en los resles, pero esto no es necesariamente así para otras distribuciones. Por ejemplo, el parámetro <span class="math inline">\(\mu\)</span> de la NegativaBinomial se define solo para números positivos, por lo que necesitamos una transformación que nos lleve de los reales a los positivos. La función exponencial es un buen candidato para esta transformación. Vamos a explorar varios GLM, un buen ejercicio es crear una tabla y cada vez que veamos una un nuevo GLM, agregar una línea que indique qué es <span class="math inline">\(phi\)</span>, <span class="math inline">\(theta\)</span>, <span class="math inline">\(f\)</span> y tal vez algunas notas sobre cuándo se usa este GLM. Bien, comencemos con nuestro primer ejemplo concreto de un GLM.</p>
</section>
<section id="generalizando-el-modelo-lineal-para-datos-de-conteo" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="generalizando-el-modelo-lineal-para-datos-de-conteo"><span class="header-section-number">6.4</span> Generalizando el modelo lineal para datos de conteo</h2>
<p>¿Cómo podemos cambiar <code>modelo_bl</code> para acomodar mejor los datos de las bicicletas? Hay dos cosas a tener en cuenta, el número de bicicletas alquiladas es discreto y está acotado en cero. Esto generalmente se conoce como datos de conteo. Se les llama así porque son el resultado de contar algo. Los datos de conteo a veces se modelan usando una distribución continua como una Normal, especialmente cuando el número de conteos es grande. Pero a menudo es una buena idea usar una distribución discreta. Dos opciones comunes son la distribución de Poisson y el NegativaBinomial. La principal diferencia es que, para la distribución de Poisson, la media y la varianza son iguales y están controladas por un mismo parámetro. Asumir que la media y la varianza son idénticas puede no ser adecuado. En esos casos es común tomar como alternativa la distribución NegativaBinomial, ya que permite que la media y la varianza sean diferentes. Ante la duda es posible generar dos modelos y evaluar si una Poisson o una NegativaBinomial es más adecuada. Más adelante veremos algunos criterios para comparar modelos, por ahora vamos a usar la distribución NegativaBinomial.</p>
<p>El modelo de PyMC es muy similar al anterior, pero con dos diferencias principales. Primero, usamos <code>pm.NegativeBinomial</code> en lugar de <code>pm.Normal</code> para el likelihood. La distribución NegativaBinomial tiene dos parámetros, la media <span class="math inline">\(\mu\)</span> y un parámetro de dispersión <span class="math inline">\(\alpha\)</span>. La varianza de la NegativaBinomial es <span class="math inline">\(\mu + \frac{\mu^2}{\alpha}\)</span>. Entonces, cuanto mayor sea el valor de <span class="math inline">\(\alpha\)</span>, mayor será la varianza. La segunda diferencia es que <span class="math inline">\(\mu\)</span> es <code>pm.math.exp(α + β * bikes.temperatura)</code> en lugar de solo <code>α + β * bikes.temperatura</code>, como ya explicamos, esto es necesario para transformar los realaes a valores positivos.</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a><span class="cf">with</span> pm.Model() <span class="im">as</span> modelo_neg:</span>
<span id="cb16-2"><a href="#cb16-2"></a>    α <span class="op">=</span> pm.Normal(<span class="st">'α'</span>, mu<span class="op">=</span><span class="dv">0</span>, sigma<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb16-3"><a href="#cb16-3"></a>    β <span class="op">=</span> pm.Normal(<span class="st">'β'</span>, mu<span class="op">=</span><span class="dv">0</span>, sigma<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb16-4"><a href="#cb16-4"></a>    σ <span class="op">=</span> pm.HalfCauchy(<span class="st">'σ'</span>, <span class="dv">10</span>)</span>
<span id="cb16-5"><a href="#cb16-5"></a>    μ <span class="op">=</span> pm.Deterministic(<span class="st">'μ'</span>, pm.math.exp(α <span class="op">+</span> β <span class="op">*</span> bicis.temperatura))</span>
<span id="cb16-6"><a href="#cb16-6"></a>    y_pred <span class="op">=</span> pm.NegativeBinomial(<span class="st">'y_pred'</span>, mu<span class="op">=</span>μ, alpha<span class="op">=</span>σ, observed<span class="op">=</span>bicis.alquiladas)</span>
<span id="cb16-7"><a href="#cb16-7"></a>    idata_neg <span class="op">=</span> pm.sample(random_seed<span class="op">=</span><span class="dv">123</span>)</span>
<span id="cb16-8"><a href="#cb16-8"></a>    idata_neg.extend(pm.sample_posterior_predictive(idata_neg))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [α, β, σ]</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="8000" class="" max="8000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [8000/8000 00:05&lt;00:00 Sampling 4 chains, 0 divergences]
    </div>
    
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 5 seconds.
Sampling: [y_pred]</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="4000" class="" max="4000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [4000/4000 00:00&lt;00:00]
    </div>
    
</div>
</div>
<p>La distribución predictiva a posteriori para <code>modelo_neg</code> se muestra en la siguiente figura. Podemos ver que ya no predecimos valores negativos y que la varianza de las predicciones aumenta con la media. Esto es de esperar ya que la varianza de la NegativaBinomial es <span class="math inline">\(\mu + \frac{\mu^2}{\alpha}\)</span>.</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a>linea_media <span class="op">=</span> idata_neg.posterior[<span class="st">'μ'</span>].mean((<span class="st">"chain"</span>, <span class="st">"draw"</span>))</span>
<span id="cb19-2"><a href="#cb19-2"></a>idx <span class="op">=</span> np.argsort(bicis.temperatura.values)</span>
<span id="cb19-3"><a href="#cb19-3"></a>x <span class="op">=</span> np.linspace(bicis.temperatura.<span class="bu">min</span>(), bicis.temperatura.<span class="bu">max</span>(), <span class="dv">15</span>)</span>
<span id="cb19-4"><a href="#cb19-4"></a>y_pred_q <span class="op">=</span> idata_neg.posterior_predictive[<span class="st">'y_pred'</span>].quantile([<span class="fl">0.03</span>, <span class="fl">0.97</span>, <span class="fl">0.25</span>, <span class="fl">0.75</span>], dim<span class="op">=</span>[<span class="st">'chain'</span>, <span class="st">'draw'</span>])</span>
<span id="cb19-5"><a href="#cb19-5"></a>y_hat_bounds <span class="op">=</span> <span class="bu">iter</span>([PchipInterpolator(bicis.temperatura.values[idx], y_pred_q[i][idx])(x) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">4</span>)])</span>
<span id="cb19-6"><a href="#cb19-6"></a></span>
<span id="cb19-7"><a href="#cb19-7"></a>_, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">5</span>))</span>
<span id="cb19-8"><a href="#cb19-8"></a>ax.plot(bicis.temperatura, bicis.alquiladas, <span class="st">'.'</span>, color<span class="op">=</span><span class="st">"0.75"</span>, zorder<span class="op">=-</span><span class="dv">3</span>)</span>
<span id="cb19-9"><a href="#cb19-9"></a>ax.plot(bicis.temperatura[idx], linea_media[idx], c<span class="op">=</span><span class="st">'C0'</span>)</span>
<span id="cb19-10"><a href="#cb19-10"></a></span>
<span id="cb19-11"><a href="#cb19-11"></a><span class="cf">for</span> lb, ub <span class="kw">in</span> <span class="bu">zip</span>(y_hat_bounds, y_hat_bounds): </span>
<span id="cb19-12"><a href="#cb19-12"></a>    ax.fill_between(x,</span>
<span id="cb19-13"><a href="#cb19-13"></a>                    lb, ub,</span>
<span id="cb19-14"><a href="#cb19-14"></a>                    color<span class="op">=</span><span class="st">"C1"</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb19-15"><a href="#cb19-15"></a></span>
<span id="cb19-16"><a href="#cb19-16"></a>ax.set_xlabel(<span class="st">'temperatura'</span>)</span>
<span id="cb19-17"><a href="#cb19-17"></a>ax.set_ylabel(<span class="st">'bicis alquiladas'</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="05_Regresión_lineal_files/figure-html/cell-14-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>En la siguiente figura tenemos una prueba predictiva a posteriori para <code>modelo_bl</code> a la izquierda y <code>modelo_neg</code> a la derecha. Podemos ver que cuando se usa una Normal, la discrepancia más grande es que el modelo predice valores negativos para las bicicletas alquiladas, pero incluso para los valores positivos vemos que el el ajuste no es tan bueno. Por otro lado, el modelo con la distribución NegativaBinomial ajusta mejor los datos. Aunque el ajuste no es del todo perfecto, vemos que la cola de la distribución es más pesada para las predicciones que para las observaciones, pero también observamos que la probabilidad de esta demanda tan alta es baja. Entonces, en general, reafirmamos que el modelo NegativoBinomial es mejor que el Normal.</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a>_, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">4</span>))</span>
<span id="cb20-2"><a href="#cb20-2"></a>az.plot_ppc(idata_bl,  num_pp_samples<span class="op">=</span><span class="dv">200</span>,  alpha<span class="op">=</span><span class="fl">0.1</span>, colors<span class="op">=</span>[<span class="st">"C1"</span>, <span class="st">"C0"</span>, <span class="st">"C0"</span>], ax<span class="op">=</span>ax[<span class="dv">0</span>], mean<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb20-3"><a href="#cb20-3"></a>az.plot_ppc(idata_neg, num_pp_samples<span class="op">=</span><span class="dv">200</span>,  alpha<span class="op">=</span><span class="fl">0.1</span>, colors<span class="op">=</span>[<span class="st">"C1"</span>, <span class="st">"C0"</span>, <span class="st">"C0"</span>], ax<span class="op">=</span>ax[<span class="dv">1</span>], mean<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb20-4"><a href="#cb20-4"></a>ax[<span class="dv">0</span>].set_title(<span class="st">"Normal"</span>)</span>
<span id="cb20-5"><a href="#cb20-5"></a>ax[<span class="dv">1</span>].set_title(<span class="st">"NegativaBinomial"</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="05_Regresión_lineal_files/figure-html/cell-15-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="regresión-robusta" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="regresión-robusta"><span class="header-section-number">6.5</span> Regresión robusta</h2>
<p>Una vez estaba ejecutando una simulación compleja de un sistema molecular. En cada paso de la simulación, necesitabamos calcular una regresión lineal como paso intermedio. Teníamos razones teóricas y empíricas para pensar que nuestra “Y” era condicionalmente normal dada nuestra “X”, por lo que la regresión lineal simple debía funcionar. Pero de vez en cuando la simulación generaba algunos valores de “Y” muy por encima o por debajo de la del grueso de los datos, esto arruinaba completamente nuestra simulación y tenáimos que reiniciarla. Estos valores muy diferentes al grueso de los datos se denominan valores atípicos o aberrantes. El motivo del fracaso de nuestras simulaciones era que los valores atípicos estaban <em>tirando</em> de la línea de regresión hacia valores que daban un mut mal ajuste para el grueso de los datos y cuando pasabamos de esta estimación al siguiente paso de la simulación, todo se detenía. Resolvimos esto con la ayuda de nuestra buena amiga, la distribución T de Student, que como vimos anteriormente, tiene colas más pesadas que la distribución Normal. Esto significa que los valores atípicos tienen menos <em>influencia</em> en el resultado final, que se asemeja más al resultado que hubieramos obtenido en ausencia de los valores <em>atípicos</em>. Esto es un ejemplo de una regresión robusta.</p>
<p>Para ejemplificar la robustez que la distribución T de Student aporta a la regresión lineal, vamos a utilizar un conjunto de datos muy simple. Una versión ligeramente modificada del tercer grupo de datos del <a href="https://en.wikipedia.org/wiki/Anscombe%27s_quartet">cuarteto de Anscombe</a>.</p>
<p>En el siguiente modelo, estamos usando una exponencial desplazada (le sumamos 1) para evitar valores cercanos a cero. La distribución exponencial (no desplazada) pone demasiado peso en los valores cercanos a cero. En mi experiencia, esto está bien para datos con valores atípicos “moderados”, pero en algunos conjuntos de datos pequeños como este, es mejor evitar valores tan bajos. Esta recomendación, como otras, hay que tomarlas con una pizca de sal. Los valores por defecto son buenos puntos de partida, pero no es necesario ceñirse a ellos. Otro priors comunes para Gamma(2, 0.1) o Gamma(mu = 20, sd = 15).</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1"></a>ans <span class="op">=</span> pd.read_csv(<span class="st">'datos/anscombe_3.csv'</span>)</span>
<span id="cb21-2"><a href="#cb21-2"></a>ans.plot(<span class="st">"x"</span>, <span class="st">"y"</span>, kind<span class="op">=</span><span class="st">"scatter"</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="05_Regresión_lineal_files/figure-html/cell-16-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a><span class="cf">with</span> pm.Model() <span class="im">as</span> modelo_t:</span>
<span id="cb22-2"><a href="#cb22-2"></a>    α <span class="op">=</span> pm.Normal(<span class="st">'α'</span>, mu<span class="op">=</span>ans.y.mean(), sigma<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb22-3"><a href="#cb22-3"></a>    β <span class="op">=</span> pm.Normal(<span class="st">'β'</span>, mu<span class="op">=</span><span class="dv">0</span>, sigma<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb22-4"><a href="#cb22-4"></a>    σ <span class="op">=</span> pm.HalfNormal(<span class="st">'σ'</span>, <span class="dv">5</span>)</span>
<span id="cb22-5"><a href="#cb22-5"></a>    ν_ <span class="op">=</span> pm.Exponential(<span class="st">'ν_'</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">29</span>)</span>
<span id="cb22-6"><a href="#cb22-6"></a>    ν <span class="op">=</span> pm.Deterministic(<span class="st">'ν'</span>, ν_ <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb22-7"><a href="#cb22-7"></a>    μ <span class="op">=</span> pm.Deterministic(<span class="st">'μ'</span>, α <span class="op">+</span> β <span class="op">*</span> ans.x)</span>
<span id="cb22-8"><a href="#cb22-8"></a>    _ <span class="op">=</span> pm.StudentT(<span class="st">'y_pred'</span>, mu<span class="op">=</span>μ, sigma<span class="op">=</span>σ, nu<span class="op">=</span>ν, observed<span class="op">=</span>ans.y)</span>
<span id="cb22-9"><a href="#cb22-9"></a>    idata_t <span class="op">=</span> pm.sample(<span class="dv">2000</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [α, β, σ, ν_]</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="12000" class="" max="12000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [12000/12000 00:05&lt;00:00 Sampling 4 chains, 0 divergences]
    </div>
    
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Sampling 4 chains for 1_000 tune and 2_000 draw iterations (4_000 + 8_000 draws total) took 6 seconds.</code></pre>
</div>
</div>
<p>En la siguiente figura podemos ver el ajuste robusto, según <code>model_t</code>, y el ajuste no robusto, según <code>linregress</code> de SciPy (esta función está haciendo una regresión por mínimos cuadrados).</p>
<p>Mientras que el ajuste no robusto trata de <em>comprometerse</em> e incluir todos los puntos, el ajuste Bayesiano robusto, <code>model_t</code>, automáticamente <em>descarta</em> (o le reduce <em>peso</em>) a un punto y ajusta una línea que pasa más cerca de todos los puntos restantes</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1"></a>beta_c, alpha_c, <span class="op">*</span>_ <span class="op">=</span> linregress(ans.x, ans.y)</span>
<span id="cb25-2"><a href="#cb25-2"></a></span>
<span id="cb25-3"><a href="#cb25-3"></a>_, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb25-4"><a href="#cb25-4"></a>ax.plot(ans.x, (alpha_c <span class="op">+</span> beta_c <span class="op">*</span> ans.x), <span class="st">'C0:'</span>, label<span class="op">=</span><span class="st">'non-robust'</span>)</span>
<span id="cb25-5"><a href="#cb25-5"></a>ax.plot(ans.x, ans.y, <span class="st">'C0o'</span>)</span>
<span id="cb25-6"><a href="#cb25-6"></a>alpha_m <span class="op">=</span> idata_t.posterior[<span class="st">'α'</span>].mean((<span class="st">"chain"</span>, <span class="st">"draw"</span>))</span>
<span id="cb25-7"><a href="#cb25-7"></a>beta_m <span class="op">=</span> idata_t.posterior[<span class="st">'β'</span>].mean((<span class="st">"chain"</span>, <span class="st">"draw"</span>))</span>
<span id="cb25-8"><a href="#cb25-8"></a></span>
<span id="cb25-9"><a href="#cb25-9"></a>x_plot <span class="op">=</span> xr.DataArray(np.linspace(ans.x.<span class="bu">min</span>(), ans.x.<span class="bu">max</span>(), <span class="dv">50</span>), dims<span class="op">=</span><span class="st">"plot_id"</span>)</span>
<span id="cb25-10"><a href="#cb25-10"></a>ax.plot(x_plot, alpha_m <span class="op">+</span> beta_m <span class="op">*</span> x_plot, c<span class="op">=</span><span class="st">'C0'</span>, label<span class="op">=</span><span class="st">"robust"</span>)</span>
<span id="cb25-11"><a href="#cb25-11"></a>az.plot_hdi(ans.x, az.hdi(idata_t.posterior[<span class="st">'μ'</span>])[<span class="st">'μ'</span>].T, ax<span class="op">=</span>ax)</span>
<span id="cb25-12"><a href="#cb25-12"></a>ax.set_xlabel(<span class="st">'x'</span>)</span>
<span id="cb25-13"><a href="#cb25-13"></a>ax.set_ylabel(<span class="st">'y'</span>, rotation<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb25-14"><a href="#cb25-14"></a>ax.legend(loc<span class="op">=</span><span class="dv">2</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="05_Regresión_lineal_files/figure-html/cell-18-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>En la siguiente figura podemos ver que obtenemos una muy buena coincidencia. También podmeos ver que nuestro modelo predice valores alejados del grueso de los datos hacia ambos lados.</p>
<div class="cell" data-scrolled="true" data-execution_count="18">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1"></a>pm.sample_posterior_predictive(idata_t, model<span class="op">=</span>modelo_t, random_seed<span class="op">=</span><span class="dv">2</span>, extend_inferencedata<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb26-2"><a href="#cb26-2"></a>ax <span class="op">=</span> az.plot_ppc(idata_t, num_pp_samples<span class="op">=</span><span class="dv">200</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>),  colors<span class="op">=</span>[<span class="st">"C1"</span>, <span class="st">"C0"</span>, <span class="st">"C1"</span>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Sampling: [y_pred]</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="8000" class="" max="8000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [8000/8000 00:00&lt;00:00]
    </div>
    
</div>
<div class="cell-output cell-output-display">
<p><img src="05_Regresión_lineal_files/figure-html/cell-19-output-4.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="regresión-logística" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="regresión-logística"><span class="header-section-number">6.6</span> Regresión logística</h2>
<p>La regresión logistica es la generalización del modelo de regresión simple para cuando la variable dependiente es binaria. Esta generalización se logra en dos pasos. Primero utilizamos la funcion logística como función inversa de enlace:</p>
<p><span class="math display">\[ \text{logística}(z) = \frac{1}{1 + e^{-z}} \]</span></p>
<p>Usamos esta función por que una de sus propiedades es que no importa el valor del argumento <span class="math inline">\(z\)</span>, el resultado siempre será un valor en el intervalo [0, 1]. La función logística es conocida también como función sigmoide, por su aspecto típico de <em>S</em> como se puede ver al ejecutar la siguiente celda:</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1"></a>z <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">6</span>, <span class="dv">6</span>)</span>
<span id="cb28-2"><a href="#cb28-2"></a>logística <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> np.exp(<span class="op">-</span>z))</span>
<span id="cb28-3"><a href="#cb28-3"></a>plt.plot(z, logística)</span>
<span id="cb28-4"><a href="#cb28-4"></a>plt.xlabel(<span class="st">'z'</span>)</span>
<span id="cb28-5"><a href="#cb28-5"></a>plt.ylabel(<span class="st">'logística(z)'</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="05_Regresión_lineal_files/figure-html/cell-20-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>El segundo paso consiste en usar como likelihood una distribución binomial y no una Gaussiana. De esta forma el modelo queda expresado como:</p>
<p><span class="math display">\[
\begin{aligned}
\theta &amp;= \text{logística}(\alpha + \beta X) \\
Y &amp;\sim \text{Bern}(\theta)
\end{aligned}
\]</span></p>
<p>Esto modelo se puede motivar de la siguiente forma. Si nuestros datos son binarios <span class="math inline">\(y \in \{0, 1\}\)</span>, como con el ejemplo de la moneda, vemos que tiene sentido usar una distribución Bernoulli. Esta distribución está parametrizada por un único parámetro en el intervalo [0, 1], el cual puede ser generado desde un modelo lineal siempre y cuando los valores generados por el modelo lineal sean <em>comprimidos</em> al intervalo [0, 1], algo que puede ser obtenido al emplear una función logística.</p>
</section>
<section id="el-modelo-logístico-aplicado-al-conjunto-de-datos-del-iris." class="level2" data-number="6.7">
<h2 data-number="6.7" class="anchored" data-anchor-id="el-modelo-logístico-aplicado-al-conjunto-de-datos-del-iris."><span class="header-section-number">6.7</span> El modelo logístico aplicado al conjunto de datos del iris.</h2>
<p>Vamos a aplicar una regresión logística al conjunto de datos Iris. Este es un conjunto de datos clásico que contiene información sobre flores de 3 especies estrechamente relacionadas: setosa, virginica y versicolor. Estas serán nuestras variables dependientes, las clases que queremos predecir. Tenemos 50 individuos de cada especie y para cada individuo el conjunto de datos contiene cuatro variables que vamos a usar como variables independientes. Estas son el largo del pétalo, el ancho del pétalo, el largo del sépalo y el ancho del sépalo. Por si se lo están preguntando, los sépalos son hojas modificadas cuya función está generalmente relacionada con la protección de las flores en la yema.</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1"></a>iris <span class="op">=</span> pd.read_csv(<span class="st">'datos/iris.csv'</span>)</span>
<span id="cb29-2"><a href="#cb29-2"></a>iris.head()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>sepal_length</th>
      <th>sepal_width</th>
      <th>petal_length</th>
      <th>petal_width</th>
      <th>species</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.6</td>
      <td>3.1</td>
      <td>1.5</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>3.6</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Vamos a comenzar con la regresión logística más simple posible: dos clases, setosa y versicolor, y solo una variable independiente, la longitud del sépalo. Como se hace normalmente, vamos a codificar las variables categóricas setosa y versicolor con los números 0 y 1. Usando Pandas podemos hacer:</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1"></a>df <span class="op">=</span> iris.query(<span class="st">"species == ('setosa', 'versicolor')"</span>)</span>
<span id="cb30-2"><a href="#cb30-2"></a>y_0 <span class="op">=</span> pd.Categorical(df[<span class="st">'species'</span>]).codes</span>
<span id="cb30-3"><a href="#cb30-3"></a>x_n <span class="op">=</span> <span class="st">'sepal_length'</span> </span>
<span id="cb30-4"><a href="#cb30-4"></a>x_0 <span class="op">=</span> df[x_n].values</span>
<span id="cb30-5"><a href="#cb30-5"></a>x_c <span class="op">=</span> x_0 <span class="op">-</span> x_0.mean()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Al igual que con otros modelos lineales, centrar los datos puede ayudar con el muestreo. Ahora que tenemos los datos en el formato adecuado, finalmente podemos construir el modelo con PyMC.</p>
<p>Observe cómo la primera parte del siguiente modelo se asemeja a un modelo de regresión lineal. Este modelo tiene dos variables deterministas: <code>θ</code> y<code>bd</code>. <code>θ</code> es la salida de la función logística aplicada a la variable <code>μ</code> y <code>bd</code> es límite de decisión (el cual explicaremos más adelante). Otro punto que vale la pena mencionar es que en lugar de escribir explícitamente la función logística estamos usando <code>pm.math.sigmoid</code>.</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1"></a><span class="cf">with</span> pm.Model() <span class="im">as</span> modelo_rl:</span>
<span id="cb31-2"><a href="#cb31-2"></a>    α <span class="op">=</span> pm.Normal(<span class="st">'α'</span>, mu<span class="op">=</span><span class="dv">0</span>, sigma<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb31-3"><a href="#cb31-3"></a>    β <span class="op">=</span> pm.Normal(<span class="st">'β'</span>, mu<span class="op">=</span><span class="dv">0</span>, sigma<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb31-4"><a href="#cb31-4"></a>    </span>
<span id="cb31-5"><a href="#cb31-5"></a>    μ <span class="op">=</span> α <span class="op">+</span> β <span class="op">*</span> x_c   </span>
<span id="cb31-6"><a href="#cb31-6"></a>    θ <span class="op">=</span> pm.Deterministic(<span class="st">'θ'</span>, pm.math.sigmoid(μ))</span>
<span id="cb31-7"><a href="#cb31-7"></a>    bd <span class="op">=</span> pm.Deterministic(<span class="st">'bd'</span>, <span class="op">-</span>α<span class="op">/</span>β)</span>
<span id="cb31-8"><a href="#cb31-8"></a>    </span>
<span id="cb31-9"><a href="#cb31-9"></a>    yl <span class="op">=</span> pm.Bernoulli(<span class="st">'yl'</span>, p<span class="op">=</span>θ, observed<span class="op">=</span>y_0)</span>
<span id="cb31-10"><a href="#cb31-10"></a></span>
<span id="cb31-11"><a href="#cb31-11"></a>    idata_rl <span class="op">=</span> pm.sample()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [α, β]</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="8000" class="" max="8000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [8000/8000 00:01&lt;00:00 Sampling 4 chains, 0 divergences]
    </div>
    
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 2 seconds.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1"></a>az.summary(idata_rl, var_names<span class="op">=</span><span class="st">'~θ'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>mean</th>
      <th>sd</th>
      <th>hdi_3%</th>
      <th>hdi_97%</th>
      <th>mcse_mean</th>
      <th>mcse_sd</th>
      <th>ess_bulk</th>
      <th>ess_tail</th>
      <th>r_hat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>α</th>
      <td>0.265</td>
      <td>0.306</td>
      <td>-0.310</td>
      <td>0.826</td>
      <td>0.005</td>
      <td>0.004</td>
      <td>3568.0</td>
      <td>2781.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>β</th>
      <td>5.181</td>
      <td>0.961</td>
      <td>3.413</td>
      <td>6.906</td>
      <td>0.017</td>
      <td>0.012</td>
      <td>3314.0</td>
      <td>2577.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>bd</th>
      <td>-0.051</td>
      <td>0.059</td>
      <td>-0.155</td>
      <td>0.068</td>
      <td>0.001</td>
      <td>0.001</td>
      <td>3631.0</td>
      <td>2873.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Ahora vamos a graficar los datos junto con la curva sigmoide ajustada:</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1"></a>posterior <span class="op">=</span> idata_rl.posterior</span>
<span id="cb35-2"><a href="#cb35-2"></a>theta <span class="op">=</span> posterior[<span class="st">"θ"</span>].mean((<span class="st">"chain"</span>, <span class="st">"draw"</span>))</span>
<span id="cb35-3"><a href="#cb35-3"></a>idx <span class="op">=</span> np.argsort(x_c)</span>
<span id="cb35-4"><a href="#cb35-4"></a></span>
<span id="cb35-5"><a href="#cb35-5"></a>_, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb35-6"><a href="#cb35-6"></a></span>
<span id="cb35-7"><a href="#cb35-7"></a>ax.plot(x_c[idx], theta[idx], color<span class="op">=</span><span class="st">'C0'</span>, lw<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb35-8"><a href="#cb35-8"></a>ax.vlines(posterior[<span class="st">'bd'</span>].mean((<span class="st">"chain"</span>, <span class="st">"draw"</span>)), <span class="dv">0</span>, <span class="dv">1</span>, color<span class="op">=</span><span class="st">'C1'</span>, zorder<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb35-9"><a href="#cb35-9"></a>bd_hdi <span class="op">=</span> az.hdi(posterior[<span class="st">'bd'</span>])</span>
<span id="cb35-10"><a href="#cb35-10"></a>ax.fill_betweenx([<span class="dv">0</span>, <span class="dv">1</span>], bd_hdi[<span class="st">"bd"</span>][<span class="dv">0</span>], bd_hdi[<span class="st">"bd"</span>][<span class="dv">1</span>], color<span class="op">=</span><span class="st">'C1'</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, lw<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb35-11"><a href="#cb35-11"></a>ax.scatter(x_c, np.random.normal(y_0, <span class="fl">0.02</span>), marker<span class="op">=</span><span class="st">'.'</span>, color<span class="op">=</span>[<span class="ss">f'</span><span class="sc">{</span><span class="fl">0.5</span><span class="op">*</span>x<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> x <span class="kw">in</span> y_0])</span>
<span id="cb35-12"><a href="#cb35-12"></a>az.plot_hdi(x_c, posterior[<span class="st">'θ'</span>], color<span class="op">=</span><span class="st">'C0'</span>, ax<span class="op">=</span>ax, fill_kwargs<span class="op">=</span>{<span class="st">"lw"</span>: <span class="dv">0</span>})</span>
<span id="cb35-13"><a href="#cb35-13"></a>ax.set_xlabel(x_n)</span>
<span id="cb35-14"><a href="#cb35-14"></a>ax.set_ylabel(<span class="st">'θ'</span>, rotation<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb35-15"><a href="#cb35-15"></a><span class="co"># usar escala original para los xticks</span></span>
<span id="cb35-16"><a href="#cb35-16"></a>locs, _ <span class="op">=</span> plt.xticks()</span>
<span id="cb35-17"><a href="#cb35-17"></a>ax.set_xticks(locs, np.<span class="bu">round</span>(locs <span class="op">+</span> x_0.mean(), <span class="dv">1</span>))<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="05_Regresión_lineal_files/figure-html/cell-25-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>La figura anterior muestra la longitud del sépalo para las especies (setosa = 0, versicolor = 1). Para mitigar la superposición de los datos, hemos agregado ruido (<em>jitter</em>) a las variable-respuesta que es binaria. Una línea azul en forma de <em>S</em> representa el valor medio de <span class="math inline">\(\theta\)</span>. Esta línea se puede interpretar como la probabilidad que una flor sea versicolor dado el valor de longitud del sépalo. La banda azul semitransparente es el HDI 94%.</p>
</section>
<section id="clasificación-con-regresión-logística" class="level2" data-number="6.8">
<h2 data-number="6.8" class="anchored" data-anchor-id="clasificación-con-regresión-logística"><span class="header-section-number">6.8</span> Clasificación con regresión logística</h2>
<p>Mi madre prepara un plato delicioso llamado sopa seca, que básicamente es una receta a base de tallarines y que prácticamente no tienen agua. Si bien puede parecer un nombre inapropiado, el nombre del plato cobra total sentido cuando aprendemos cómo se cocina, una parte del agua que se agrega inicialmente se pierde por evaporación y la otra es absorvida por los fideos. Algo similar sucede con la regresión logística. Es usual que este modelo se muestre como un método de clasificación (y no de regresión). Veamos la fuente de esta dualidad.</p>
<p>Los problemas de regresión consisten en predecir un valor continuo para una variable de salida dados los valores de una o más variables de entrada. Y una clasificación es un problema de asignación de valores discretos a una variable de salida dadas unas variables de entrada. Por ejemplo, asignar la clases <code>versicolor</code> dada la longitud de su sépalo.</p>
<p>Entonces, ¿la regresión logística es una regresión o un método de clasificación? La respuesta es que es un método de regresión, solo que la regresión se hace sobre la probabilidad de pertenecer a una de dos clases. Pero también es posible usar una regresión logística como clasificador. Lo único que necesitamos es una regla de decisión. Por ej asignár la clase <code>versicolor</code> si <span class="math inline">\(\theta \ge 0.5\)</span> y <code>setosa</code> en caso contrario.</p>
<p>La línea vertical en la figura anterior es el límite de decisión, y se define como el valor de la variable independiente que hace que la probabilidad de la clase 1 (versicolor en nuestro ejemplo) sea igual a 0,5. Para este modelo podemos calcular este valor analíticamente y es <span class="math inline">\(-\frac{\alpha}{\beta}\)</span>.</p>
<p>A partir de la definición del modelo tenemos la relación:</p>
<p><span class="math display">\[\theta = \text{logística}(\alpha + x \beta)\]</span></p>
<p>Y a partir de la definición de la función logística tenemos que $= 0.5 $, cuando el argumento de la regresión logística es 0, es decir:</p>
<p><span class="math display">\[0.5 = \text{logística}(\alpha + x_i \beta) \Leftrightarrow 0 = \alpha + x_i \beta\]</span></p>
<p>Reordenando encontramos que el valor de <span class="math inline">\(x_i\)</span>, para el cual, <span class="math inline">\(\theta = 0.5\)</span> corresponde a la expresión:</p>
<p><span class="math display">\[x_i = - \frac{\alpha}{\beta}\]</span></p>
<p>Resumiendo los puntos más importantes hasta el momento:</p>
<ul>
<li><p>El valor de <span class="math inline">\(\theta\)</span> es, en términos generales, $p(y= 1 x) $. En este sentido, la regresión logística es en realidad una regresión, solo que estamos <em>regresionando</em> la probabilidad que una observación pertenezca a la clase 1.</p></li>
<li><p>Estamos modelando la media de una variable dicotómica, es decir, un número en el intervalo [0-1]. Luego, introducimos una regla para convertir esta probabilidad en una asignación de dos clases. En este caso, si $p(y = 1) &gt;= 0.5 $ asignamos clase 1, de lo contrario clase 0.</p></li>
<li><p>No hay nada especial en el valor 0.5, aparte de que es el número en el medio entre 0 y 1. Podemos argumentar que este límite solo es razonable si estamos de acuerdo en cometer un error en una u otra dirección. En otras palabras, si es lo mismo para nosotros clasificar erróneamente una setosa como versicolor o una versicolor como setosa. Resulta que este no es siempre el caso, y el costo asociado a la clasificación errónea no tiene por qué ser simétrico.</p></li>
</ul>
</section>
<section id="interpretación-de-los-coeficientes-de-una-regresión-logística" class="level2" data-number="6.9">
<h2 data-number="6.9" class="anchored" data-anchor-id="interpretación-de-los-coeficientes-de-una-regresión-logística"><span class="header-section-number">6.9</span> Interpretación de los coeficientes de una regresión logística</h2>
<p>Debemos tener cuidado al interpretar los coeficientes <span class="math inline">\(\beta\)</span> de una regresión logística. La interpretación no es tan sencilla como con los modelos lineales en el capítulo anterior. La función logística introduce una no linearidad, que debemos tener en cuenta. Si <span class="math inline">\(\beta\)</span> es positivo, aumentar <span class="math inline">\(x\)</span> aumentará <span class="math inline">\(p(y = 1)\)</span> en cierta cantidad, pero la cantidad no es una función lineal de <span class="math inline">\(x\)</span>, es en cambio una función no-lineal de <span class="math inline">\(x\)</span>. Podemos visualizar este hecho en la figura 4.4, en lugar de una línea con una pendiente constante, tenemos una línea en forma de S con una pendiente que cambia en función de <span class="math inline">\(x\)</span>. Un poco de álgebra nos puede dar una idea de cuánto cambia <span class="math inline">\(p(y=1)\)</span> con <span class="math inline">\(\beta\)</span>:</p>
<p>El modelo logístico básico es:</p>
<p><span class="math display">\[\theta = logistic (\alpha + X \beta) \]</span></p>
<p>El inverso de la logística es la función logit, que es:</p>
<p><span class="math display">\[ logit(z) = log \left (\frac{z}{1-z} \right)\]</span></p>
<p>Por lo tanto, si tomamos la primera ecuación en esta sección y aplicamos la función logit a ambos términos, obtenemos:</p>
<p><span class="math display">\[ logit(\theta) = \alpha + X \beta\]</span></p>
<p>O equivalente:</p>
<p><span class="math display">\[ log \left (\frac{\theta} {1-\theta} \right) = \alpha + X \beta\]</span></p>
<p>Recuerden que <span class="math inline">\(\theta\)</span> en nuestro modelo era la probabilidad de $y = 1 $, por lo tanto:</p>
<p><span class="math display">\[ log \left(\frac {p(y = 1)} {1-p (y = 1)} \right) = \alpha + X \beta \]</span></p>
<p>La cantidad <span class="math display">\[\frac{p (y = 1)} {1-p (y = 1)}\]</span> se conoce como <strong>odds</strong>. Los odds a favor se definen como la relación entre la probabilidad de éxito y la probabilidad de no éxito. Mientras que la probabilidad de obtener 2 tirando un dado es 1/6, los odds para el mismo evento son <span class="math inline">\(\frac{1/6}{5/6} = 0.2\)</span> o dicho de otra forma 1 evento favorable frente a 5 eventos desfavorables. Mientras las probabilidades toman valores en el intervalo [0, 1], los odds lo hacen en <span class="math inline">\([0, \infty)\)</span>. Veamos otro ejemplo, si la probabilidad de lluvia mañana es <span class="math inline">\(\frac{3}{4}\)</span>, entonces la probabilidad de que no llueva es <span class="math inline">\(\frac{1}{4}\)</span> y entonces el odds será de 3. Es decir es tres veces más probable que llueva respecto de que no llueva. Si en cambio la probabilidad fuese <span class="math inline">\(\frac{1}{2}\)</span> entonces el odds sería 1. Es tan probable que llueva como que no lo haga. Los odds suelen ser utilizadas por los apostadores ya que proporcionan una herramienta más intuitiva que las probabilidades <em>en bruto</em> cuando se piensa en la forma correcta de apostar.</p>
<blockquote class="blockquote">
<p>En una regresión logística, el coeficiente <span class="math inline">\(\beta\)</span> codifica el aumento en unidades de log-odds por unidad de aumento de la variable <span class="math inline">\(x\)</span>.</p>
</blockquote>
<p>La transformación de probabilidad a odds es una transformación monotónica, lo que significa que las probabilidades aumentan a medida que aumenta la probabilidad. Mientras que las probabilidades están restringidas al intervalo <span class="math inline">\([0, 1]\)</span>, los odds viven en el intervalo <span class="math inline">\([0, \infty]\)</span>. El logaritmo es otra transformación monótonica y los log-odds están en el intervalo <span class="math inline">\([-\infty, \infty]\)</span>. La siguiente figura muestra cómo la probabilidad está relacionada con los odds y los log-odds.</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1"></a>probability <span class="op">=</span> np.linspace(<span class="fl">0.01</span>, <span class="dv">1</span>, <span class="dv">100</span>)</span>
<span id="cb36-2"><a href="#cb36-2"></a>odds <span class="op">=</span> probability <span class="op">/</span> (<span class="dv">1</span> <span class="op">-</span> probability)</span>
<span id="cb36-3"><a href="#cb36-3"></a></span>
<span id="cb36-4"><a href="#cb36-4"></a>_, ax1 <span class="op">=</span> plt.subplots()</span>
<span id="cb36-5"><a href="#cb36-5"></a>ax2 <span class="op">=</span> ax1.twinx()</span>
<span id="cb36-6"><a href="#cb36-6"></a>ax1.plot(probability, odds, <span class="st">'C0'</span>)</span>
<span id="cb36-7"><a href="#cb36-7"></a>ax2.plot(probability, np.log(odds), <span class="st">'C2'</span>)</span>
<span id="cb36-8"><a href="#cb36-8"></a></span>
<span id="cb36-9"><a href="#cb36-9"></a>ax1.set_xlabel(<span class="st">'probabilidad'</span>)</span>
<span id="cb36-10"><a href="#cb36-10"></a>ax1.set_ylabel(<span class="st">'odds'</span>, color<span class="op">=</span><span class="st">'C0'</span>)</span>
<span id="cb36-11"><a href="#cb36-11"></a>ax2.set_ylabel(<span class="st">'log-odds'</span>, color<span class="op">=</span><span class="st">'C2'</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_47279/2677285095.py:2: RuntimeWarning: divide by zero encountered in divide
  odds = probability / (1 - probability)</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="05_Regresión_lineal_files/figure-html/cell-26-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>Entonces averigüemos cuantas veces más probable es que una flor sea versicolor por unidad del largo del sépalo</p>
</section>
<section id="varianza-variable" class="level2" data-number="6.10">
<h2 data-number="6.10" class="anchored" data-anchor-id="varianza-variable"><span class="header-section-number">6.10</span> Varianza variable</h2>
<p>Hemos estado usando el modelo lineal para modelar la media de una distribución, dejando la varianza de lado. En caso que consideremos que el supuesto de varianza constante no tiene sentido podemos considerar la varianza como una función (lineal) de la variable dependiente.</p>
<p>La Organización Mundial de la Salud y otras instituciones de salud de todo el mundo recopilan datos para recién nacidos y diseñan estándares de crecimiento. Estas tablas son un componente esencial del conjunto de herramientas pediátricas y también como una medida del bienestar general de las poblaciones con el fin de formular políticas de salud, planificar intervenciones y controlar su eficacia. Un ejemplo de tales datos son la longitud (alturas) de las niñas recién nacidas en función de la edad (en meses):</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1"></a>data <span class="op">=</span> pd.read_csv(<span class="st">'datos/babies.csv'</span>)</span>
<span id="cb38-2"><a href="#cb38-2"></a>data.plot.scatter(<span class="st">'Meses'</span>, <span class="st">'Longitud'</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="05_Regresión_lineal_files/figure-html/cell-27-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Para modelar estos datos, presentaremos 3 elementos nuevos en comparación con los modelos anteriores:</p>
<ul>
<li><span class="math inline">\(\sigma\)</span> ahora es una función lineal de <span class="math inline">\(x\)</span>, y para hacer esto agregamos dos nuevos parámetros <span class="math inline">\(\gamma\)</span> y <span class="math inline">\(\delta\)</span>, estos son análogos directos de <span class="math inline">\(\alpha\)</span> y <span class="math inline">\(\beta\)</span>.</li>
<li>El modelo lineal para la media es una función de <span class="math inline">\(\sqrt{x}\)</span>, esto es solo un truco simple para ajustar un modelo lineal a una curva.</li>
<li>Hemos definido una variable compartida <code>x_shared</code>, esto nos permitirá cambiar los valores de la variable <span class="math inline">\(x\)</span> (<code>Meses</code> en este ejemplo) sin la necesidad de volver a muestrear el modelo. Esto quedará más claro con el ejemplo.</li>
</ul>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1"></a><span class="cf">with</span> pm.Model() <span class="im">as</span> model_vv:</span>
<span id="cb39-2"><a href="#cb39-2"></a>    x_shared <span class="op">=</span> pm.MutableData(<span class="st">"x_shared"</span>, data.Meses.values.astype(<span class="bu">float</span>))</span>
<span id="cb39-3"><a href="#cb39-3"></a>    α <span class="op">=</span> pm.Normal(<span class="st">'α'</span>, sigma<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb39-4"><a href="#cb39-4"></a>    β <span class="op">=</span> pm.Normal(<span class="st">'β'</span>, sigma<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb39-5"><a href="#cb39-5"></a>    γ <span class="op">=</span> pm.HalfNormal(<span class="st">'γ'</span>, sigma<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb39-6"><a href="#cb39-6"></a>    δ <span class="op">=</span> pm.HalfNormal(<span class="st">'δ'</span>, sigma<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb39-7"><a href="#cb39-7"></a></span>
<span id="cb39-8"><a href="#cb39-8"></a></span>
<span id="cb39-9"><a href="#cb39-9"></a>    μ <span class="op">=</span> pm.Deterministic(<span class="st">'μ'</span>, α <span class="op">+</span> β <span class="op">*</span> x_shared<span class="op">**</span><span class="fl">0.5</span>)</span>
<span id="cb39-10"><a href="#cb39-10"></a>    σ <span class="op">=</span> pm.Deterministic(<span class="st">'σ'</span>, γ <span class="op">+</span> δ <span class="op">*</span> x_shared)</span>
<span id="cb39-11"><a href="#cb39-11"></a>    </span>
<span id="cb39-12"><a href="#cb39-12"></a>    y_pred <span class="op">=</span> pm.Normal(<span class="st">'y_pred'</span>, mu<span class="op">=</span>μ, sigma<span class="op">=</span>σ, observed<span class="op">=</span>data.Longitud)</span>
<span id="cb39-13"><a href="#cb39-13"></a>    </span>
<span id="cb39-14"><a href="#cb39-14"></a>    idata_vv <span class="op">=</span> pm.sample()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [α, β, γ, δ]</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="8000" class="" max="8000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [8000/8000 00:04&lt;00:00 Sampling 4 chains, 0 divergences]
    </div>
    
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 5 seconds.</code></pre>
</div>
</div>
<p>La siguiente figura muestra el resultado de nuestro modelo. La media de es <span class="math inline">\(\mu\)</span> representada con una curva negra, y dos bandas turquesa semitransparentes representan 1 y 2 desviaciones estándar.</p>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1"></a>_, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">4</span>))</span>
<span id="cb42-2"><a href="#cb42-2"></a></span>
<span id="cb42-3"><a href="#cb42-3"></a>axes[<span class="dv">0</span>].plot(data.Meses, data.Longitud, <span class="st">'C0.'</span>, alpha<span class="op">=</span><span class="fl">0.1</span>)<span class="op">;</span></span>
<span id="cb42-4"><a href="#cb42-4"></a></span>
<span id="cb42-5"><a href="#cb42-5"></a>posterior <span class="op">=</span> az.extract(idata_vv)</span>
<span id="cb42-6"><a href="#cb42-6"></a></span>
<span id="cb42-7"><a href="#cb42-7"></a>μ_m <span class="op">=</span> posterior[<span class="st">'μ'</span>].mean(<span class="st">"sample"</span>).values</span>
<span id="cb42-8"><a href="#cb42-8"></a>ϵ_m <span class="op">=</span> posterior[<span class="st">'σ'</span>].mean(<span class="st">"sample"</span>).values</span>
<span id="cb42-9"><a href="#cb42-9"></a></span>
<span id="cb42-10"><a href="#cb42-10"></a>axes[<span class="dv">0</span>].plot(data.Meses, μ_m, c<span class="op">=</span><span class="st">'k'</span>)</span>
<span id="cb42-11"><a href="#cb42-11"></a>axes[<span class="dv">0</span>].fill_between(data.Meses, μ_m <span class="op">+</span> <span class="dv">1</span> <span class="op">*</span> ϵ_m, μ_m <span class="op">-</span> <span class="dv">1</span> <span class="op">*</span> ϵ_m, alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'C1'</span>)</span>
<span id="cb42-12"><a href="#cb42-12"></a>axes[<span class="dv">0</span>].fill_between(data.Meses, μ_m <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> ϵ_m, μ_m <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> ϵ_m, alpha<span class="op">=</span><span class="fl">0.4</span>, color<span class="op">=</span><span class="st">'C1'</span>)</span>
<span id="cb42-13"><a href="#cb42-13"></a></span>
<span id="cb42-14"><a href="#cb42-14"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'Meses'</span>)</span>
<span id="cb42-15"><a href="#cb42-15"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'Longitud'</span>)<span class="op">;</span></span>
<span id="cb42-16"><a href="#cb42-16"></a></span>
<span id="cb42-17"><a href="#cb42-17"></a></span>
<span id="cb42-18"><a href="#cb42-18"></a>axes[<span class="dv">1</span>].plot(data.Meses, ϵ_m)</span>
<span id="cb42-19"><a href="#cb42-19"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">'Meses'</span>)<span class="op">;</span></span>
<span id="cb42-20"><a href="#cb42-20"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="vs">r'$\bar ϵ$'</span>, rotation<span class="op">=</span><span class="dv">0</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="05_Regresión_lineal_files/figure-html/cell-29-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Ahora que tenemos ajustado el modelo podríamos querer usar el modelo para averiguar cómo se compara la longitud de una niña en particular respecto de la distribución. Una forma de responder a esta pregunta es preguntarle al modelo por la distribución de la variable <em>longitud</em> para bebas de digamos de 0.5 meses. Usando PyMC podemos hacer estas preguntas con la función <code>pm.sample_posterior_predictive</code>, ya que esto arrojará muestras de <span class="math inline">\(\tilde y\)</span> es decir los valores predichos considerando la incertidumbre de los parámetros. El único problema es que, por defecto, esta función devolverá valores de <span class="math inline">\(\tilde y\)</span> para los valores observados de <span class="math inline">\(x\)</span>, es decir los valores usando para ajustar el modelo. Pero que pasa si queremos obtener predicciones para que el modelo no vio? Como 0,5 meses que no es parte de los datos originales. La manera más fácil de obtener predicciones para valores no observados es definir una variable compartida (<code>x_shared</code> en el ejemplo) y luego actualizar el valor de la variable compartida justo antes del muestreo de la distribución predictiva <em>a posteriori</em>.</p>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1"></a><span class="cf">with</span> model_vv:</span>
<span id="cb43-2"><a href="#cb43-2"></a>    pm.set_data({<span class="st">"x_shared"</span>: [<span class="fl">0.5</span>]})</span>
<span id="cb43-3"><a href="#cb43-3"></a>    ppc <span class="op">=</span> pm.sample_posterior_predictive(idata_vv)</span>
<span id="cb43-4"><a href="#cb43-4"></a>    y_ppc <span class="op">=</span> ppc.posterior_predictive[<span class="st">'y_pred'</span>].stack(sample<span class="op">=</span>(<span class="st">"chain"</span>, <span class="st">"draw"</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Sampling: [y_pred]</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="4000" class="" max="4000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [4000/4000 00:00&lt;00:00]
    </div>
    
</div>
</div>
<p>Ahora podemos graficar la distribución esperada de las longitudes para las bebas con 2 semanas de vida y calcular cantidades adicionales, por ejemplo, el percentil de una niña de esa longitud:</p>
<div class="cell" data-scrolled="true" data-execution_count="30">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1"></a>ref <span class="op">=</span> <span class="fl">52.5</span></span>
<span id="cb45-2"><a href="#cb45-2"></a>grid, pdf <span class="op">=</span> az.stats.density_utils._kde_linear(y_ppc.values)</span>
<span id="cb45-3"><a href="#cb45-3"></a>plt.plot(grid, pdf)</span>
<span id="cb45-4"><a href="#cb45-4"></a>percentile <span class="op">=</span> <span class="bu">int</span>((y_ppc <span class="op">&lt;=</span> ref).mean() <span class="op">*</span> <span class="dv">100</span>)</span>
<span id="cb45-5"><a href="#cb45-5"></a>plt.fill_between(grid[grid <span class="op">&lt;</span> ref], pdf[grid <span class="op">&lt;</span> ref], label<span class="op">=</span><span class="st">'percentil = </span><span class="sc">{:2d}</span><span class="st">'</span>.<span class="bu">format</span>(percentile))</span>
<span id="cb45-6"><a href="#cb45-6"></a>plt.xlabel(<span class="st">'longitud'</span>)</span>
<span id="cb45-7"><a href="#cb45-7"></a>plt.yticks([])</span>
<span id="cb45-8"><a href="#cb45-8"></a>plt.legend()<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="05_Regresión_lineal_files/figure-html/cell-31-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="regresión-lineal-jerárquica" class="level2" data-number="6.11">
<h2 data-number="6.11" class="anchored" data-anchor-id="regresión-lineal-jerárquica"><span class="header-section-number">6.11</span> Regresión lineal jerárquica</h2>
<p>Hace dos capítulos, aprendimos los rudimentos de los modelos jerárquicos. Este mismo concepto se puede aplicar a las regresiones lineales. Esto permite que los modelos realicen inferencias a nivel de subgrupo y a nivel global. Como ya vimos, esto se hace incluyendo hiperpriors.</p>
<p>Vamos a crear ocho grupos de datos relacionados, incluido un grupo con un solo dato</p>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1"></a>N <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb46-2"><a href="#cb46-2"></a>M <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb46-3"><a href="#cb46-3"></a>idx <span class="op">=</span> np.repeat(<span class="bu">range</span>(M<span class="op">-</span><span class="dv">1</span>), N)</span>
<span id="cb46-4"><a href="#cb46-4"></a>idx <span class="op">=</span> np.append(idx, <span class="dv">7</span>)</span>
<span id="cb46-5"><a href="#cb46-5"></a>np.random.seed(<span class="dv">314</span>)</span>
<span id="cb46-6"><a href="#cb46-6"></a></span>
<span id="cb46-7"><a href="#cb46-7"></a>alfa_real <span class="op">=</span> np.random.normal(<span class="fl">2.5</span>, <span class="fl">0.5</span>, size<span class="op">=</span>M)</span>
<span id="cb46-8"><a href="#cb46-8"></a>beta_real <span class="op">=</span> np.random.beta(<span class="dv">6</span>, <span class="dv">1</span>, size<span class="op">=</span>M)</span>
<span id="cb46-9"><a href="#cb46-9"></a>eps_real <span class="op">=</span> np.random.normal(<span class="dv">0</span>, <span class="fl">0.5</span>, size<span class="op">=</span><span class="bu">len</span>(idx))</span>
<span id="cb46-10"><a href="#cb46-10"></a></span>
<span id="cb46-11"><a href="#cb46-11"></a>y_m <span class="op">=</span> np.zeros(<span class="bu">len</span>(idx))</span>
<span id="cb46-12"><a href="#cb46-12"></a>x_m <span class="op">=</span> np.random.normal(<span class="dv">10</span>, <span class="dv">1</span>, <span class="bu">len</span>(idx))</span>
<span id="cb46-13"><a href="#cb46-13"></a>y_m <span class="op">=</span> alfa_real[idx] <span class="op">+</span> beta_real[idx] <span class="op">*</span> x_m  <span class="op">+</span> eps_real</span>
<span id="cb46-14"><a href="#cb46-14"></a></span>
<span id="cb46-15"><a href="#cb46-15"></a>_, ax <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">4</span>, figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">5</span>), sharex<span class="op">=</span><span class="va">True</span>, sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb46-16"><a href="#cb46-16"></a>ax <span class="op">=</span> np.ravel(ax)</span>
<span id="cb46-17"><a href="#cb46-17"></a>j, k <span class="op">=</span> <span class="dv">0</span>, N</span>
<span id="cb46-18"><a href="#cb46-18"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(M):</span>
<span id="cb46-19"><a href="#cb46-19"></a>    ax[i].scatter(x_m[j:k], y_m[j:k])</span>
<span id="cb46-20"><a href="#cb46-20"></a>    ax[i].set_xlabel(<span class="st">'$x_</span><span class="sc">{}</span><span class="st">$'</span>.<span class="bu">format</span>(i))</span>
<span id="cb46-21"><a href="#cb46-21"></a>    ax[i].set_ylabel(<span class="st">'$y_</span><span class="sc">{}</span><span class="st">$'</span>.<span class="bu">format</span>(i), rotation<span class="op">=</span><span class="dv">0</span>, labelpad<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb46-22"><a href="#cb46-22"></a>    ax[i].set_xlim(<span class="dv">6</span>, <span class="dv">15</span>)</span>
<span id="cb46-23"><a href="#cb46-23"></a>    ax[i].set_ylim(<span class="dv">7</span>, <span class="dv">17</span>)</span>
<span id="cb46-24"><a href="#cb46-24"></a>    j <span class="op">+=</span> N</span>
<span id="cb46-25"><a href="#cb46-25"></a>    k <span class="op">+=</span> N</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="05_Regresión_lineal_files/figure-html/cell-32-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Vamos a centrar los datos antes de pasárselos al modelo.</p>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1"></a>x_centered <span class="op">=</span> x_m <span class="op">-</span> x_m.mean()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1"></a><span class="cf">with</span> pm.Model() <span class="im">as</span> hierarchical_model:</span>
<span id="cb48-2"><a href="#cb48-2"></a>    <span class="co"># hyper-priors</span></span>
<span id="cb48-3"><a href="#cb48-3"></a>    α_μ <span class="op">=</span> pm.Normal(<span class="st">'α_μ'</span>, mu<span class="op">=</span><span class="dv">0</span>, sigma<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb48-4"><a href="#cb48-4"></a>    α_σ <span class="op">=</span> pm.HalfNormal(<span class="st">'α_σ'</span>, <span class="dv">1</span>)</span>
<span id="cb48-5"><a href="#cb48-5"></a>    β_μ <span class="op">=</span> pm.Normal(<span class="st">'β_μ'</span>, mu<span class="op">=</span><span class="dv">0</span>, sigma<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb48-6"><a href="#cb48-6"></a>    β_σ <span class="op">=</span> pm.HalfNormal(<span class="st">'β_σ'</span>, sigma<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb48-7"><a href="#cb48-7"></a></span>
<span id="cb48-8"><a href="#cb48-8"></a>    <span class="co"># priors</span></span>
<span id="cb48-9"><a href="#cb48-9"></a>    α_tmp <span class="op">=</span> pm.Normal(<span class="st">'α_tmp'</span>, mu<span class="op">=</span>α_μ, sigma<span class="op">=</span>α_σ, shape<span class="op">=</span>M)</span>
<span id="cb48-10"><a href="#cb48-10"></a>    β <span class="op">=</span> pm.Normal(<span class="st">'β'</span>, mu<span class="op">=</span>β_μ, sigma<span class="op">=</span>β_σ, shape<span class="op">=</span>M)</span>
<span id="cb48-11"><a href="#cb48-11"></a>    σ <span class="op">=</span> pm.HalfNormal(<span class="st">'σ'</span>, <span class="dv">1</span>)</span>
<span id="cb48-12"><a href="#cb48-12"></a></span>
<span id="cb48-13"><a href="#cb48-13"></a>    y_pred <span class="op">=</span> pm.Normal(<span class="st">'y_pred'</span>, mu<span class="op">=</span>α_tmp[idx] <span class="op">+</span> β[idx] <span class="op">*</span> x_centered, sigma<span class="op">=</span>σ, observed<span class="op">=</span>y_m)</span>
<span id="cb48-14"><a href="#cb48-14"></a></span>
<span id="cb48-15"><a href="#cb48-15"></a>    α <span class="op">=</span> pm.Deterministic(<span class="st">'α'</span>, α_tmp <span class="op">-</span> β <span class="op">*</span> x_m.mean()) </span>
<span id="cb48-16"><a href="#cb48-16"></a></span>
<span id="cb48-17"><a href="#cb48-17"></a>    idata_hm <span class="op">=</span> pm.sample(target_accept<span class="op">=</span><span class="fl">0.99</span>, random_seed<span class="op">=</span><span class="dv">123</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [α_μ, α_σ, β_μ, β_σ, α_tmp, β, σ]</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="8000" class="" max="8000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [8000/8000 00:47&lt;00:00 Sampling 4 chains, 22 divergences]
    </div>
    
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 48 seconds.
There were 22 divergences after tuning. Increase `target_accept` or reparameterize.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1"></a>az.plot_forest(idata_hm, var_names<span class="op">=</span>[<span class="st">'α'</span>, <span class="st">'β'</span>], figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">4</span>), combined<span class="op">=</span><span class="va">True</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="05_Regresión_lineal_files/figure-html/cell-35-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Dibujemos las líneas ajustadas, para cada uno de los ocho grupos.</p>
<div class="cell" data-scrolled="true" data-execution_count="40">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1"></a>_, ax <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">4</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">4</span>), sharex<span class="op">=</span><span class="va">True</span>, sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb52-2"><a href="#cb52-2"></a>ax <span class="op">=</span> np.ravel(ax)</span>
<span id="cb52-3"><a href="#cb52-3"></a>j, k <span class="op">=</span> <span class="dv">0</span>, N</span>
<span id="cb52-4"><a href="#cb52-4"></a>x_range <span class="op">=</span> np.linspace(x_m.<span class="bu">min</span>(), x_m.<span class="bu">max</span>(), <span class="dv">10</span>)</span>
<span id="cb52-5"><a href="#cb52-5"></a>posterior <span class="op">=</span> az.extract(idata_hm)</span>
<span id="cb52-6"><a href="#cb52-6"></a></span>
<span id="cb52-7"><a href="#cb52-7"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(M):</span>
<span id="cb52-8"><a href="#cb52-8"></a>    ax[i].scatter(x_m[j:k], y_m[j:k])</span>
<span id="cb52-9"><a href="#cb52-9"></a>    ax[i].set_xlabel(<span class="st">'$x_</span><span class="sc">{}</span><span class="st">$'</span>.<span class="bu">format</span>(i))</span>
<span id="cb52-10"><a href="#cb52-10"></a>    ax[i].set_ylabel(<span class="st">'$y_</span><span class="sc">{}</span><span class="st">$'</span>.<span class="bu">format</span>(i), labelpad<span class="op">=</span><span class="dv">10</span>, rotation<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb52-11"><a href="#cb52-11"></a>    alfas <span class="op">=</span> posterior[<span class="st">'α'</span>].sel(α_dim_0<span class="op">=</span>i)</span>
<span id="cb52-12"><a href="#cb52-12"></a>    betas <span class="op">=</span> posterior[<span class="st">'β'</span>].sel(β_dim_0<span class="op">=</span>i)</span>
<span id="cb52-13"><a href="#cb52-13"></a>    alfa_m <span class="op">=</span> alfas.mean(<span class="st">"sample"</span>).item()</span>
<span id="cb52-14"><a href="#cb52-14"></a>    beta_m <span class="op">=</span> betas.mean(<span class="st">"sample"</span>).item()</span>
<span id="cb52-15"><a href="#cb52-15"></a>    ax[i].plot(x_range, alfa_m <span class="op">+</span> beta_m <span class="op">*</span> x_range, c<span class="op">=</span><span class="st">'k'</span>)</span>
<span id="cb52-16"><a href="#cb52-16"></a>    az.plot_hdi(x_range, alfas <span class="op">+</span> betas <span class="op">*</span> xr.DataArray(x_range).transpose(), ax<span class="op">=</span>ax[i])</span>
<span id="cb52-17"><a href="#cb52-17"></a>    plt.xlim(x_m.<span class="bu">min</span>()<span class="op">-</span><span class="dv">1</span>, x_m.<span class="bu">max</span>()<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb52-18"><a href="#cb52-18"></a>    plt.ylim(y_m.<span class="bu">min</span>()<span class="op">-</span><span class="dv">1</span>, y_m.<span class="bu">max</span>()<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb52-19"><a href="#cb52-19"></a>    j <span class="op">+=</span> N</span>
<span id="cb52-20"><a href="#cb52-20"></a>    k <span class="op">+=</span> N</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="05_Regresión_lineal_files/figure-html/cell-36-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="ejercicios" class="level2" data-number="6.12">
<h2 data-number="6.12" class="anchored" data-anchor-id="ejercicios"><span class="header-section-number">6.12</span> Ejercicios</h2>
<ol type="1">
<li>En la siguiente definición de modelo probabilístico cual es el <em>likelihood</em>, cual es el <em>a priori</em> y cual el <em>a posteriori</em>.</li>
</ol>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\sim Normal(\mu, \sigma) \\
\mu &amp;\sim Normal(0, 10) \\
\sigma &amp;\sim HalfNormal(25)
\end{aligned}
\]</span></p>
<ol start="2" type="1">
<li><p>En el modelo del punto 1 ¿cuántos parámetros hay en el posterior? o expresado de otra forma ¿cuántas dimensiones tiene el <em>a posteriori</em>?</p></li>
<li><p>En el siguiente modelo ¿cuál es el modelo lineal? ¿cuál el likelihood y cuantos parámetros hay en la distribución a posteriori?</p></li>
</ol>
<p><span class="math display">\[
\begin{aligned}
y &amp;\sim Normal(\mu, \epsilon) \\
\mu &amp;= \alpha + \beta x \\
\alpha &amp;\sim Normal(0, 10) \\
\beta &amp;\sim Normal(0, 1) \\
\epsilon &amp;\sim HalfNormal(25) \\
\end{aligned}
\]</span></p>
<ol start="4" type="1">
<li><p>Usando el conjunto de datos <code>howell</code> (disponible junto con esta notebook) realice un modelo lineal del peso (<span class="math inline">\(x\)</span>) versus la altura (<span class="math inline">\(y\)</span>). Excluya a los menores de 18 años. Exponga los resultados.</p></li>
<li><p>Para 4 individuos se registraron los pesos (45.73, 65.8, 54.2, 32.59), pero no las alturas. Usando el modelo del punto anterior prediga la altura esperada para cada individuo junto con un intervalo de credibilidad del 50% y del 89%.</p></li>
<li><p>Repita el punto 4 pero para los menores de 18 años. Exponga los resultados.</p></li>
<li><p>Use el modelo <code>modelo_bl</code> pero aplicada al conjunto de datos iris. Intente clasificar setosa o versicolor en función de <code>sepal_length</code>. ¿Cuán útil es este modelo comparado con una regresión logística?</p></li>
<li><p>Vuelva a correr el <code>modelo_rl</code> pero esta vez usando la variable <code>petal_width</code> ¿En que difieren los resultados? ¿Cuán ancho o angosto es el intervalo HDI 94%?</p></li>
<li><p>Lea este <a href="https://twiecki.github.io/blog/2017/02/08/bayesian-hierchical-non-centered/">post</a> y replique los resultados usted mismo.</p></li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./04_Diagnóstico_MCMC.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Diagnóstico del muestreo</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./06_Generalizando_modelos_lineales.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Regresión polinomial</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center"><a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Licencia Creative Commons" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png"></a><br>Este obra está bajo <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">licencia Creative Commons Reconocimiento 4.0 Internacional</a>.</div>
  </div>
</footer>



</body></html>