<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Modelado Bayesiano - 7&nbsp; Regresión lineal con Bambi</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./07_Comparación_de_modelos.html" rel="next">
<link href="./05_Regresión_lineal.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="citation_title" content="[7]{.chapter-number}&nbsp; [Regresión lineal con Bambi]{.chapter-title}">
<meta name="citation_publication_date" content="2023-04-21">
<meta name="citation_cover_date" content="2023-04-21">
<meta name="citation_year" content="2023">
<meta name="citation_doi" content="https://doi.org/10.5281/zenodo.7851296">
<meta name="citation_language" content="es">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Regresión lineal con Bambi</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Modelado Bayesiano</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="" title="github" id="sidebar-tool-dropdown-0" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-github"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-0">
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/Grupo-de-modelado-probabilista/Modelado_Bayesiano">
          Fuente
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/Grupo-de-modelado-probabilista/Modelado_Bayesiano/issues/new">
          Reportar errores
          </a>
        </li>
    </ul>
    <a href="https://cafecito.app/aloctavodia" title="donaciones" class="sidebar-tool px-1"><i class="bi bi-cup"></i></a>
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle sidebar-tool" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">‎</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00_Probabilidad.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Probabilidad</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_Inferencia_Bayesiana.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Inferencia Bayesiana</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_Programación_probabilística.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Programación probabilista</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_Modelos_jerárquicos.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Modelado Jerárquico</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_Diagnóstico_MCMC.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Diagnóstico del muestreo</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_Regresión_lineal.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Regresión lineal</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_Regresión_lineal_con_Bambi.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Regresión lineal con Bambi</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_Comparación_de_modelos.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Comparación de modelos</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#una-sintaxis-para-gobernarlos-a-todos" id="toc-una-sintaxis-para-gobernarlos-a-todos" class="nav-link active" data-scroll-target="#una-sintaxis-para-gobernarlos-a-todos"><span class="toc-section-number">7.1</span>  Una sintaxis para gobernarlos a todos</a></li>
  <li><a href="#bicicletas-bambinas" id="toc-bicicletas-bambinas" class="nav-link" data-scroll-target="#bicicletas-bambinas"><span class="toc-section-number">7.2</span>  Bicicletas bambinas</a></li>
  <li><a href="#regresión-polinomial" id="toc-regresión-polinomial" class="nav-link" data-scroll-target="#regresión-polinomial"><span class="toc-section-number">7.3</span>  Regresión polinomial</a></li>
  <li><a href="#splines" id="toc-splines" class="nav-link" data-scroll-target="#splines"><span class="toc-section-number">7.4</span>  Splines</a></li>
  <li><a href="#modelos-distribucionales" id="toc-modelos-distribucionales" class="nav-link" data-scroll-target="#modelos-distribucionales"><span class="toc-section-number">7.5</span>  Modelos distribucionales</a></li>
  <li><a href="#predictores-categóricos" id="toc-predictores-categóricos" class="nav-link" data-scroll-target="#predictores-categóricos"><span class="toc-section-number">7.6</span>  Predictores Categóricos</a>
  <ul class="collapse">
  <li><a href="#pingüinos-categóricos" id="toc-pingüinos-categóricos" class="nav-link" data-scroll-target="#pingüinos-categóricos"><span class="toc-section-number">7.6.1</span>  Pingüinos Categóricos</a></li>
  <li><a href="#relación-con-modelos-jerárquicos" id="toc-relación-con-modelos-jerárquicos" class="nav-link" data-scroll-target="#relación-con-modelos-jerárquicos"><span class="toc-section-number">7.6.2</span>  Relación con modelos jerárquicos</a></li>
  </ul></li>
  <li><a href="#interacciones" id="toc-interacciones" class="nav-link" data-scroll-target="#interacciones"><span class="toc-section-number">7.7</span>  Interacciones</a></li>
  <li><a href="#interpretando-modelos-con-bambi" id="toc-interpretando-modelos-con-bambi" class="nav-link" data-scroll-target="#interpretando-modelos-con-bambi"><span class="toc-section-number">7.8</span>  Interpretando modelos con Bambi</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Regresión lineal con Bambi</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<blockquote class="blockquote">
<p>A good tool improves the way you work. A great tool improves the way you think. -Jeff Duntemann</p>
</blockquote>
<div class="cell" data-execution_count="1">
<details>
<summary>Mostrar Código</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> arviz <span class="im">as</span> az</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="im">import</span> bambi <span class="im">as</span> bmb</span>
<span id="cb1-6"><a href="#cb1-6"></a></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="im">from</span> mpl_toolkits.mplot3d <span class="im">import</span> Axes3D</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="im">from</span> ipywidgets <span class="im">import</span> interact</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="im">import</span> ipywidgets <span class="im">as</span> ipyw</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="2">
<details>
<summary>Mostrar Código</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a>plt.style.use(<span class="st">'arviz-doc'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>En el Capítulo anterior describimos los ingredientes básicos de los modelos de regresión lineal y cómo generalizarlos para que se ajusten mejor a nuestras necesidades. En este capítulo, seguiremos aprendiendo sobre modelos lineales, pero esta vez trabajaremos con <a href="https://bambinos.github.io/bambi/">Bambi</a>, una interfaz de construcción de modelos bayesianos de alto nivel escrita sobre PyMC. Bambi está diseñado para que sea extremadamente fácil ajustar modelos lineales, incluidos los jerárquicos. Veremos que el dominio de Bambi es en realidad más completo que los simples modelos lineales. En este capítulo vamos a aprender sobre:</p>
<ul>
<li>Cómo usar Bambi para construir y ajustar modelos</li>
<li>Cómo analizar resultados con Bambi</li>
<li>Regresión polinómica y splines</li>
<li>Modelos distributivos</li>
<li>Predictores categóricos</li>
<li>Interacciones</li>
<li>Selección de variables con Kulprit</li>
</ul>
<section id="una-sintaxis-para-gobernarlos-a-todos" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="una-sintaxis-para-gobernarlos-a-todos"><span class="header-section-number">7.1</span> Una sintaxis para gobernarlos a todos</h2>
<p>PyMC tiene una sintaxis muy simple y expresiva, que nos permite construir modelos arbitrarios, esta capacidad puede ser vista como una bendición, pero también como una carga. Bambi, en cambio, se centra en modelos de regresión; esta restricción conduce a una sintaxis más focalizada y características que serían difíciles de implementar en paquetes más generales.</p>
<p>Bambi utiliza una sintaxis de fórmula de Wilkinson similar a la utilizada por muchos paquetes de R como nlme, lme4 o brms. Supongamos que tenemos un DataFrame como el siguiente:</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a>SIZE <span class="op">=</span> <span class="dv">117</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>datos <span class="op">=</span> pd.DataFrame(</span>
<span id="cb3-3"><a href="#cb3-3"></a>    {</span>
<span id="cb3-4"><a href="#cb3-4"></a>        <span class="st">"y"</span>: np.random.normal(size<span class="op">=</span>SIZE),</span>
<span id="cb3-5"><a href="#cb3-5"></a>        <span class="st">"x"</span>: np.random.normal(size<span class="op">=</span>SIZE),</span>
<span id="cb3-6"><a href="#cb3-6"></a>        <span class="st">"z"</span>: np.random.normal(size<span class="op">=</span>SIZE),</span>
<span id="cb3-7"><a href="#cb3-7"></a>        <span class="st">"g"</span>: [<span class="st">"Group A"</span>, <span class="st">"Group B"</span>, <span class="st">"Group C"</span>] <span class="op">*</span> <span class="dv">39</span>,</span>
<span id="cb3-8"><a href="#cb3-8"></a>    }</span>
<span id="cb3-9"><a href="#cb3-9"></a>)</span>
<span id="cb3-10"><a href="#cb3-10"></a>datos.head()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>y</th>
      <th>x</th>
      <th>z</th>
      <th>g</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.340618</td>
      <td>-0.924333</td>
      <td>0.978806</td>
      <td>Group A</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.182684</td>
      <td>0.808523</td>
      <td>-0.097891</td>
      <td>Group B</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.644645</td>
      <td>-1.146860</td>
      <td>2.366085</td>
      <td>Group C</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.363740</td>
      <td>0.812695</td>
      <td>-0.675292</td>
      <td>Group A</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.422170</td>
      <td>0.039711</td>
      <td>1.556364</td>
      <td>Group B</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Usando estos datos queremos construir un modelo lineal que prediga <code>y</code> a partir de <code>x</code>. Usando PyMC haríamos algo como:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="cf">with</span> pm.Model() <span class="im">as</span> lm:</span>
<span id="cb4-2"><a href="#cb4-2"></a>    Intercept <span class="op">=</span> pm.Normal(<span class="st">"Intercept"</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb4-3"><a href="#cb4-3"></a>    x <span class="op">=</span> pm.Normal(<span class="st">"x"</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb4-4"><a href="#cb4-4"></a>    y_sigma <span class="op">=</span> pm.HalfNormal(<span class="st">"sigma"</span>, <span class="dv">1</span>)</span>
<span id="cb4-5"><a href="#cb4-5"></a>    y_mean <span class="op">=</span> Intercept <span class="op">+</span> x <span class="op">*</span> data[<span class="st">"x"</span>]</span>
<span id="cb4-6"><a href="#cb4-6"></a>    y <span class="op">=</span> pm.Normal(<span class="st">"y"</span>, y_mean, y_sigma, observed<span class="op">=</span>data[<span class="st">"y"</span>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Usando la sintaxis de Bambi, podemos escribir el mismo modelo como:</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a>un_modelo <span class="op">=</span> bmb.Model(<span class="st">"y ~ x"</span>, datos)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>En el lado izquierdo de <code>~</code> tenemos la variable dependiente y en el lado derecho la(s) variable(s) independiente(s). Con esta sintaxis, solo estamos especificando la media (<span class="math inline">\(\mu\)</span> en el modelo <code>lm</code> de PyMC). De forma predeterminada, Bambi asume que el likelihood es una Normal. Esto se puede cambiar con el argumento <code>family</code>. Esta sintáxis solo especifica cómo se relacionan las variables dependientes e independiente, pero no especifica las distribuciones <em>a priori</em>. Bambi internamente define distribuciones a priori debilmente informativas. Al imprimir un modelo de Bambi obtenemos mucha información útil sobre su especificación.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a>un_modelo</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>       Formula: y ~ x
        Family: gaussian
          Link: mu = identity
  Observations: 117
        Priors: 
    target = mu
        Common-level effects
            Intercept ~ Normal(mu: -0.0118, sigma: 2.6716)
            x ~ Normal(mu: 0.0, sigma: 2.9293)
        
        Auxiliary parameters
            sigma ~ HalfStudentT(nu: 4.0, sigma: 1.0625)</code></pre>
</div>
</div>
<p>La primera línea muestra la fórmula que usamos para definir el modelo y la segunda línea es el likelihood. En Bambi, usamos el argumento <code>family</code> para especificar el . La tercera línea es la función de enlace. Por defecto cada familia tiene asociada una función de enlace, por ej la Gaussiana se asocia a la función identidad. Luego tenemos el número de observaciones utilizadas para ajustar el modelo, y lo siguiente nos dice que estamos modelando linealmente el parámetro <span class="math inline">\(\mu\)</span> de la Gaussiana. Luego, en las siguientes líneas tenemos la estructura del modelo. La primera parte muestra los efectos de nivel común, en este caso, el intercepto y el coefficiente de regressión (la “pendiente”) asociado a <code>x</code>. En la segunda parte se muestran los parámetros auxiliares, es decir, todos los parámetros no modelados linealmente, en este caso, la desviación estándar.</p>
<p>Si querés omitir el intercepto, tenés dos opciones:</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a>no_intercepto_1 <span class="op">=</span> bmb.Model(<span class="st">"y ~ 0 + x"</span>, datos)</span>
<span id="cb8-2"><a href="#cb8-2"></a>no_intercepto_1</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>       Formula: y ~ 0 + x
        Family: gaussian
          Link: mu = identity
  Observations: 117
        Priors: 
    target = mu
        Common-level effects
            x ~ Normal(mu: 0.0, sigma: 2.9293)
        
        Auxiliary parameters
            sigma ~ HalfStudentT(nu: 4.0, sigma: 1.0625)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a>no_intercepto_2 <span class="op">=</span> bmb.Model(<span class="st">"y ~ -1 + x"</span>, datos)</span>
<span id="cb10-2"><a href="#cb10-2"></a>no_intercepto_2</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>       Formula: y ~ -1 + x
        Family: gaussian
          Link: mu = identity
  Observations: 117
        Priors: 
    target = mu
        Common-level effects
            x ~ Normal(mu: 0.0, sigma: 2.9293)
        
        Auxiliary parameters
            sigma ~ HalfStudentT(nu: 4.0, sigma: 1.0625)</code></pre>
</div>
</div>
<p>Con Bambi también podemos incluir efectos a nivel de grupo (es decir jerarquías), por ejemplo, si queremos usar la variable <code>g</code> para agrupar parcialmente las estimaciones de <code>x</code> podemos hacerlo así:</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a>modelo_h <span class="op">=</span> bmb.Model(<span class="st">"y ~ x + z + (x | g)"</span>, datos)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para obtener una representación gráfica de la estructura de un modelo de Bambi podemos usar el método <code>.graph()</code>, esto requiere que previamente hayamos usado el método <code>.build()</code> para construir el modelo. O el método <code>.fit()</code> para ajustar el modelo (calcular la distribución posterior de los parámetros). Veamos como lucen <code>un_modelo</code> y <code>modelo_h</code>:</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a>un_modelo.build()</span>
<span id="cb13-2"><a href="#cb13-2"></a>un_modelo.graph()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<p><img src="06_Regresión_lineal_con_Bambi_files/figure-html/cell-10-output-1.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a>modelo_h.build()</span>
<span id="cb14-2"><a href="#cb14-2"></a>modelo_h.graph()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<p><img src="06_Regresión_lineal_con_Bambi_files/figure-html/cell-11-output-1.svg" class="img-fluid"></p>
</div>
</div>
<p>La sintaxis de la fórmula es muy simple, pero también muy poderosa. Acabamos de arañar la superficie de lo que podemos hacer con él. En lugar de describir la sintaxis de una vez, la mostraremos mediante ejemplos. Así que comencemos ajustando el modelo de bicicleta del capítulo anterior.</p>
</section>
<section id="bicicletas-bambinas" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="bicicletas-bambinas"><span class="header-section-number">7.2</span> Bicicletas bambinas</h2>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a>bicis <span class="op">=</span> pd.read_csv(<span class="st">"datos/bicis.csv"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a>modelo_t <span class="op">=</span> bmb.Model(<span class="st">"alquiladas ~ temperatura"</span>, bicis, family<span class="op">=</span><span class="st">"negativebinomial"</span>)</span>
<span id="cb16-2"><a href="#cb16-2"></a>idata_t <span class="op">=</span> modelo_t.fit()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [alquiladas_alpha, Intercept, temperatura]</code></pre>
</div>
<div class="cell-output cell-output-display">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      <progress value="8000" class="" max="8000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [8000/8000 00:02&lt;00:00 Sampling 4 chains, 0 divergences]
    </div>
    
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 2 seconds.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a>modelo_t.graph()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<p><img src="06_Regresión_lineal_con_Bambi_files/figure-html/cell-14-output-1.svg" class="img-fluid"></p>
</div>
</div>
<p>Ahora vamos a graficar el ajuste medio a posteriori y las predicciones. Para ello usaremos la función <code>plot_predictions</code> del módulo <code>interpret</code>.</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a>_, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, sharey<span class="op">=</span><span class="va">True</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">4</span>)) </span>
<span id="cb20-2"><a href="#cb20-2"></a>bmb.interpret.plot_predictions(modelo_t, idata_t, <span class="st">"temperatura"</span>, ax<span class="op">=</span>axes[<span class="dv">0</span>])</span>
<span id="cb20-3"><a href="#cb20-3"></a>bmb.interpret.plot_predictions(modelo_t, idata_t, <span class="st">"temperatura"</span>, pps<span class="op">=</span><span class="va">True</span>, ax<span class="op">=</span>axes[<span class="dv">1</span>])</span>
<span id="cb20-4"><a href="#cb20-4"></a></span>
<span id="cb20-5"><a href="#cb20-5"></a>axes[<span class="dv">0</span>].plot(bicis.temperatura, bicis.alquiladas, <span class="st">"."</span>, color<span class="op">=</span><span class="st">"0.5"</span>,  zorder<span class="op">=-</span><span class="dv">3</span>)</span>
<span id="cb20-6"><a href="#cb20-6"></a>axes[<span class="dv">1</span>].plot(bicis.temperatura, bicis.alquiladas, <span class="st">"."</span>, color<span class="op">=</span><span class="st">"0.5"</span>, zorder<span class="op">=-</span><span class="dv">3</span>)</span>
<span id="cb20-7"><a href="#cb20-7"></a>axes[<span class="dv">0</span>].set_title(<span class="st">"media"</span>)</span>
<span id="cb20-8"><a href="#cb20-8"></a>axes[<span class="dv">1</span>].set_title(<span class="st">"predicciones"</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="06_Regresión_lineal_con_Bambi_files/figure-html/cell-15-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Probemos ahora ajustar un modelo de regresión con dos variables predictoras, <code>temperatura</code> y <code>humedad</code>.</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1"></a>modelo_th <span class="op">=</span> bmb.Model(<span class="st">"alquiladas ~ temperatura + humedad"</span>, bicis, </span>
<span id="cb21-2"><a href="#cb21-2"></a>                     family<span class="op">=</span><span class="st">"negativebinomial"</span>)</span>
<span id="cb21-3"><a href="#cb21-3"></a>                     </span>
<span id="cb21-4"><a href="#cb21-4"></a>idata_th <span class="op">=</span> modelo_th.fit()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [alquiladas_alpha, Intercept, temperatura, humedad]</code></pre>
</div>
<div class="cell-output cell-output-display">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      <progress value="8000" class="" max="8000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [8000/8000 00:02&lt;00:00 Sampling 4 chains, 0 divergences]
    </div>
    
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 3 seconds.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a>bmb.interpret.plot_predictions(modelo_th, idata_th, [<span class="st">"temperatura"</span>, <span class="st">"humedad"</span>],</span>
<span id="cb24-2"><a href="#cb24-2"></a>                               subplot_kwargs<span class="op">=</span>{<span class="st">"group"</span>:<span class="va">None</span>, <span class="st">"panel"</span>:<span class="st">"humedad"</span>},</span>
<span id="cb24-3"><a href="#cb24-3"></a>                               legend<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb24-4"><a href="#cb24-4"></a>                               fig_kwargs<span class="op">=</span>{<span class="st">"sharey"</span>:<span class="va">True</span>, <span class="st">"sharex"</span>:<span class="va">True</span>})<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="06_Regresión_lineal_con_Bambi_files/figure-html/cell-17-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>En la figura anterior podemos ver que la temperatura tiene un efecto positivo en el número de bicicletas alquiladas, mientras que la humedad tiene un efecto negativo. También podemos ver que el efecto de la temperatura es más fuerte que el de la humedad.</p>
</section>
<section id="regresión-polinomial" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="regresión-polinomial"><span class="header-section-number">7.3</span> Regresión polinomial</h2>
<p>Una forma de ajustar curvas usando un modelo de regresión lineal es construyendo un polinomio, como este:</p>
<p><span class="math display">\[
   \mu = \beta_0 + \beta_1 x + \beta_2 x^2 + \beta_3 x^3 + \beta_4 x^4 \dots \beta_m x^m
\]</span></p>
<p>donde <span class="math inline">\(m\)</span> es el grado del polinomio.</p>
<p>Hay dos cosas importantes a tener en cuenta. Primero, la regresión polinómica sigue siendo una regresión lineal; la linealidad se refiere a los coeficientes (los <span class="math inline">\(\beta\)</span>s), no a las variables (los <span class="math inline">\(x\)</span>s). La segunda es que simplemente estamos creando nuevas variables de la nada. La única variable observada es , el resto son sólo potencias de . Crear nuevas variables a partir de las observadas es un “truco” perfectamente válido al hacer regresión, a veces la transformación puede estar motivada o justificada por la teoría (como sacar la raíz cuadrada de la longitud de los bebés), pero a veces es solo una forma de ajustar una curva. La intuición con los polinomios es que para un valor dado de , cuanto mayor sea el grado del polinomio, más flexible será el ajuste. Un polinomio de grado 1 es una línea, un polinomio de grado 2 es una curva que puede subir o bajar, un polinomio de grado 3 es una curva que puede subir y luego bajar (o al revés), y así sucesivamente. Note que dije “puede” porque si tenemos un polinomio de grado 3 como <span class="math inline">\(\beta_0 + \beta_1 x + \beta_2 x^2 + \beta_3 x^3\)</span> pero los coeficientes <span class="math inline">\(\beta_2\)</span> y <span class="math inline">\(\beta_3\)</span> son 0 (o prácticamente 0), entonces la curva será una línea.</p>
<p>Hay dos formas de definir una regresión polinómica con Bambi. Podemos escribir los polinomios <em>brutos</em>:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1"></a><span class="co">"y ~ x + I(x ** 2) + I(x ** 3) + I(x ** 4)"</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>donde usamos la función de identidad <code>I</code> para dejar claro que queremos elevar <span class="math inline">\(x\)</span> a alguna potencia. Necesitamos esto porque el operador <code>**</code> tiene un significado especial para Bambi. Si usamos esta sintaxis, le estamos diciendo a Bambi que modele la media de <span class="math inline">\(y\)</span> como <span class="math inline">\(\alpha + \beta_0 x + \beta_0 x^2 + \beta_0 x^3 + \beta_0 x^4\)</span></p>
<p>Alternativamente podemos escribir</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1"></a><span class="co">"y ~ poly(x, 4)"</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Esto también generará un polinomio de grado 4, pero los términos del polinomio serán ortogonales entre sí, lo que significa que la correlación entre los términos se reduce. Sin entrar en detalles matemáticos, esto tiene al menos dos consecuencias importantes con respecto a los polinomios <em>brutos</em>. En primer lugar, la estimación puede ser numéricamente más estable y, en segundo lugar, la interpretación de los coeficientes es diferente. En la regresión polinómica <em>estándar</em>, los coeficientes pueden ser difíciles de interpretar, ya que cambiar el valor de un coeficiente afecta a todo el polinomio. En cambio, los polinomios ortogonales permiten interpretar más claramente el efecto de cada término, ya que son independientes entre sí. Si bien la interpretación de los coeficientes es diferente, otros resultados siguen siendo los mismos. Por ejemplo, deberías obtener las mismas predicciones con ambos enfoques.</p>
<p>Construyamos un polinomio ortogonal de grado 4 para modelar los datos de la bicis. Para este ejemplo, usaremos la variable <code>hora</code>:</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1"></a>modelo_poly4 <span class="op">=</span> bmb.Model(<span class="st">"alquiladas ~ poly(hora, degree=4)"</span>, bicis,</span>
<span id="cb27-2"><a href="#cb27-2"></a>                       family<span class="op">=</span><span class="st">"negativebinomial"</span>)</span>
<span id="cb27-3"><a href="#cb27-3"></a>idata_poly4 <span class="op">=</span> modelo_poly4.fit()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [alquiladas_alpha, Intercept, poly(hora, degree=4)]</code></pre>
</div>
<div class="cell-output cell-output-display">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      <progress value="8000" class="" max="8000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [8000/8000 00:02&lt;00:00 Sampling 4 chains, 0 divergences]
    </div>
    
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 3 seconds.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1"></a>_, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, sharey<span class="op">=</span><span class="va">True</span>, sharex<span class="op">=</span><span class="st">"col"</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">3</span>)) </span>
<span id="cb30-2"><a href="#cb30-2"></a>bmb.interpret.plot_predictions(modelo_poly4, idata_poly4, <span class="st">"hora"</span>, ax<span class="op">=</span>axes[<span class="dv">0</span>])</span>
<span id="cb30-3"><a href="#cb30-3"></a>bmb.interpret.plot_predictions(modelo_poly4, idata_poly4, <span class="st">"hora"</span>, pps<span class="op">=</span><span class="va">True</span>, ax<span class="op">=</span>axes[<span class="dv">1</span>])</span>
<span id="cb30-4"><a href="#cb30-4"></a></span>
<span id="cb30-5"><a href="#cb30-5"></a><span class="cf">for</span> ax <span class="kw">in</span> axes.ravel():</span>
<span id="cb30-6"><a href="#cb30-6"></a>    ax.plot(bicis.hora, bicis.alquiladas, <span class="st">"C2."</span>, zorder<span class="op">=-</span><span class="dv">3</span>)</span>
<span id="cb30-7"><a href="#cb30-7"></a>axes[<span class="dv">0</span>].set_title(<span class="st">"media"</span>)</span>
<span id="cb30-8"><a href="#cb30-8"></a>axes[<span class="dv">1</span>].set_title(<span class="st">"predicciones"</span>)</span>
<span id="cb30-9"><a href="#cb30-9"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">""</span>)</span>
<span id="cb30-10"><a href="#cb30-10"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">""</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>Text(0, 0.5, '')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="06_Regresión_lineal_con_Bambi_files/figure-html/cell-19-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>Un problema con los polinomios es que actúan <em>globalmente</em>. Cuando aplicamos un polinomio de grado <span class="math inline">\(m\)</span> estamos diciendo que la relación entre las variables independientes y dependientes es de grado <span class="math inline">\(m\)</span> para todo el conjunto de datos. Esto puede resultar problemático cuando diferentes regiones de nuestros datos necesitan diferentes niveles de flexibilidad. Esto podría conducir, por ejemplo, a curvas demasiado flexibles. A medida que aumenta el grado, el ajuste se vuelve más sensible a la eliminación de puntos o, de manera equivalente, a la adición de datos futuros. En otras palabras, a medida que aumenta el grado, el modelo se vuelve más propenso a sobreajustarse. La regresión polinomial Bayesiana generalmente sufre menos de este “exceso” gracias al uso de priors y al cálculo de toda una distribución a posteriori y no una estimación puntual.</p>
</section>
<section id="splines" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="splines"><span class="header-section-number">7.4</span> Splines</h2>
<p>Una forma general de escribir modelos muy flexibles es aplicar funciones <span class="math inline">\(B_{m}\)</span> a <span class="math inline">\(X_{m}\)</span> y luego multiplicarlas por coeficientes <span class="math inline">\(\beta_m\)</span>:</p>
<p><span class="math display">\[
\mu = \beta_0 + \beta_1 B_{1}(X_{1}) + \beta_2 B_{2}(X_{2}) + \cdots + \beta_m B_{m}(X_{m})
\]</span></p>
<p>Somos libres de elegir las funciones <span class="math inline">\(B_{m}\)</span>, por ejemplo, podemos elegir polinomios. Una opción popular es usar B-splines, no vamos a discutir su definición, pero podemos pensar en ellos como una forma de crear curvas suaves de tal manera que obtengamos flexibilidad, como con los polinomios, pero menos propensos al sobreajuste. Los B-splines son polinomios por partes, es decir, polinomios que están restringidos a afectar solo una parte de los datos. La siguiente figura muestra 3 ejemplos de polinomios por partes de grado creciente. Las líneas verticales punteadas muestran los “nudos”, que son los puntos utilizados para restringir las regiones, la línea gris discontinua representa la función que queremos aproximar y las líneas negras son los polinomios por partes.</p>
<p><img src="img/piecewise.png" class="img-fluid"></p>
<p>La siguiente figura muestra ejemplos de splines de grado 1 y 3, los puntos en la parte inferior representan los nudos y las líneas discontinuas son los B-splines. En la parte superior tenemos todos los B-splines con igual peso, usamos una escala de grises para resaltar que tenemos muchos B-splines. En el panel inferior, cada B-splines tiene un peso diferente (los multiplicamos por coeficientes <span class="math inline">\(\beta_m\)</span>), si sumamos los B-splines ponderados obtenemos como resultado la línea negra. Esta línea negra es lo que solemos llamar “la spline”. Podemos utilizar la estadística Bayesiana para encontrar los pesos adecuados para los B-splines.</p>
<p><img src="img/splines_weighted.png" class="img-fluid"></p>
<p>Podemos usar B-splines con Bambi usando la función <code>bs</code>. Por ejemplo, ajustemos un spline de grado 3 a los datos de las bicis:</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1"></a>num_knots <span class="op">=</span> <span class="dv">6</span></span>
<span id="cb32-2"><a href="#cb32-2"></a>knots <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">23</span>, num_knots<span class="op">+</span><span class="dv">2</span>)[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb32-3"><a href="#cb32-3"></a>modelo_spline <span class="op">=</span> bmb.Model(<span class="st">"alquiladas ~ bs(hora, degree=3, knots=knots)"</span>, bicis,           </span>
<span id="cb32-4"><a href="#cb32-4"></a>                         family<span class="op">=</span><span class="st">"negativebinomial"</span>)</span>
<span id="cb32-5"><a href="#cb32-5"></a>idata_spline <span class="op">=</span> modelo_spline.fit()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [alquiladas_alpha, Intercept, bs(hora, degree=3, knots=knots)]</code></pre>
</div>
<div class="cell-output cell-output-display">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      <progress value="8000" class="" max="8000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [8000/8000 00:04&lt;00:00 Sampling 4 chains, 0 divergences]
    </div>
    
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 5 seconds.</code></pre>
</div>
</div>
<p>En la siguiente figura podemos ver que el número de bicicletas de alquiler es el más bajo a altas horas de la noche. Luego se produce un aumento, probablemente cuando la gente se despierta y va al trabajo, a la escuela u otras actividades. Tenemos un primer pico alrededor de la hora 8, luego un ligero descenso, seguido por el segundo pico alrededor de la hora 18, probablemente porque la gente regresa a casa, después del cual hay un descenso constante. Observe que la curva no es muy suave, esto se debe a que los datos están discretizados (por hora).</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1"></a>_, ax <span class="op">=</span> plt.subplots(sharey<span class="op">=</span><span class="va">True</span>, sharex<span class="op">=</span><span class="st">"col"</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>)) </span>
<span id="cb35-2"><a href="#cb35-2"></a>bmb.interpret.plot_predictions(modelo_spline, idata_spline, <span class="st">"hora"</span>, ax<span class="op">=</span>ax)</span>
<span id="cb35-3"><a href="#cb35-3"></a>ax.plot(bicis.hora, bicis.alquiladas, <span class="st">"C2."</span>, zorder<span class="op">=-</span><span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="06_Regresión_lineal_con_Bambi_files/figure-html/cell-21-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Cuando trabajamos con splines, una decisión importante es determinar el número y la ubicación de los nudos. Esto puede ser una tarea algo desalentadora ya que el número óptimo de nudos y su espaciado no son evidentes de inmediato. Una sugerencia útil para determinar las ubicaciones de los nudos es considerar colocarlos según cuantiles en lugar de hacerlo de manera uniforme. Por ejemplo <code>nudos = np.quantile(bicis.hora, np.linspace(0, 1, num_knots))</code>. Al hacerlo, colocaríamos más nudos en áreas donde tenemos una mayor cantidad de datos, y menos nudos en áreas con menos datos. Esto da como resultado una aproximación más adaptable que captura efectivamente la variabilidad en regiones con una mayor densidad de puntos de datos. Además, es posible que deseemos ajustar splines con distintos números de nudos y posiciones y luego evaluar los resultados, utilizando herramientas como LOO, como veremos en el próximo capítulo.</p>
</section>
<section id="modelos-distribucionales" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="modelos-distribucionales"><span class="header-section-number">7.5</span> Modelos distribucionales</h2>
<p>Anteriormente vimos que podemos usar modelos lineales para parámetros distintos de la media. Por ejemplo, podemos utilizar un modelo lineal para la media y un modelo lineal para la desviación estándar de una distribución Gaussiana. Estos modelos suelen denominarse modelos distribucionales. La sintaxis de Bambi para los modelos distribucionales es muy similar, sólo necesitamos agregar una línea para los parámetros auxiliares que queremos modelar. Por ejemplo, sigma para una Gaussiano o alfa para un NegativaBinomial</p>
<p>Reproduzcamos ahora un ejemplo del capítulo anterior, el ejemplo de los bebés.</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1"></a>bebes <span class="op">=</span> pd.read_csv(<span class="st">'datos/babies.csv'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1"></a>modelo_cons <span class="op">=</span> bmb.Model(<span class="st">"Longitud ~ np.sqrt(Meses)"</span>, bebes)</span>
<span id="cb37-2"><a href="#cb37-2"></a>idata_cons <span class="op">=</span> modelo_cons.fit()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [Longitud_sigma, Intercept, np.sqrt(Meses)]</code></pre>
</div>
<div class="cell-output cell-output-display">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      <progress value="8000" class="" max="8000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [8000/8000 00:01&lt;00:00 Sampling 4 chains, 0 divergences]
    </div>
    
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 2 seconds.</code></pre>
</div>
</div>
<p>En el modelo anterior sigma es constante, ahora veamos un modelo distribucional. En este modelo <code>sigma</code> es una función lineal de <code>Meses</code>.</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1"></a>formula <span class="op">=</span> bmb.Formula(</span>
<span id="cb40-2"><a href="#cb40-2"></a>    <span class="st">"Longitud ~ np.sqrt(Meses)"</span>,</span>
<span id="cb40-3"><a href="#cb40-3"></a>    <span class="st">"sigma ~ Meses"</span></span>
<span id="cb40-4"><a href="#cb40-4"></a>)</span>
<span id="cb40-5"><a href="#cb40-5"></a>modelo_dis <span class="op">=</span> bmb.Model(formula, bebes)</span>
<span id="cb40-6"><a href="#cb40-6"></a>idata_dis <span class="op">=</span> modelo_dis.fit()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [Intercept, np.sqrt(Meses), sigma_Intercept, sigma_Meses]</code></pre>
</div>
<div class="cell-output cell-output-display">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      <progress value="8000" class="" max="8000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [8000/8000 00:02&lt;00:00 Sampling 4 chains, 0 divergences]
    </div>
    
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 3 seconds.</code></pre>
</div>
</div>
<p>En la siguiente figura podemos ver los valores a posteriori de sigma para los modelos con sigma constante y variable. Podemos ver que cuando se permite que sigma varíe obtenemos valores por debajo y por encima de la estimación para un sigma constante, lo que significa que estamos subestimando y sobreestimando este parámetro cuando no permitimos que cambie.</p>
<div class="cell" data-execution_count="24">
<details>
<summary>Mostrar Código</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">4</span>))</span>
<span id="cb43-2"><a href="#cb43-2"></a><span class="im">from</span> matplotlib.lines <span class="im">import</span> Line2D</span>
<span id="cb43-3"><a href="#cb43-3"></a></span>
<span id="cb43-4"><a href="#cb43-4"></a><span class="cf">for</span> idx <span class="kw">in</span> idata_dis.posterior.coords.get(<span class="st">"Longitud_obs"</span>):</span>
<span id="cb43-5"><a href="#cb43-5"></a>    values <span class="op">=</span> idata_dis.posterior[<span class="st">"sigma"</span>].sel(Longitud_obs<span class="op">=</span>idx).to_numpy().flatten()</span>
<span id="cb43-6"><a href="#cb43-6"></a>    grid, pdf <span class="op">=</span> az.kde(values)</span>
<span id="cb43-7"><a href="#cb43-7"></a>    ax.plot(grid, pdf, lw<span class="op">=</span><span class="dv">1</span>, color<span class="op">=</span><span class="st">"C1"</span>)</span>
<span id="cb43-8"><a href="#cb43-8"></a></span>
<span id="cb43-9"><a href="#cb43-9"></a>values <span class="op">=</span> idata_cons.posterior[<span class="st">"Longitud_sigma"</span>].to_numpy().flatten()</span>
<span id="cb43-10"><a href="#cb43-10"></a>grid, pdf <span class="op">=</span> az.kde(values)</span>
<span id="cb43-11"><a href="#cb43-11"></a>ax.plot(grid, pdf, lw<span class="op">=</span><span class="dv">3</span>, color<span class="op">=</span><span class="st">"C0"</span>)</span>
<span id="cb43-12"><a href="#cb43-12"></a></span>
<span id="cb43-13"><a href="#cb43-13"></a>handles <span class="op">=</span> [</span>
<span id="cb43-14"><a href="#cb43-14"></a>    Line2D([<span class="dv">0</span>], [<span class="dv">0</span>], label<span class="op">=</span><span class="st">"sigma variable"</span>, lw<span class="op">=</span><span class="fl">1.5</span>, color<span class="op">=</span><span class="st">"k"</span>, alpha<span class="op">=</span><span class="fl">0.6</span>),</span>
<span id="cb43-15"><a href="#cb43-15"></a>    Line2D([<span class="dv">0</span>], [<span class="dv">0</span>], label<span class="op">=</span><span class="st">"sigma constante"</span>, lw<span class="op">=</span><span class="fl">1.5</span>, color<span class="op">=</span><span class="st">"C0"</span>)</span>
<span id="cb43-16"><a href="#cb43-16"></a>]</span>
<span id="cb43-17"><a href="#cb43-17"></a></span>
<span id="cb43-18"><a href="#cb43-18"></a>legend <span class="op">=</span> ax.legend(handles<span class="op">=</span>handles, loc<span class="op">=</span><span class="st">"upper right"</span>)</span>
<span id="cb43-19"><a href="#cb43-19"></a></span>
<span id="cb43-20"><a href="#cb43-20"></a>ax.<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">"Alfa a posteriori"</span>, yticks<span class="op">=</span>[])<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="06_Regresión_lineal_con_Bambi_files/figure-html/cell-25-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>La siguiente figura muestra el ajuste a posteriori para <code>model_dis</code>. Observe que el modelo puede capturar el aumento de la variabilidad a medida que los bebés crecen.</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1"></a>_, ax <span class="op">=</span> plt.subplots(sharey<span class="op">=</span><span class="va">True</span>, sharex<span class="op">=</span><span class="st">"col"</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>)) </span>
<span id="cb44-2"><a href="#cb44-2"></a>bmb.interpret.plot_predictions(modelo_dis, idata_dis, <span class="st">"Meses"</span>, ax<span class="op">=</span>ax, fig_kwargs<span class="op">=</span>{<span class="st">"color"</span>:<span class="st">"k"</span>})</span>
<span id="cb44-3"><a href="#cb44-3"></a>bmb.interpret.plot_predictions(modelo_dis, idata_dis, <span class="st">"Meses"</span>, pps<span class="op">=</span><span class="va">True</span>, ax<span class="op">=</span>ax)</span>
<span id="cb44-4"><a href="#cb44-4"></a>ax_ <span class="op">=</span> bmb.interpret.plot_predictions(modelo_dis, idata_dis, <span class="st">"Meses"</span>, pps<span class="op">=</span><span class="va">True</span>, ax<span class="op">=</span>ax, prob<span class="op">=</span><span class="fl">0.65</span>)</span>
<span id="cb44-5"><a href="#cb44-5"></a>ax_[<span class="dv">1</span>][<span class="dv">0</span>].get_children()[<span class="dv">5</span>].set_facecolor(<span class="st">'C1'</span>)  </span>
<span id="cb44-6"><a href="#cb44-6"></a></span>
<span id="cb44-7"><a href="#cb44-7"></a>ax.plot(bebes.Meses, bebes.Longitud, <span class="st">"C2."</span>, zorder<span class="op">=-</span><span class="dv">3</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="06_Regresión_lineal_con_Bambi_files/figure-html/cell-26-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Al trabajar con PyMC vimos que el muestreo de la distribución predictiva a posteriori, evaluado en valores no observados, requiere que definamos el modelo con las “X” como <code>Mutable_data</code> y luego actualicemos el valor de la variable mutable antes de calcular la distribución predictiva posterior. Con Bambi esto no es necesario, podemos usar el método <code>predict</code> para predecir nuevos valores pasando los nuevos valores al argumento <code>data</code>. Por ejemplo, predigamos la longitud de un bebé a los 0,5 meses (15 días):</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1"></a>modelo_dis.predict(idata_dis, kind<span class="op">=</span><span class="st">"pps"</span>, data<span class="op">=</span>pd.DataFrame({<span class="st">"Meses"</span>:[<span class="fl">0.5</span>]}))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Esto agrega un grupo <code>posterior_predictive</code> a <code>idata_dis</code></p>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1"></a>idata_dis</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">


            <div>
              <div class="xr-header">
                <div class="xr-obj-type">arviz.InferenceData</div>
              </div>
              <ul class="xr-sections group-sections">
              
            <li class="xr-section-item">
                  <input id="idata_posteriorf37dd653-bbc7-4001-9763-205f1dd0ec6a" class="xr-section-summary-in" type="checkbox">
                  <label for="idata_posteriorf37dd653-bbc7-4001-9763-205f1dd0ec6a" class="xr-section-summary">posterior</label>
                  <div class="xr-section-inline-details"></div>
                  <div class="xr-section-details">
                      <ul id="xr-dataset-coord-list" class="xr-var-list">
                          <div style="padding-left:2rem;"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.Dataset&gt;
Dimensions:          (chain: 4, draw: 1000, Longitud_obs: 1)
Coordinates:
  * chain            (chain) int64 0 1 2 3
  * draw             (draw) int64 0 1 2 3 4 5 6 ... 993 994 995 996 997 998 999
  * Longitud_obs     (Longitud_obs) int64 0
Data variables:
    Intercept        (chain, draw) float64 48.1 47.7 47.61 ... 47.98 48.08 48.49
    np.sqrt(Meses)   (chain, draw) float64 7.896 8.014 8.031 ... 7.836 7.644
    sigma_Intercept  (chain, draw) float64 0.9327 0.8382 0.8875 ... 0.838 0.7618
    sigma_Meses      (chain, draw) float64 0.02985 0.03355 ... 0.03668 0.04163
    Longitud_mean    (chain, draw, Longitud_obs) float64 53.68 53.37 ... 53.89
    Longitud_sigma   (chain, draw, Longitud_obs) float64 2.579 2.351 ... 2.187
Attributes:
    created_at:                  2023-09-14T16:29:41.251737
    arviz_version:               0.16.0
    inference_library:           pymc
    inference_library_version:   5.7.2+21.gdfb05b689
    sampling_time:               2.996324062347412
    tuning_steps:                1000
    modeling_interface:          bambi
    modeling_interface_version:  0.13.0.dev</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.Dataset</div></div><ul class="xr-sections"><li class="xr-section-item"><input id="section-00673eb9-e932-41b4-9382-21afe2c1b46d" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-00673eb9-e932-41b4-9382-21afe2c1b46d" class="xr-section-summary" title="Expand/collapse section">Dimensions:</label><div class="xr-section-inline-details"><ul class="xr-dim-list"><li><span class="xr-has-index">chain</span>: 4</li><li><span class="xr-has-index">draw</span>: 1000</li><li><span class="xr-has-index">Longitud_obs</span>: 1</li></ul></div><div class="xr-section-details"></div></li><li class="xr-section-item"><input id="section-a185e94f-76c6-4e10-b44d-6c8304bdd1e2" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-a185e94f-76c6-4e10-b44d-6c8304bdd1e2" class="xr-section-summary">Coordinates: <span>(3)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">chain</span></div><div class="xr-var-dims">(chain)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3</div><input id="attrs-b7aeaf31-9440-45b9-a7ff-12f13aa30c57" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-b7aeaf31-9440-45b9-a7ff-12f13aa30c57" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-c7a6adfc-35d0-4d68-98f6-87a05248a953" class="xr-var-data-in" type="checkbox"><label for="data-c7a6adfc-35d0-4d68-98f6-87a05248a953" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([0, 1, 2, 3])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">draw</span></div><div class="xr-var-dims">(draw)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3 4 5 ... 995 996 997 998 999</div><input id="attrs-821d20bd-3df3-42f0-a94c-741c9b8c4fa5" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-821d20bd-3df3-42f0-a94c-741c9b8c4fa5" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-675fab6a-dc5a-464a-b91c-0f14baf02983" class="xr-var-data-in" type="checkbox"><label for="data-675fab6a-dc5a-464a-b91c-0f14baf02983" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([  0,   1,   2, ..., 997, 998, 999])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">Longitud_obs</span></div><div class="xr-var-dims">(Longitud_obs)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0</div><input id="attrs-b6d395a7-8170-4350-b09a-aeea5eecebd7" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-b6d395a7-8170-4350-b09a-aeea5eecebd7" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-3445111d-3992-4aff-9da5-f2bea741051a" class="xr-var-data-in" type="checkbox"><label for="data-3445111d-3992-4aff-9da5-f2bea741051a" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([0])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-e44af9bb-ee6c-4f0d-9cc9-a9584f88c585" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-e44af9bb-ee6c-4f0d-9cc9-a9584f88c585" class="xr-section-summary">Data variables: <span>(6)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span>Intercept</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">48.1 47.7 47.61 ... 48.08 48.49</div><input id="attrs-813e2d53-76df-4920-ab61-e811cce4b2b4" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-813e2d53-76df-4920-ab61-e811cce4b2b4" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-eab8f96e-8af0-42dc-b1c3-b51bdceefe94" class="xr-var-data-in" type="checkbox"><label for="data-eab8f96e-8af0-42dc-b1c3-b51bdceefe94" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[48.0976946 , 47.70280881, 47.60955516, ..., 48.23549395,
        47.97317013, 48.07588803],
       [47.76738741, 48.14291315, 47.94926477, ..., 48.12947105,
        48.0541579 , 48.0496489 ],
       [47.90291486, 48.15882181, 48.12261577, ..., 48.246717  ,
        48.20787013, 47.8729577 ],
       [47.75955308, 47.72209623, 47.62673746, ..., 47.98461767,
        48.07827713, 48.48925868]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>np.sqrt(Meses)</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">7.896 8.014 8.031 ... 7.836 7.644</div><input id="attrs-e3696475-3810-435b-9f83-f7fc38c2c0fd" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-e3696475-3810-435b-9f83-f7fc38c2c0fd" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-5cf9be03-69c1-4e33-a15c-80600773f738" class="xr-var-data-in" type="checkbox"><label for="data-5cf9be03-69c1-4e33-a15c-80600773f738" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[7.89583386, 8.01432309, 8.03076984, ..., 7.81963822, 7.92671867,
        7.83355719],
       [7.91902537, 7.88486792, 7.88025811, ..., 7.81394928, 7.83794958,
        7.85832125],
       [7.87498224, 7.84778682, 7.85100528, ..., 7.75411321, 7.78932771,
        7.85484362],
       [7.90306587, 7.98751632, 7.97710365, ..., 7.84721221, 7.83598113,
        7.64394408]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>sigma_Intercept</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.9327 0.8382 ... 0.838 0.7618</div><input id="attrs-561f1f45-8963-4fd3-a08b-a2d6adef52ea" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-561f1f45-8963-4fd3-a08b-a2d6adef52ea" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-bd5004ff-f19f-4699-9088-722c0a0dc6e2" class="xr-var-data-in" type="checkbox"><label for="data-bd5004ff-f19f-4699-9088-722c0a0dc6e2" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[0.93266456, 0.83815943, 0.88749002, ..., 0.9129943 , 0.80554918,
        0.89276354],
       [0.88555671, 0.82867431, 0.83998788, ..., 0.88694486, 0.82310571,
        0.82196833],
       [0.78198336, 0.8058963 , 0.94702075, ..., 0.78444967, 0.85405067,
        0.83137409],
       [0.93481358, 0.92608834, 0.82194613, ..., 0.80630653, 0.83797272,
        0.76180706]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>sigma_Meses</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.02985 0.03355 ... 0.03668 0.04163</div><input id="attrs-baa3b54a-982c-4677-9e96-9b7cc1c47414" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-baa3b54a-982c-4677-9e96-9b7cc1c47414" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-fa53c6df-6c1e-414c-a57f-1ecd0a96ff64" class="xr-var-data-in" type="checkbox"><label for="data-fa53c6df-6c1e-414c-a57f-1ecd0a96ff64" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[0.029846  , 0.03355063, 0.03189867, ..., 0.0293024 , 0.0375758 ,
        0.03237914],
       [0.03334772, 0.0378774 , 0.03404895, ..., 0.030617  , 0.03587258,
        0.03714898],
       [0.03663036, 0.03304752, 0.03040018, ..., 0.03816933, 0.03076698,
        0.03496975],
       [0.03010267, 0.03230506, 0.03890685, ..., 0.03905316, 0.03668246,
        0.04162665]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>Longitud_mean</span></div><div class="xr-var-dims">(chain, draw, Longitud_obs)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">53.68 53.37 53.29 ... 53.62 53.89</div><input id="attrs-1c94331f-6531-457c-b0cd-2f93074b5590" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-1c94331f-6531-457c-b0cd-2f93074b5590" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-db53493c-bba3-4f33-94c0-acd8a7669579" class="xr-var-data-in" type="checkbox"><label for="data-db53493c-bba3-4f33-94c0-acd8a7669579" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[[53.68089226],
        [53.36979101],
        [53.28816697],
        ...,
        [53.76481316],
        [53.57820665],
        [53.61504944]],

       [[53.36698394],
        [53.71835672],
        [53.52144872],
        ...,
        [53.65476757],
        [53.5964252 ],
        [53.60632115]],

       [[53.4713682 ],
        [53.70804509],
        [53.67411484],
        ...,
        [53.72970303],
        [53.71575658],
        [53.42717088]],

       [[53.34786454],
        [53.37012318],
        [53.26740155],
        ...,
        [53.53343464],
        [53.61915253],
        [53.89434337]]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>Longitud_sigma</span></div><div class="xr-var-dims">(chain, draw, Longitud_obs)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">2.579 2.351 2.468 ... 2.354 2.187</div><input id="attrs-21c21044-d4b8-4cc2-9b6c-4f731848a8e6" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-21c21044-d4b8-4cc2-9b6c-4f731848a8e6" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-9dbfebdb-8204-4fed-a770-7e2760c9f3bd" class="xr-var-data-in" type="checkbox"><label for="data-9dbfebdb-8204-4fed-a770-7e2760c9f3bd" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[[2.57947931],
        [2.35122095],
        [2.46807713],
        ...,
        [2.52854869],
        [2.28036857],
        [2.48172309]],

       [[2.46509556],
        [2.3340688 ],
        [2.35611093],
        ...,
        [2.46515174],
        [2.31878189],
        [2.31762469]],

       [[2.22620543],
        [2.27600123],
        [2.61750309],
        ...,
        [2.23342066],
        [2.38556061],
        [2.33697876]],

       [[2.5853604 ],
        [2.56572444],
        [2.31961112],
        ...,
        [2.28378262],
        [2.35446599],
        [2.18719606]]])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-fc5628e9-34c0-493b-94ad-4cef0815c3dd" class="xr-section-summary-in" type="checkbox"><label for="section-fc5628e9-34c0-493b-94ad-4cef0815c3dd" class="xr-section-summary">Indexes: <span>(3)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-index-name"><div>chain</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-33e72a02-6393-4a3b-8b5f-4b920de03174" class="xr-index-data-in" type="checkbox"><label for="index-33e72a02-6393-4a3b-8b5f-4b920de03174" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([0, 1, 2, 3], dtype='int64', name='chain'))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>draw</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-0ac7870a-2908-4838-ada8-dbee3e4d38d2" class="xr-index-data-in" type="checkbox"><label for="index-0ac7870a-2908-4838-ada8-dbee3e4d38d2" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
       ...
       990, 991, 992, 993, 994, 995, 996, 997, 998, 999],
      dtype='int64', name='draw', length=1000))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>Longitud_obs</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-090ad1bd-18e7-4dda-ba25-f0b61895434c" class="xr-index-data-in" type="checkbox"><label for="index-090ad1bd-18e7-4dda-ba25-f0b61895434c" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([0], dtype='int64', name='Longitud_obs'))</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-f7f0b04b-2681-4599-8fb1-413a9229bc05" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-f7f0b04b-2681-4599-8fb1-413a9229bc05" class="xr-section-summary">Attributes: <span>(8)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"><dt><span>created_at :</span></dt><dd>2023-09-14T16:29:41.251737</dd><dt><span>arviz_version :</span></dt><dd>0.16.0</dd><dt><span>inference_library :</span></dt><dd>pymc</dd><dt><span>inference_library_version :</span></dt><dd>5.7.2+21.gdfb05b689</dd><dt><span>sampling_time :</span></dt><dd>2.996324062347412</dd><dt><span>tuning_steps :</span></dt><dd>1000</dd><dt><span>modeling_interface :</span></dt><dd>bambi</dd><dt><span>modeling_interface_version :</span></dt><dd>0.13.0.dev</dd></dl></div></li></ul></div></div><br></div>
                      </ul>
                  </div>
            </li>
            
            <li class="xr-section-item">
                  <input id="idata_posterior_predictivee00a4bcc-937a-46ab-8607-6b1ac6f09cd8" class="xr-section-summary-in" type="checkbox">
                  <label for="idata_posterior_predictivee00a4bcc-937a-46ab-8607-6b1ac6f09cd8" class="xr-section-summary">posterior_predictive</label>
                  <div class="xr-section-inline-details"></div>
                  <div class="xr-section-details">
                      <ul id="xr-dataset-coord-list" class="xr-var-list">
                          <div style="padding-left:2rem;"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.Dataset&gt;
Dimensions:       (chain: 4, draw: 1000, Longitud_obs: 1)
Coordinates:
  * chain         (chain) int64 0 1 2 3
  * draw          (draw) int64 0 1 2 3 4 5 6 7 ... 993 994 995 996 997 998 999
  * Longitud_obs  (Longitud_obs) int64 0
Data variables:
    Longitud      (chain, draw, Longitud_obs) float64 60.32 54.36 ... 52.23
Attributes:
    modeling_interface:          bambi
    modeling_interface_version:  0.13.0.dev</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.Dataset</div></div><ul class="xr-sections"><li class="xr-section-item"><input id="section-3d316e6e-ca96-47b5-93d4-d43ef3b15370" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-3d316e6e-ca96-47b5-93d4-d43ef3b15370" class="xr-section-summary" title="Expand/collapse section">Dimensions:</label><div class="xr-section-inline-details"><ul class="xr-dim-list"><li><span class="xr-has-index">chain</span>: 4</li><li><span class="xr-has-index">draw</span>: 1000</li><li><span class="xr-has-index">Longitud_obs</span>: 1</li></ul></div><div class="xr-section-details"></div></li><li class="xr-section-item"><input id="section-850c28e0-c522-4e6a-bdf5-577dcb41153d" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-850c28e0-c522-4e6a-bdf5-577dcb41153d" class="xr-section-summary">Coordinates: <span>(3)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">chain</span></div><div class="xr-var-dims">(chain)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3</div><input id="attrs-6ff8301f-7986-48ed-956a-82c77d5a4f02" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-6ff8301f-7986-48ed-956a-82c77d5a4f02" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-80d366c2-cd7b-4080-821c-916749ac2eee" class="xr-var-data-in" type="checkbox"><label for="data-80d366c2-cd7b-4080-821c-916749ac2eee" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([0, 1, 2, 3])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">draw</span></div><div class="xr-var-dims">(draw)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3 4 5 ... 995 996 997 998 999</div><input id="attrs-9d8c8f35-0c51-4401-944f-c8a8da5d364b" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-9d8c8f35-0c51-4401-944f-c8a8da5d364b" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-1f2c5ce3-8091-47f7-b470-9a575f45e1c9" class="xr-var-data-in" type="checkbox"><label for="data-1f2c5ce3-8091-47f7-b470-9a575f45e1c9" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([  0,   1,   2, ..., 997, 998, 999])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">Longitud_obs</span></div><div class="xr-var-dims">(Longitud_obs)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0</div><input id="attrs-83d57f30-8201-4cfe-9030-1d2bdff1c47f" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-83d57f30-8201-4cfe-9030-1d2bdff1c47f" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-1f81c1d6-098d-438e-bb05-4fc20829827e" class="xr-var-data-in" type="checkbox"><label for="data-1f81c1d6-098d-438e-bb05-4fc20829827e" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([0])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-a1274e4e-3539-4843-bd0b-4c0ff8d4c88c" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-a1274e4e-3539-4843-bd0b-4c0ff8d4c88c" class="xr-section-summary">Data variables: <span>(1)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span>Longitud</span></div><div class="xr-var-dims">(chain, draw, Longitud_obs)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">60.32 54.36 50.84 ... 52.09 52.23</div><input id="attrs-60bc5cbd-21a9-4d47-9046-74a4d6386b43" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-60bc5cbd-21a9-4d47-9046-74a4d6386b43" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-14e3a422-da0f-448a-9b2d-319c2dc9d5ce" class="xr-var-data-in" type="checkbox"><label for="data-14e3a422-da0f-448a-9b2d-319c2dc9d5ce" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[[60.31842579],
        [54.36238583],
        [50.83937052],
        ...,
        [55.82424305],
        [50.16516507],
        [53.78326312]],

       [[53.66999279],
        [52.26057785],
        [52.37800986],
        ...,
        [55.23652054],
        [53.75188833],
        [54.92332463]],

       [[46.75709619],
        [54.04271576],
        [59.98268641],
        ...,
        [54.78237532],
        [49.044151  ],
        [53.75643776]],

       [[50.52694879],
        [51.33974536],
        [55.8470331 ],
        ...,
        [52.04961882],
        [52.08713637],
        [52.2296785 ]]])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-ce309280-1aaf-4e55-8e40-0fe34acf33c0" class="xr-section-summary-in" type="checkbox"><label for="section-ce309280-1aaf-4e55-8e40-0fe34acf33c0" class="xr-section-summary">Indexes: <span>(3)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-index-name"><div>chain</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-7b83bda1-bfa3-4dda-b6e8-84040b18ee98" class="xr-index-data-in" type="checkbox"><label for="index-7b83bda1-bfa3-4dda-b6e8-84040b18ee98" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([0, 1, 2, 3], dtype='int64', name='chain'))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>draw</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-64d3373f-747a-431d-8479-2c39850679b0" class="xr-index-data-in" type="checkbox"><label for="index-64d3373f-747a-431d-8479-2c39850679b0" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
       ...
       990, 991, 992, 993, 994, 995, 996, 997, 998, 999],
      dtype='int64', name='draw', length=1000))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>Longitud_obs</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-205cb119-26b4-4cd7-bddc-f941cecdb3fb" class="xr-index-data-in" type="checkbox"><label for="index-205cb119-26b4-4cd7-bddc-f941cecdb3fb" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([0], dtype='int64', name='Longitud_obs'))</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-3663159d-ce0b-4639-8e97-4068d1f458e7" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-3663159d-ce0b-4639-8e97-4068d1f458e7" class="xr-section-summary">Attributes: <span>(2)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"><dt><span>modeling_interface :</span></dt><dd>bambi</dd><dt><span>modeling_interface_version :</span></dt><dd>0.13.0.dev</dd></dl></div></li></ul></div></div><br></div>
                      </ul>
                  </div>
            </li>
            
            <li class="xr-section-item">
                  <input id="idata_sample_stats76dc66c2-9a66-488c-853b-4b299f8c190f" class="xr-section-summary-in" type="checkbox">
                  <label for="idata_sample_stats76dc66c2-9a66-488c-853b-4b299f8c190f" class="xr-section-summary">sample_stats</label>
                  <div class="xr-section-inline-details"></div>
                  <div class="xr-section-details">
                      <ul id="xr-dataset-coord-list" class="xr-var-list">
                          <div style="padding-left:2rem;"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.Dataset&gt;
Dimensions:                (chain: 4, draw: 1000)
Coordinates:
  * chain                  (chain) int64 0 1 2 3
  * draw                   (draw) int64 0 1 2 3 4 5 ... 994 995 996 997 998 999
Data variables: (12/17)
    largest_eigval         (chain, draw) float64 nan nan nan nan ... nan nan nan
    lp                     (chain, draw) float64 -2.128e+03 ... -2.13e+03
    perf_counter_start     (chain, draw) float64 1.746e+04 ... 1.746e+04
    diverging              (chain, draw) bool False False False ... False False
    reached_max_treedepth  (chain, draw) bool False False False ... False False
    step_size              (chain, draw) float64 0.7155 0.7155 ... 0.7606 0.7606
    ...                     ...
    perf_counter_diff      (chain, draw) float64 0.0005076 ... 0.0009598
    energy                 (chain, draw) float64 2.132e+03 ... 2.133e+03
    smallest_eigval        (chain, draw) float64 nan nan nan nan ... nan nan nan
    index_in_trajectory    (chain, draw) int64 3 -1 -1 -2 1 -2 ... -2 3 -3 -2 -2
    max_energy_error       (chain, draw) float64 0.7478 0.6588 ... 0.824 1.842
    n_steps                (chain, draw) float64 3.0 7.0 7.0 3.0 ... 7.0 3.0 3.0
Attributes:
    created_at:                  2023-09-14T16:29:41.260817
    arviz_version:               0.16.0
    inference_library:           pymc
    inference_library_version:   5.7.2+21.gdfb05b689
    sampling_time:               2.996324062347412
    tuning_steps:                1000
    modeling_interface:          bambi
    modeling_interface_version:  0.13.0.dev</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.Dataset</div></div><ul class="xr-sections"><li class="xr-section-item"><input id="section-052eefe6-8486-4730-bb2d-da26ff49d2da" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-052eefe6-8486-4730-bb2d-da26ff49d2da" class="xr-section-summary" title="Expand/collapse section">Dimensions:</label><div class="xr-section-inline-details"><ul class="xr-dim-list"><li><span class="xr-has-index">chain</span>: 4</li><li><span class="xr-has-index">draw</span>: 1000</li></ul></div><div class="xr-section-details"></div></li><li class="xr-section-item"><input id="section-09a851cc-7747-4bac-8618-dcbd64235dcb" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-09a851cc-7747-4bac-8618-dcbd64235dcb" class="xr-section-summary">Coordinates: <span>(2)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">chain</span></div><div class="xr-var-dims">(chain)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3</div><input id="attrs-c99a50c9-1df5-496f-8b58-6a163e21da79" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-c99a50c9-1df5-496f-8b58-6a163e21da79" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-80985344-1ffe-46f7-a9e2-77293b9ea4a8" class="xr-var-data-in" type="checkbox"><label for="data-80985344-1ffe-46f7-a9e2-77293b9ea4a8" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([0, 1, 2, 3])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">draw</span></div><div class="xr-var-dims">(draw)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3 4 5 ... 995 996 997 998 999</div><input id="attrs-52221467-0b9e-45bf-aa0e-2a7089d2daa2" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-52221467-0b9e-45bf-aa0e-2a7089d2daa2" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-e7f80a94-727a-4131-8f2f-d308fc607cc0" class="xr-var-data-in" type="checkbox"><label for="data-e7f80a94-727a-4131-8f2f-d308fc607cc0" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([  0,   1,   2, ..., 997, 998, 999])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-e195f4eb-3766-49a1-b921-822497e1c14a" class="xr-section-summary-in" type="checkbox"><label for="section-e195f4eb-3766-49a1-b921-822497e1c14a" class="xr-section-summary">Data variables: <span>(17)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span>largest_eigval</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">nan nan nan nan ... nan nan nan nan</div><input id="attrs-58f24742-a866-4d96-979b-8e90eea185b7" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-58f24742-a866-4d96-979b-8e90eea185b7" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-8476c1e6-7857-49c9-9563-ab08319ec5dc" class="xr-var-data-in" type="checkbox"><label for="data-8476c1e6-7857-49c9-9563-ab08319ec5dc" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>lp</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">-2.128e+03 -2.128e+03 ... -2.13e+03</div><input id="attrs-c42b9493-29fa-4cc5-9da5-8bb958d0721d" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-c42b9493-29fa-4cc5-9da5-8bb958d0721d" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-35ae35dc-3b57-4537-8cb2-1ab7dc4f4b2e" class="xr-var-data-in" type="checkbox"><label for="data-35ae35dc-3b57-4537-8cb2-1ab7dc4f4b2e" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[-2128.25570866, -2127.57881932, -2127.62350805, ...,
        -2127.71209198, -2127.25290259, -2126.63629243],
       [-2127.14388854, -2128.09273093, -2125.92100064, ...,
        -2126.93554605, -2125.96181814, -2126.19700874],
       [-2127.54445618, -2128.7753779 , -2129.07775167, ...,
        -2127.22699159, -2128.11422058, -2126.97153335],
       [-2128.94052778, -2129.14319042, -2129.16301545, ...,
        -2127.00323298, -2126.30029139, -2130.05518472]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>perf_counter_start</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">1.746e+04 1.746e+04 ... 1.746e+04</div><input id="attrs-c01fd5f5-9911-445f-a368-a736238a5c80" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-c01fd5f5-9911-445f-a368-a736238a5c80" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-12cc45d0-713f-4723-bd1b-c783a8176122" class="xr-var-data-in" type="checkbox"><label for="data-12cc45d0-713f-4723-bd1b-c783a8176122" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[17460.82951256, 17460.83012147, 17460.83120593, ...,
        17461.95358094, 17461.95480169, 17461.9555228 ],
       [17460.50329879, 17460.50398375, 17460.50513733, ...,
        17461.53018582, 17461.53120094, 17461.53225924],
       [17460.63297097, 17460.63410353, 17460.63475103, ...,
        17461.69115363, 17461.69248133, 17461.69343372],
       [17460.42744308, 17460.42857715, 17460.42921937, ...,
        17461.59167615, 17461.59380178, 17461.59495639]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>diverging</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">bool</div><div class="xr-var-preview xr-preview">False False False ... False False</div><input id="attrs-d00408b9-793d-47eb-9095-f8a64a65cd5d" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-d00408b9-793d-47eb-9095-f8a64a65cd5d" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-16f5fddd-3c69-4c25-b2d9-2ea30109fa32" class="xr-var-data-in" type="checkbox"><label for="data-16f5fddd-3c69-4c25-b2d9-2ea30109fa32" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>reached_max_treedepth</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">bool</div><div class="xr-var-preview xr-preview">False False False ... False False</div><input id="attrs-83b51442-b7f6-491b-a79a-0533df827fc2" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-83b51442-b7f6-491b-a79a-0533df827fc2" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-dac6b5a1-398e-4bd1-934c-8c46e6a14973" class="xr-var-data-in" type="checkbox"><label for="data-dac6b5a1-398e-4bd1-934c-8c46e6a14973" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>step_size</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.7155 0.7155 ... 0.7606 0.7606</div><input id="attrs-d917b169-c506-42af-b6ae-9a6b0df5041c" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-d917b169-c506-42af-b6ae-9a6b0df5041c" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-8b63a300-354e-4c92-9deb-82c8c2cbee5f" class="xr-var-data-in" type="checkbox"><label for="data-8b63a300-354e-4c92-9deb-82c8c2cbee5f" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[0.71549813, 0.71549813, 0.71549813, ..., 0.71549813, 0.71549813,
        0.71549813],
       [0.89005128, 0.89005128, 0.89005128, ..., 0.89005128, 0.89005128,
        0.89005128],
       [0.62430409, 0.62430409, 0.62430409, ..., 0.62430409, 0.62430409,
        0.62430409],
       [0.76061631, 0.76061631, 0.76061631, ..., 0.76061631, 0.76061631,
        0.76061631]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>process_time_diff</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.0005076 0.0009835 ... 0.0009598</div><input id="attrs-c6602415-b62d-4fe7-923b-748d559175bc" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-c6602415-b62d-4fe7-923b-748d559175bc" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-5f6bec11-1d9f-453d-93dc-154059eae956" class="xr-var-data-in" type="checkbox"><label for="data-5f6bec11-1d9f-453d-93dc-154059eae956" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[0.00050761, 0.00098347, 0.00101519, ..., 0.0011086 , 0.00060975,
        0.00108418],
       [0.00056595, 0.00104389, 0.00051709, ..., 0.00085343, 0.00087865,
        0.00184054],
       [0.0010241 , 0.00053852, 0.0010402 , ..., 0.00087177, 0.00079592,
        0.0008324 ],
       [0.00102209, 0.00052666, 0.00097879, ..., 0.00188049, 0.00097873,
        0.00095982]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>acceptance_rate</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.8245 0.7948 ... 0.7225 0.4205</div><input id="attrs-b17e3693-6edb-4a33-986f-780febbf56de" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-b17e3693-6edb-4a33-986f-780febbf56de" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-8d928fba-0f53-4d77-9284-e58ad76a231a" class="xr-var-data-in" type="checkbox"><label for="data-8d928fba-0f53-4d77-9284-e58ad76a231a" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[0.82446172, 0.79482658, 0.95712684, ..., 0.74318249, 0.83343676,
        0.89798943],
       [0.773472  , 0.91256015, 0.98067448, ..., 0.96102244, 0.95436382,
        0.90064182],
       [0.97214775, 0.88878672, 0.96726692, ..., 0.88876298, 0.51159946,
        0.94506254],
       [0.76739309, 0.98364262, 0.76666738, ..., 1.        , 0.72247453,
        0.42049806]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>energy_error</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">-0.04573 -0.2763 ... -0.1353 0.2052</div><input id="attrs-0754de76-c2a3-4d19-ad68-d0b065dcc658" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-0754de76-c2a3-4d19-ad68-d0b065dcc658" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-14768b97-07e1-47b4-80cb-d259cf6da09d" class="xr-var-data-in" type="checkbox"><label for="data-14768b97-07e1-47b4-80cb-d259cf6da09d" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[-0.045726  , -0.27626369,  0.0104746 , ...,  0.21252919,
        -0.26966393, -0.09069604],
       [ 0.1233616 ,  0.20468772, -0.51935667, ..., -0.3879112 ,
        -0.28166409,  0.07246046],
       [ 0.02403317,  0.26657733,  0.06118857, ...,  0.03222643,
         0.40980905, -0.27521988],
       [ 0.00145437, -0.1623324 ,  0.42724582, ..., -0.04948342,
        -0.13531182,  0.20515533]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>step_size_bar</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.9084 0.9084 ... 0.8368 0.8368</div><input id="attrs-3b3d1f76-3694-4a72-bf3a-ec8761d0961a" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-3b3d1f76-3694-4a72-bf3a-ec8761d0961a" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-7be87900-ee63-4c9e-a928-4b42183c8670" class="xr-var-data-in" type="checkbox"><label for="data-7be87900-ee63-4c9e-a928-4b42183c8670" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[0.90839834, 0.90839834, 0.90839834, ..., 0.90839834, 0.90839834,
        0.90839834],
       [0.89154357, 0.89154357, 0.89154357, ..., 0.89154357, 0.89154357,
        0.89154357],
       [0.87918281, 0.87918281, 0.87918281, ..., 0.87918281, 0.87918281,
        0.87918281],
       [0.83677758, 0.83677758, 0.83677758, ..., 0.83677758, 0.83677758,
        0.83677758]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>tree_depth</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">2 3 3 2 2 3 1 3 ... 2 2 3 2 2 3 2 2</div><input id="attrs-0a2a73cf-753a-4aa7-a58c-1a916a0ce81d" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-0a2a73cf-753a-4aa7-a58c-1a916a0ce81d" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-5cc228f1-b6ed-422b-9b92-8f629520a0a5" class="xr-var-data-in" type="checkbox"><label for="data-5cc228f1-b6ed-422b-9b92-8f629520a0a5" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[2, 3, 3, ..., 3, 2, 3],
       [2, 3, 2, ..., 2, 2, 3],
       [3, 2, 3, ..., 2, 2, 2],
       [3, 2, 3, ..., 3, 2, 2]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>perf_counter_diff</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.0005076 0.0009834 ... 0.0009598</div><input id="attrs-057eb793-08f5-4222-b557-763d670dffab" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-057eb793-08f5-4222-b557-763d670dffab" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-c9188b18-dc22-41c6-ae42-07c587e1bbdc" class="xr-var-data-in" type="checkbox"><label for="data-c9188b18-dc22-41c6-ae42-07c587e1bbdc" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[0.00050758, 0.00098337, 0.00101496, ..., 0.00110832, 0.00060954,
        0.00108403],
       [0.00056589, 0.00104364, 0.00051701, ..., 0.0008538 , 0.00088538,
        0.00284306],
       [0.00102382, 0.00053844, 0.00104009, ..., 0.00087193, 0.00079606,
        0.00083255],
       [0.00102195, 0.00052661, 0.00097869, ..., 0.00193997, 0.00097846,
        0.00095976]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>energy</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">2.132e+03 2.131e+03 ... 2.133e+03</div><input id="attrs-122f8333-cafd-4eba-b877-44a0152b9328" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-122f8333-cafd-4eba-b877-44a0152b9328" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-f80c6345-8364-4c3c-aeae-9972d1796c7e" class="xr-var-data-in" type="checkbox"><label for="data-f80c6345-8364-4c3c-aeae-9972d1796c7e" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[2131.6052091 , 2130.65055495, 2128.68923246, ..., 2129.50047415,
        2129.71484131, 2129.94987   ],
       [2129.21988922, 2128.98133244, 2127.89708308, ..., 2128.83503025,
        2127.19935542, 2127.14622459],
       [2128.13540069, 2130.0056683 , 2131.24912699, ..., 2128.50352376,
        2131.34974137, 2129.13119022],
       [2131.44474941, 2131.2336802 , 2132.46589045, ..., 2127.66858451,
        2128.46956159, 2132.55557316]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>smallest_eigval</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">nan nan nan nan ... nan nan nan nan</div><input id="attrs-1aa4939c-a7f8-41c7-9765-5bc007311307" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-1aa4939c-a7f8-41c7-9765-5bc007311307" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-31ef0887-079f-4dcf-a7eb-eb5d62120277" class="xr-var-data-in" type="checkbox"><label for="data-31ef0887-079f-4dcf-a7eb-eb5d62120277" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>index_in_trajectory</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">3 -1 -1 -2 1 -2 ... -2 3 -3 -2 -2</div><input id="attrs-62ff86be-5cfa-4ee1-a884-7d9b5001d46d" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-62ff86be-5cfa-4ee1-a884-7d9b5001d46d" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-d7b7b24e-864e-4f7c-a74d-82f16ed4c47b" class="xr-var-data-in" type="checkbox"><label for="data-d7b7b24e-864e-4f7c-a74d-82f16ed4c47b" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[ 3, -1, -1, ...,  2,  3, -5],
       [-3, -2, -2, ...,  2, -1,  4],
       [ 2, -1, -4, ...,  3,  2,  1],
       [ 1,  1, -1, ..., -3, -2, -2]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>max_energy_error</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.7478 0.6588 ... 0.824 1.842</div><input id="attrs-7e22bbf4-fe8b-4a92-a56d-029d9987ba4b" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-7e22bbf4-fe8b-4a92-a56d-029d9987ba4b" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-77c1cf4e-551c-4710-bf00-b8c767964d13" class="xr-var-data-in" type="checkbox"><label for="data-77c1cf4e-551c-4710-bf00-b8c767964d13" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[ 0.74784592,  0.65883131,  0.20326681, ...,  0.64797745,
         0.69252679,  0.28539185],
       [ 0.37839026,  0.37228714, -0.51935667, ..., -0.3879112 ,
        -0.28166409,  0.18092342],
       [-0.25967809,  0.26657733, -0.24796247, ...,  0.2744778 ,
         1.38282591, -0.27521988],
       [ 0.89418504, -0.30260343,  0.75322146, ..., -0.22105045,
         0.82398081,  1.84204951]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>n_steps</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">3.0 7.0 7.0 3.0 ... 3.0 7.0 3.0 3.0</div><input id="attrs-698625f6-e63c-4a06-947f-52b4dd5aee7c" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-698625f6-e63c-4a06-947f-52b4dd5aee7c" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-928529db-a71e-4d3f-94da-1bf327d39e97" class="xr-var-data-in" type="checkbox"><label for="data-928529db-a71e-4d3f-94da-1bf327d39e97" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[3., 7., 7., ..., 7., 3., 7.],
       [3., 7., 3., ..., 3., 3., 7.],
       [7., 3., 7., ..., 3., 3., 3.],
       [7., 3., 7., ..., 7., 3., 3.]])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-7617f74f-c0bf-4106-834d-553da841440a" class="xr-section-summary-in" type="checkbox"><label for="section-7617f74f-c0bf-4106-834d-553da841440a" class="xr-section-summary">Indexes: <span>(2)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-index-name"><div>chain</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-fda853eb-0330-4af1-99b3-aab5ca99c453" class="xr-index-data-in" type="checkbox"><label for="index-fda853eb-0330-4af1-99b3-aab5ca99c453" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([0, 1, 2, 3], dtype='int64', name='chain'))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>draw</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-41159869-a639-4a2d-83e4-9dc39683fccf" class="xr-index-data-in" type="checkbox"><label for="index-41159869-a639-4a2d-83e4-9dc39683fccf" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
       ...
       990, 991, 992, 993, 994, 995, 996, 997, 998, 999],
      dtype='int64', name='draw', length=1000))</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-c8356ea2-2e7f-4155-b65e-c55c9c7bdd55" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-c8356ea2-2e7f-4155-b65e-c55c9c7bdd55" class="xr-section-summary">Attributes: <span>(8)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"><dt><span>created_at :</span></dt><dd>2023-09-14T16:29:41.260817</dd><dt><span>arviz_version :</span></dt><dd>0.16.0</dd><dt><span>inference_library :</span></dt><dd>pymc</dd><dt><span>inference_library_version :</span></dt><dd>5.7.2+21.gdfb05b689</dd><dt><span>sampling_time :</span></dt><dd>2.996324062347412</dd><dt><span>tuning_steps :</span></dt><dd>1000</dd><dt><span>modeling_interface :</span></dt><dd>bambi</dd><dt><span>modeling_interface_version :</span></dt><dd>0.13.0.dev</dd></dl></div></li></ul></div></div><br></div>
                      </ul>
                  </div>
            </li>
            
            <li class="xr-section-item">
                  <input id="idata_observed_dataaa256135-16ec-4d21-945a-c2fdc3eafeb9" class="xr-section-summary-in" type="checkbox">
                  <label for="idata_observed_dataaa256135-16ec-4d21-945a-c2fdc3eafeb9" class="xr-section-summary">observed_data</label>
                  <div class="xr-section-inline-details"></div>
                  <div class="xr-section-details">
                      <ul id="xr-dataset-coord-list" class="xr-var-list">
                          <div style="padding-left:2rem;"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.Dataset&gt;
Dimensions:       (Longitud_obs: 796)
Coordinates:
  * Longitud_obs  (Longitud_obs) int64 0 1 2 3 4 5 6 ... 790 791 792 793 794 795
Data variables:
    Longitud      (Longitud_obs) float64 49.19 51.22 51.22 ... 90.93 97.35 94.19
Attributes:
    created_at:                  2023-09-14T16:29:41.264497
    arviz_version:               0.16.0
    inference_library:           pymc
    inference_library_version:   5.7.2+21.gdfb05b689
    modeling_interface:          bambi
    modeling_interface_version:  0.13.0.dev</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.Dataset</div></div><ul class="xr-sections"><li class="xr-section-item"><input id="section-26063866-1758-4d25-a621-da7f937fa1cf" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-26063866-1758-4d25-a621-da7f937fa1cf" class="xr-section-summary" title="Expand/collapse section">Dimensions:</label><div class="xr-section-inline-details"><ul class="xr-dim-list"><li><span class="xr-has-index">Longitud_obs</span>: 796</li></ul></div><div class="xr-section-details"></div></li><li class="xr-section-item"><input id="section-8d14d027-b363-420c-8514-067e4be6dba5" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-8d14d027-b363-420c-8514-067e4be6dba5" class="xr-section-summary">Coordinates: <span>(1)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">Longitud_obs</span></div><div class="xr-var-dims">(Longitud_obs)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3 4 5 ... 791 792 793 794 795</div><input id="attrs-669a2bed-5e86-4c4d-9e8b-61479de4a505" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-669a2bed-5e86-4c4d-9e8b-61479de4a505" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-f72efde0-6782-4fd8-b47f-056fcb177615" class="xr-var-data-in" type="checkbox"><label for="data-f72efde0-6782-4fd8-b47f-056fcb177615" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([  0,   1,   2, ..., 793, 794, 795])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-701c44b5-a1d7-4445-a17d-940fd167cf25" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-701c44b5-a1d7-4445-a17d-940fd167cf25" class="xr-section-summary">Data variables: <span>(1)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span>Longitud</span></div><div class="xr-var-dims">(Longitud_obs)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">49.19 51.22 51.22 ... 97.35 94.19</div><input id="attrs-2856a99a-1683-40b9-9a7d-bb0e5b782607" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-2856a99a-1683-40b9-9a7d-bb0e5b782607" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-dbc5dfbc-e26d-4c1c-b4ec-4af530b5fcac" class="xr-var-data-in" type="checkbox"><label for="data-dbc5dfbc-e26d-4c1c-b4ec-4af530b5fcac" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([49.19285714, 51.22142857, 51.22142857, 52.74285714, 48.17857143,
       49.7       , 46.15      , 49.19285714, 50.71428571, 48.17857143,
       50.20714286, 49.7       , 50.20714286, 49.19285714, 49.19285714,
       49.7       , 50.71428571, 48.68571429, 50.20714286, 50.20714286,
       52.23571429, 49.7       , 49.19285714, 53.75714286, 46.15      ,
       52.23571429, 51.72857143, 48.17857143, 52.23571429, 50.71428571,
       49.19285714, 47.67142857, 51.22142857, 48.68571429, 47.67142857,
       49.19285714, 49.19285714, 50.20714286, 49.7       , 52.23571429,
       51.22142857, 49.7       , 48.17857143, 52.23571429, 51.72857143,
       55.27857143, 50.71428571, 53.25      , 52.09239497, 52.9773925 ,
       52.15931415, 54.79551317, 55.88960402, 56.15775148, 56.71321613,
       56.14531822, 54.27152775, 53.18845079, 51.58980471, 56.52740991,
       54.27041965, 53.90327795, 56.31186537, 52.85389383, 56.2498965 ,
       55.3230851 , 52.96168533, 54.83012442, 56.90657333, 56.1674208 ,
       57.87042139, 55.03640928, 61.33037799, 52.78255116, 53.94307754,
       54.84143382, 51.75248234, 56.48636007, 56.19388644, 54.60045215,
       53.89607373, 56.1067215 , 61.39098782, 60.03948235, 59.12081467,
       59.47145582, 56.87930169, 57.01821414, 55.0298334 , 57.57946143,
       59.89906647, 57.77073394, 56.61548298, 57.92039996, 59.38318439,
       57.60909694, 59.98242783, 55.18881162, 56.40744072, 56.98018785,
...
       82.65200072, 84.37440979, 91.3085265 , 79.96338712, 81.61261347,
       84.29581338, 88.81517149, 80.29882513, 77.40305079, 87.23796829,
       84.06027194, 91.38395098, 89.59787794, 91.62079733, 92.81936454,
       92.24137361, 76.43942909, 77.71863214, 88.55951887, 88.96395213,
       77.95509383, 82.74625965, 91.23181564, 92.76141866, 85.54573872,
       89.36846664, 89.10512726, 90.92382869, 90.97831844, 85.31646661,
       83.2178514 , 82.74694287, 84.24183082, 88.53873707, 84.24292413,
       77.67609253, 91.9678806 , 91.14871479, 84.65728687, 97.43958338,
       86.3573666 , 90.30806077, 86.76620237, 78.94318283, 89.86260498,
       86.70593948, 92.2386928 , 86.73034187, 81.02343959, 90.37105389,
       80.49576392, 85.51492889, 91.65871132, 88.5279465 , 94.06219176,
       87.13126778, 82.14414651, 83.48512537, 84.1944379 , 90.25150091,
       85.40245169, 84.7221104 , 74.23082134, 92.32109173, 85.30380521,
       86.94866672, 88.17681991, 79.07148226, 87.27725659, 93.07974128,
       87.50474804, 78.82336361, 88.3197443 , 89.21055719, 85.10846706,
       87.99056523, 84.5124126 , 87.9681095 , 83.8704532 , 89.92279315,
       89.15198916, 87.85582658, 83.9765828 , 94.82978854, 89.38589518,
       94.6727304 , 75.4419031 , 95.4900717 , 96.4306434 , 84.42186434,
       86.15102724, 83.64517681, 81.13556856, 90.92918567, 97.35113965,
       94.193379  ])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-2de1e21a-f09e-43b7-ba87-d900b934a51b" class="xr-section-summary-in" type="checkbox"><label for="section-2de1e21a-f09e-43b7-ba87-d900b934a51b" class="xr-section-summary">Indexes: <span>(1)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-index-name"><div>Longitud_obs</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-3a656779-75e9-484d-b158-91bfc038846a" class="xr-index-data-in" type="checkbox"><label for="index-3a656779-75e9-484d-b158-91bfc038846a" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
       ...
       786, 787, 788, 789, 790, 791, 792, 793, 794, 795],
      dtype='int64', name='Longitud_obs', length=796))</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-ac5c5769-4a97-404c-a620-faffd09c11da" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-ac5c5769-4a97-404c-a620-faffd09c11da" class="xr-section-summary">Attributes: <span>(6)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"><dt><span>created_at :</span></dt><dd>2023-09-14T16:29:41.264497</dd><dt><span>arviz_version :</span></dt><dd>0.16.0</dd><dt><span>inference_library :</span></dt><dd>pymc</dd><dt><span>inference_library_version :</span></dt><dd>5.7.2+21.gdfb05b689</dd><dt><span>modeling_interface :</span></dt><dd>bambi</dd><dt><span>modeling_interface_version :</span></dt><dd>0.13.0.dev</dd></dl></div></li></ul></div></div><br></div>
                      </ul>
                  </div>
            </li>
            
              </ul>
            </div>
            <style> /* CSS stylesheet for displaying InferenceData objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-sections.group-sections {
  grid-template-columns: auto;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt, dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
.xr-wrap{width:700px!important;} </style>
</div>
</div>
<div class="cell" data-execution_count="28">
<details>
<summary>Mostrar Código</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1"></a>ref <span class="op">=</span> <span class="fl">52.5</span></span>
<span id="cb47-2"><a href="#cb47-2"></a>y_ppc <span class="op">=</span> idata_dis.posterior_predictive[<span class="st">"Longitud"</span>].stack(sample<span class="op">=</span>(<span class="st">"chain"</span>, <span class="st">"draw"</span>))</span>
<span id="cb47-3"><a href="#cb47-3"></a>grid, pdf <span class="op">=</span> az.stats.density_utils._kde_linear(y_ppc.values)</span>
<span id="cb47-4"><a href="#cb47-4"></a>plt.plot(grid, pdf)</span>
<span id="cb47-5"><a href="#cb47-5"></a>percentile <span class="op">=</span> <span class="bu">int</span>((y_ppc <span class="op">&lt;=</span> ref).mean() <span class="op">*</span> <span class="dv">100</span>)</span>
<span id="cb47-6"><a href="#cb47-6"></a>plt.fill_between(</span>
<span id="cb47-7"><a href="#cb47-7"></a>    grid[grid <span class="op">&lt;</span> ref],</span>
<span id="cb47-8"><a href="#cb47-8"></a>    pdf[grid <span class="op">&lt;</span> ref],</span>
<span id="cb47-9"><a href="#cb47-9"></a>    label<span class="op">=</span><span class="st">"percentilo = </span><span class="sc">{:2d}</span><span class="st">"</span>.<span class="bu">format</span>(percentile),</span>
<span id="cb47-10"><a href="#cb47-10"></a>    color<span class="op">=</span><span class="st">"C1"</span>,</span>
<span id="cb47-11"><a href="#cb47-11"></a>)</span>
<span id="cb47-12"><a href="#cb47-12"></a>plt.xlabel(<span class="st">"Longitud"</span>)</span>
<span id="cb47-13"><a href="#cb47-13"></a>plt.yticks([])</span>
<span id="cb47-14"><a href="#cb47-14"></a>plt.legend()<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="06_Regresión_lineal_con_Bambi_files/figure-html/cell-29-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="predictores-categóricos" class="level2" data-number="7.6">
<h2 data-number="7.6" class="anchored" data-anchor-id="predictores-categóricos"><span class="header-section-number">7.6</span> Predictores Categóricos</h2>
<p>Una variable categórica representa distintos grupos o categorías. La variable solo puede tomar un conjunto limitado de valores de esas categorías. Estos valores suelen ser etiquetas o nombres que no poseen significado numérico por sí solos. Algunos ejemplos son:</p>
<ul>
<li>Afiliación política: conservadora, liberal o progresista.</li>
<li>Sexo: femenino o masculino.</li>
<li>Nivel de satisfacción del cliente: muy insatisfecho, insatisfecho, neutral, satisfecho o muy satisfecho.</li>
</ul>
<p>Los modelos de regresión lineal pueden acomodar fácilmente variables categóricas, solo necesitamos codificar las categorías como números. Hay algunas opciones para hacerlo. Bambi puede manejar fácilmente los detalles por nosotros. El diablo está en los detalles de como interpretamos los resultados.</p>
<section id="pingüinos-categóricos" class="level3" data-number="7.6.1">
<h3 data-number="7.6.1" class="anchored" data-anchor-id="pingüinos-categóricos"><span class="header-section-number">7.6.1</span> Pingüinos Categóricos</h3>
<p>Para el ejemplo actual, vamos a utilizar el conjunto de datos de <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0090081">Palmer Penguins</a>, que contiene 344 observaciones de 8 variables. Por el momento nos interesa modelar la masa de los pingüinos en función de la longitud de su pico. Se espera que la masa de los pingüinos aumente a medida que aumenta la longitud del pico. La novedad de este ejemplo es que vamos a considerar la variable categórica, <code>species</code>. Esta variable tiene 3 categorías o niveles, a saber, <code>Adelie</code>, <code>Chinstrap</code> y <code>Gentoo</code>. La <a href="#fig-scatter_pen">Figura&nbsp;<span>7.1</span></a> muestra un diagrama de dispersión para las variables que queremos modelar.</p>
<div class="cell" data-execution_count="29">
<details>
<summary>Mostrar Código</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1"></a>penguins <span class="op">=</span> pd.read_csv(<span class="st">"datos/penguins.csv"</span>).dropna()</span>
<span id="cb48-2"><a href="#cb48-2"></a>penguins.head()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="29">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>species</th>
      <th>island</th>
      <th>bill_length</th>
      <th>bill_depth</th>
      <th>flipper_length</th>
      <th>body_mass</th>
      <th>sex</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>3.91</td>
      <td>1.87</td>
      <td>18.1</td>
      <td>3.75</td>
      <td>male</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>3.95</td>
      <td>1.74</td>
      <td>18.6</td>
      <td>3.80</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>4.03</td>
      <td>1.80</td>
      <td>19.5</td>
      <td>3.25</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>3.67</td>
      <td>1.93</td>
      <td>19.3</td>
      <td>3.45</td>
      <td>female</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>3.93</td>
      <td>2.06</td>
      <td>19.0</td>
      <td>3.65</td>
      <td>male</td>
      <td>2007</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="30">
<details>
<summary>Mostrar Código</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1"></a><span class="co"># Get unique categories</span></span>
<span id="cb49-2"><a href="#cb49-2"></a>unique_categories <span class="op">=</span> np.unique(penguins.species)</span>
<span id="cb49-3"><a href="#cb49-3"></a></span>
<span id="cb49-4"><a href="#cb49-4"></a><span class="co"># Create color map for categories</span></span>
<span id="cb49-5"><a href="#cb49-5"></a>category_color_map <span class="op">=</span> {cat: <span class="ss">f"C</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> i, cat <span class="kw">in</span> <span class="bu">enumerate</span>(unique_categories)}</span>
<span id="cb49-6"><a href="#cb49-6"></a></span>
<span id="cb49-7"><a href="#cb49-7"></a><span class="co"># Generate colors for each category</span></span>
<span id="cb49-8"><a href="#cb49-8"></a>colors <span class="op">=</span> [category_color_map[cat] <span class="cf">for</span> cat <span class="kw">in</span> penguins.species]</span>
<span id="cb49-9"><a href="#cb49-9"></a></span>
<span id="cb49-10"><a href="#cb49-10"></a><span class="co"># Create scatter plot for each category</span></span>
<span id="cb49-11"><a href="#cb49-11"></a><span class="cf">for</span> cat <span class="kw">in</span> unique_categories:</span>
<span id="cb49-12"><a href="#cb49-12"></a>    category_data <span class="op">=</span> penguins[penguins.species <span class="op">==</span> cat]</span>
<span id="cb49-13"><a href="#cb49-13"></a>    plt.scatter(category_data.body_mass, category_data.bill_length, c<span class="op">=</span>category_color_map[cat], label<span class="op">=</span>cat)</span>
<span id="cb49-14"><a href="#cb49-14"></a></span>
<span id="cb49-15"><a href="#cb49-15"></a><span class="co"># Add labels and legend</span></span>
<span id="cb49-16"><a href="#cb49-16"></a>plt.ylabel(<span class="st">"Body mass (g)"</span>)</span>
<span id="cb49-17"><a href="#cb49-17"></a>plt.xlabel(<span class="st">"Bill length (mm)"</span>)</span>
<span id="cb49-18"><a href="#cb49-18"></a>plt.legend(labels<span class="op">=</span>unique_categories, loc<span class="op">=</span><span class="st">"lower right"</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-scatter_pen" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="06_Regresión_lineal_con_Bambi_files/figure-html/fig-scatter_pen-output-1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;7.1: Largo del pico (bill_length) vs masa (body_mass) para 3 especies de pingüinos.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Para ajustar un modelo con variables categoricas no necesitamos de ninguna sintáxis especial</p>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1"></a>modelo_p <span class="op">=</span> bmb.Model(<span class="st">"body_mass ~ bill_length + species"</span>, data<span class="op">=</span>penguins)</span>
<span id="cb50-2"><a href="#cb50-2"></a>idata_p <span class="op">=</span> modelo_p.fit()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [body_mass_sigma, Intercept, bill_length, species]</code></pre>
</div>
<div class="cell-output cell-output-display">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      <progress value="8000" class="" max="8000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [8000/8000 00:02&lt;00:00 Sampling 4 chains, 0 divergences]
    </div>
    
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 3 seconds.</code></pre>
</div>
</div>
<p>La <a href="#fig-penguins_posterior">Figura&nbsp;<span>7.2</span></a> muestra un forest plot para <code>model_p</code>. ¿Notás algo inesperado? No hay valores posteriores para <code>Adelie</code>. Esto no es un error. De forma predeterminada, Bambi codifica variables categóricas con <code>N</code> niveles (3 especies) como <code>N-1</code> variables (2 especies). Así, los coeficientes <code>species-Chinstrap</code> y <code>species-Gentoo</code> representan deflecciones del modelo base:</p>
<p><span class="math display">\[
\text{body\_mass} = \beta_0 + \beta_1 \text{bill\_length}
\]</span></p>
<div class="cell" data-execution_count="32">
<details>
<summary>Mostrar Código</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1"></a>ax <span class="op">=</span> az.plot_forest(idata_p, combined<span class="op">=</span><span class="va">True</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">3</span>))</span>
<span id="cb53-2"><a href="#cb53-2"></a>mean_chinstrap <span class="op">=</span> idata_p.posterior[<span class="st">"species"</span>].sel(species_dim<span class="op">=</span><span class="st">"Chinstrap"</span>).mean()</span>
<span id="cb53-3"><a href="#cb53-3"></a>mean_gentoo <span class="op">=</span> idata_p.posterior[<span class="st">"species"</span>].sel(species_dim<span class="op">=</span><span class="st">"Gentoo"</span>).mean()</span>
<span id="cb53-4"><a href="#cb53-4"></a>ax[<span class="dv">0</span>].annotate(<span class="ss">f"</span><span class="sc">{</span>mean_chinstrap<span class="sc">.</span>item()<span class="sc">:.2f}</span><span class="ss">"</span>, (mean_chinstrap , <span class="fl">2.5</span>), weight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb53-5"><a href="#cb53-5"></a>ax[<span class="dv">0</span>].annotate(<span class="ss">f"</span><span class="sc">{</span>mean_gentoo<span class="sc">.</span>item()<span class="sc">:.2f}</span><span class="ss">"</span>, (mean_gentoo , <span class="fl">1.7</span>), weight<span class="op">=</span><span class="st">'bold'</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-penguins_posterior" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="06_Regresión_lineal_con_Bambi_files/figure-html/fig-penguins_posterior-output-1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;7.2: Fores plot para la distribución a posteriori de <code>modelo_p</code>.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Para que esto quede más claro, revisemos un par de gráficos. Podemos leer la <a href="#fig-penguins_posterior">Figura&nbsp;<span>7.2</span></a> como que la masa corporal de <code>Chinstrap</code> es en promedio -0.89 respecto de la masa corporal media de <code>Adelie</code>. Lo mismo ocurre con <code>Gentoo</code>, pero esta vez tenemos que agregar 0,66 a la media del modelo base. Podés comprobar que estas dos afirmaciones son verdaderas mirando la <a href="#fig-penguins_predictions">Figura&nbsp;<span>7.3</span></a>. Observá cómo las 3 líneas son esencialmente paralelas entre sí con <code>Adelie</code> en el medio, <code>Chinstrap</code> debajo (-0,89) y <code>Gentoo</code> arriba (0,58).</p>
<div id="fig-penguins_predictions" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<details>
<summary>Mostrar Código</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1"></a>bmb.interpret.plot_predictions(modelo_p, idata_p, [<span class="st">"bill_length"</span>,  <span class="st">"species"</span>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-penguins_predictions-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<pre><code>(&lt;Figure size 3450x1500 with 1 Axes&gt;,
 array([&lt;Axes: xlabel='bill_length', ylabel='body_mass'&gt;], dtype=object))</code></pre>
<p></p><figcaption class="figure-caption">(a) Predicciones del ajuste medio para <code>modelo_p</code>.</figcaption><p></p>
</figure>
</div>
<div class="cell-output cell-output-display">
<div id="fig-penguins_predictions-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="06_Regresión_lineal_con_Bambi_files/figure-html/fig-penguins_predictions-output-2.png" class="img-fluid figure-img" data-ref-parent="fig-penguins_predictions"></p>
<p></p><figcaption class="figure-caption">(b)</figcaption><p></p>
</figure>
</div>
</div>
<p></p><figcaption class="figure-caption">Figura&nbsp;7.3: <strong>?(caption)</strong></figcaption><p></p>
</figure>
</div>
</section>
<section id="relación-con-modelos-jerárquicos" class="level3" data-number="7.6.2">
<h3 data-number="7.6.2" class="anchored" data-anchor-id="relación-con-modelos-jerárquicos"><span class="header-section-number">7.6.2</span> Relación con modelos jerárquicos</h3>
<p>En el <a href="03_Modelos_jerárquicos.html"><span>Capítulo&nbsp;4</span></a> analizamos y contrastamos los modelos agrupados y jerárquicos (o parcialmente agrupados). Allí mostramos que a menudo podemos aprovechar la estructura o las jerarquías de los datos. Siguiendo la lógica de ese capítulo, se podría argumentar que <code>Adelie</code>, <code>Gentoo</code> y <code>Chinstrap</code>, aunque son especies diferentes, son todos pingüinos. Por lo tanto, modelar jerárquicamente sus masas corporales puede ser una buena idea. Entonces, ¿Cuál es la diferencia entre dicho modelo y el que utilizamos en esta sección?</p>
<p>El factor distintivo reside en las sutilezas de los componentes de pendiente e intersección. En el caso de <code>model_p</code> (variables categóricos), la pendiente sigue siendo la misma en las tres especies de pingüinos, mientras que los interceptos pueden variar. <code>Intercept + 0</code> para <code>Adelie</code>, <code>Intercept + species[Chinstrap]</code> para Chinstrap, y <code>Intercept + species[Gentoo]</code> para <code>Gentoo</code>. Por lo tanto, este modelo resalta los distintos incerceptos manteniendo la pendiente uniforme.</p>
<p>Si, en cambio, hubiéramos construido el modelo jerárquico <code>body_mass ~ bill_length|species)</code>, habríamos estado pidiendo una pendiente y un intercepto parcialmente agrupados. Y si en lugar de eso hubiéramos modelado <code>body_mass ~ (0 + bill_length | specie)</code> habríamos estado pidiendo una pendiente parcialmente agrupada y un intercepto común.</p>
<p>Entonces, ¿Cuál es mejor modelo? Como siempre, depende, incluso en algunos casos podría ser mejor una combinación de ambos enfoques, ya que no son ideas mutuamente excluyentes. Como ya comentamos, el <em>mejor</em> modelo es el que se alinea con los objetivos de tu análisis y proporciona información útil. A menudo es una buena idea explorar múltiples modelos, comparar su desempeño usando criterios apropiados (como los discutidos en el <a href="07_Comparación_de_modelos.html"><span>Capítulo&nbsp;8</span></a> y considerar las implicaciones prácticas de cada modelo en el contexto de la investigación o proceso de toma de decisiones.</p>
</section>
</section>
<section id="interacciones" class="level2" data-number="7.7">
<h2 data-number="7.7" class="anchored" data-anchor-id="interacciones"><span class="header-section-number">7.7</span> Interacciones</h2>
<p>Un efecto de interacción o interacción estadística, ocurre cuando el efecto de una variable independiente sobre la respuesta cambia dependiendo del valor de otra variable independiente en el mismo modelo. Una interacción puede ocurrir entre dos o más variables. Algunos ejemplos son:</p>
<ul>
<li>Eficacia de los medicamentos y edad: un medicamento que funciona mejor en personas mayores que en personas más jóvenes</li>
<li>Nivel de educación e impacto en los ingresos: Es posible que la educación superior tenga un efecto positivo más fuerte en los ingresos de un género en comparación con el otro, lo que resulta en una interacción entre la educación y el género.</li>
<li>Efectos del ejercicio y la dieta sobre la pérdida de peso: Podría ser que el efecto de la dieta sobre la pérdida de peso sea pequeño para las personas que hacen nada o poco ejercicio y muy importante para las personas que hacen ejercicio moderado.</li>
<li>*Temperatura y humedad para el crecimiento de los cultivos: El efecto de la temperatura y la humedad en el crecimiento de los cultivos puede depender del tipo de cultivo que se esté cultivando. Algunos cultivos podrían prosperar en condiciones cálidas y húmedas, mientras que otros podrían funcionar mejor en ambientes más fríos y menos húmedos, creando una interacción entre temperatura, humedad y tipo de cultivo.</li>
</ul>
<p>Tenemos una interacción cuando el efecto combinado de dos o más variables actuando conjuntamente no es igual a la suma de sus efectos individuales. Si tenemos un modelo como</p>
<p><span class="math display">\[
\mu = \alpha + \beta_0 X_0 + \beta_1 X_1
\]</span></p>
<p>no podemos modelar un interacción, ya que los efectos son aditivos. La forma más común de modelar una interacción es multiplicando 2 o más variables. Por ejemplo en un modelo como:</p>
<p><span class="math display">\[
\mu = \alpha + \overbrace{\beta_0 X_0 + \beta_1 X_1 }^{\text{término principal}} \; + \underbrace{\beta_3 X_0X_1}_{\text{término de interacción}}
\]</span></p>
<p>Es común que al modelar una interacción se incluya también el término principal.</p>
<blockquote class="blockquote">
<p>Multiplicar dos variables puede verse como un truco similar al que usamos para la regresión polinómica (o cualquier transformación de una variable determinada). En lugar de multiplicar un predictor consigo mismo, multiplicamos dos predictores diferentes y obtenemos uno nuevo.</p>
</blockquote>
<p>Definir una interacción es fácil; para un modelo PyMC, solo necesitamos multiplicar los dos predictores y agreagar un coeficiente más al modelo. Para que un modelo de Bambi es aún más fácil, usamos el operador <code>:</code>. Veamos un ejemplo de un modelo con y sin interacciones.</p>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1"></a><span class="co"># Sin interacción</span></span>
<span id="cb56-2"><a href="#cb56-2"></a>model_noint <span class="op">=</span> bmb.Model(<span class="st">"body_mass ~ bill_depth + bill_length"</span>, data<span class="op">=</span>penguins)</span>
<span id="cb56-3"><a href="#cb56-3"></a>idata_noint <span class="op">=</span> model_noint.fit()</span>
<span id="cb56-4"><a href="#cb56-4"></a></span>
<span id="cb56-5"><a href="#cb56-5"></a><span class="co"># COn interacción</span></span>
<span id="cb56-6"><a href="#cb56-6"></a>model_int <span class="op">=</span> bmb.Model(<span class="st">"body_mass ~ bill_depth + bill_length + bill_depth:bill_length"</span>, data<span class="op">=</span>penguins)</span>
<span id="cb56-7"><a href="#cb56-7"></a>idata_int <span class="op">=</span> model_int.fit()</span>
<span id="cb56-8"><a href="#cb56-8"></a>                    </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [body_mass_sigma, Intercept, bill_depth, bill_length]</code></pre>
</div>
<div class="cell-output cell-output-display">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      <progress value="8000" class="" max="8000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [8000/8000 00:02&lt;00:00 Sampling 4 chains, 0 divergences]
    </div>
    
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 3 seconds.
Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [body_mass_sigma, Intercept, bill_depth, bill_length, bill_depth:bill_length]</code></pre>
</div>
<div class="cell-output cell-output-display">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      <progress value="8000" class="" max="8000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [8000/8000 00:16&lt;00:00 Sampling 4 chains, 0 divergences]
    </div>
    
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 16 seconds.</code></pre>
</div>
</div>
<p>En la <a href="#fig-interaction_vs_noninteraction">Figura&nbsp;<span>7.4</span></a> tenemos el ajuste de regresión media para <code>bill_depth</code> evaluado en 5 valores fijos de <code>bill_length</code>. A la izquierda tenemos el resultado dpara <code>model_noint</code> (sin interacciones) y a la derecha para <code>model_int</code> (con interacciones). Podemos ver que cuando no tenemos interacciones las rectas ajustadas para <code>bill_ depth</code> son paralelas en diferentes niveles de <code>bill_length</code>. En cambio, cuando tenemos interacciones las rectas ya no son paralelas, precisamente porque el efecto de cambiar <code>bill_depth</code> sobre cuánto cambia <code>body_mass</code> ya no es constante sino que está modulado por los valores de <code>bill_length</code>. Si generás una figura como <a href="#fig-interaction_vs_noninteraction">Figura&nbsp;<span>7.4</span></a>, pero fijando <code>bill_depth</code> en vez de <code>bill_length</code> observarás un fenómeno parecido.</p>
<div class="cell" data-execution_count="35">
<details>
<summary>Mostrar Código</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1"></a>_, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="fl">4.5</span>), gridspec_kw<span class="op">=</span>{<span class="st">'hspace'</span>: <span class="fl">0.1</span>})</span>
<span id="cb60-2"><a href="#cb60-2"></a></span>
<span id="cb60-3"><a href="#cb60-3"></a>bmb.interpret.plot_predictions(model_noint, idata_noint,</span>
<span id="cb60-4"><a href="#cb60-4"></a>                                [<span class="st">"bill_depth"</span>,  <span class="st">"bill_length"</span>],</span>
<span id="cb60-5"><a href="#cb60-5"></a>                                ax<span class="op">=</span>axes[<span class="dv">0</span>],</span>
<span id="cb60-6"><a href="#cb60-6"></a>                                legend<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb60-7"><a href="#cb60-7"></a>                                )</span>
<span id="cb60-8"><a href="#cb60-8"></a>axes[<span class="dv">0</span>].set_title(<span class="st">"Sin interacción"</span>)</span>
<span id="cb60-9"><a href="#cb60-9"></a></span>
<span id="cb60-10"><a href="#cb60-10"></a></span>
<span id="cb60-11"><a href="#cb60-11"></a>bmb.interpret.plot_predictions(model_int, idata_int,</span>
<span id="cb60-12"><a href="#cb60-12"></a>                               [<span class="st">"bill_depth"</span>,  <span class="st">"bill_length"</span>],</span>
<span id="cb60-13"><a href="#cb60-13"></a>                                ax<span class="op">=</span>axes[<span class="dv">1</span>],</span>
<span id="cb60-14"><a href="#cb60-14"></a>                                )</span>
<span id="cb60-15"><a href="#cb60-15"></a>axes[<span class="dv">1</span>].set_title(<span class="st">"Con interacción"</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-interaction_vs_noninteraction" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="06_Regresión_lineal_con_Bambi_files/figure-html/fig-interaction_vs_noninteraction-output-1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;7.4: Comparación de un modelo sin interacción (las lineas se mantienen paralelas) y con interacción (las lineas se cruzan).</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Acabamos de ver visualmente que interpretar modelos lineales con interacciones no es tan fácil como interpretar modelos lineales sin ellas. Veamos esto matemáticamente:</p>
<p>Supongamos que tenemos un modelo con 2 variables <span class="math inline">\(X_0\)</span> y <span class="math inline">\(X_1\)</span> y una interacción entre ellas:</p>
<p><span class="math display">\[
     \mu = \alpha + \beta_0 X_0 + \beta_1 X_1 + \beta_3 X_0X_1
\]</span></p>
<p>podemos reescribir este modelo como:</p>
<p><span class="math display">\[
\mu = \alpha + \underbrace{{(\beta_0 + \beta_2} X_1)}_{\text{pendiente de } X_0} X_0 + \beta_1 X_1
\]</span></p>
<p>o así:</p>
<p><span class="math display">\[
\mu = \alpha + \beta_0 X_0 + \underbrace{(\beta_1 + \beta_2 x_0)}_{\text{pendiente de } X_1} X_1
\]</span></p>
<p>Esto nos muestra el siguiente gráfico de Fores para la distribución a posteriori de:</p>
<ul>
<li>¡El término de interacción puede entenderse como un modelo lineal dentro de un modelo lineal!</li>
<li>La interacción es simétrica; podemos pensar en ello como la pendiente de <span class="math inline">\(x_0\)</span> en función de <span class="math inline">\(x_1\)</span> y al mismo tiempo como la pendiente de <span class="math inline">\(x_1\)</span> en función de <span class="math inline">\(x_0\)</span>. Esto también se puede ver en la figura interactiva.</li>
<li>Sabemos desde antes que el coeficiente <span class="math inline">\(\beta_0\)</span> se puede interpretar como la cantidad de cambio de <span class="math inline">\(\mu\)</span> por unidad de cambio de <span class="math inline">\(x_0\)</span> (por eso lo llamamos pendiente). Si agregamos un término de interacción, entonces esto solo es cierto en <span class="math inline">\(x_1 = 0\)</span>. Intente utilizar la figura interactiva para verlo usted mismo. Matemáticamente, esto es cierto porque cuando <span class="math inline">\(x_1 = 0\)</span> entonces <span class="math inline">\(\beta_2x_1 = 0\)</span>, y por lo tanto la pendiente de <span class="math inline">\(x_0\)</span> se reduce a <span class="math inline">\(\beta_0 x_0\)</span>. Por simetría, el mismo razonamiento se puede aplicar a <span class="math inline">\(\beta_1\)</span>. \end{detallar}</li>
</ul>
</section>
<section id="interpretando-modelos-con-bambi" class="level2" data-number="7.8">
<h2 data-number="7.8" class="anchored" data-anchor-id="interpretando-modelos-con-bambi"><span class="header-section-number">7.8</span> Interpretando modelos con Bambi</h2>
<p>Ya hemos usado <code>bmb.interpret_plot_predictions</code> en este capítulo. Pero esa no es la única herramienta que nos ofrece Bambi para ayudarnos a comprender los modelos. Otra opción es <code>bmb.interpret_plot_comparisons</code>. Esta herramienta nos ayuda a responder la pregunta: ¿Cuál es la diferencia predictiva esperada cuando comparamos dos valores de una variable determinada mientras mantenemos el resto en valores constantes?</p>
<p>Como ejemplo usemos <code>model_int</code>, que ya ajustamos en la sección anterior.</p>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1"></a>bmb.interpret.plot_comparisons(model_int, idata_int,</span>
<span id="cb61-2"><a href="#cb61-2"></a>                               contrast<span class="op">=</span>{<span class="st">"bill_depth"</span>:[<span class="fl">1.4</span>, <span class="fl">1.8</span>]},</span>
<span id="cb61-3"><a href="#cb61-3"></a>                               conditional<span class="op">=</span>{<span class="st">"bill_length"</span>:[<span class="fl">3.5</span>, <span class="fl">4.5</span>, <span class="fl">5.5</span>]})<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-interaction_comparisons" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="06_Regresión_lineal_con_Bambi_files/figure-html/fig-interaction_comparisons-output-1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;7.5: Contraste de para <code>bill_length</code> de 1,8 a 1,4 cm para 3 valores fijos de <code>bill_length</code>, 3.5, 4.5 y 5.5.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><a href="#fig-interaction_comparisons">Figura&nbsp;<span>7.5</span></a> muestra que al comparar un pingüino hipotético con profundidad de pico (<code>bill_depth</code>) de 1,8 con uno con profundida de pico de 1,4, la diferencia esperada es:</p>
<ul>
<li>aproximadamente 0,8 kg para un pico de 3,5 de longitud</li>
<li>-0,7 kg para un pico de 4,5 de largo</li>
<li>aproximadamente -2 kg para un pico de 5,5 de largo</li>
</ul>
<p>Para obtener esta misma información, pero en forma de tabla podemos usar la función <code>bmb.interpret.comparisons</code> y obtendremos un DataFrame de Pandas.</p>
<div class="cell" data-execution_count="37">
<details>
<summary>Mostrar Código</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1"></a>bmb.interpret.comparisons(model_int, idata_int,</span>
<span id="cb62-2"><a href="#cb62-2"></a>                          contrast<span class="op">=</span>{<span class="st">"bill_depth"</span>:[<span class="fl">1.4</span>, <span class="fl">1.8</span>]},</span>
<span id="cb62-3"><a href="#cb62-3"></a>                          conditional<span class="op">=</span>{<span class="st">"bill_length"</span>:[<span class="fl">3.5</span>, <span class="fl">4.5</span>, <span class="fl">5.5</span>]})</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="37">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>term</th>
      <th>estimate_type</th>
      <th>value</th>
      <th>bill_length</th>
      <th>estimate</th>
      <th>lower_3.0%</th>
      <th>upper_97.0%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>bill_depth</td>
      <td>diff</td>
      <td>(1.4, 1.8)</td>
      <td>3.5</td>
      <td>0.767716</td>
      <td>0.503219</td>
      <td>1.035987</td>
    </tr>
    <tr>
      <th>1</th>
      <td>bill_depth</td>
      <td>diff</td>
      <td>(1.4, 1.8)</td>
      <td>4.5</td>
      <td>-0.567180</td>
      <td>-0.667925</td>
      <td>-0.455735</td>
    </tr>
    <tr>
      <th>2</th>
      <td>bill_depth</td>
      <td>diff</td>
      <td>(1.4, 1.8)</td>
      <td>5.5</td>
      <td>-1.902077</td>
      <td>-2.171324</td>
      <td>-1.652258</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Otra función muy útil es Otra función útil es <code>bmb.interpret_plot_slopes</code>. Esta función es similar a <code>bmb.interpret_plot_comparison</code>, la “tasa de cambio instantánea” o pendiente en un valor dado.</p>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1"></a>bmb.interpret.plot_slopes(model_int, idata_int,</span>
<span id="cb63-2"><a href="#cb63-2"></a>                          wrt<span class="op">=</span>{<span class="st">"bill_depth"</span>:<span class="fl">1.8</span>},</span>
<span id="cb63-3"><a href="#cb63-3"></a>                          conditional<span class="op">=</span>{<span class="st">"bill_length"</span>:[<span class="fl">3.5</span>, <span class="fl">4.5</span>, <span class="fl">5.5</span>]})<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-interaction_slopes" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="06_Regresión_lineal_con_Bambi_files/figure-html/fig-interaction_slopes-output-1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;7.6: Comparación de las pendientes de bill_depth evaluada en 1.8 para tres valores de <code>bill_length</code>, 3.5, 4.5 y 5.5.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>La <a href="#fig-interaction_slopes">Figura&nbsp;<span>7.6</span></a> muestra que las pendientes para <code>bill_depth</code> en 1.8 son:</p>
<ul>
<li><span class="math inline">\(\approx\)</span> 2 kg/cm para un largo de pico de 3.5</li>
<li>-1.4 kg/cm para un largo de pico de4.5</li>
<li><span class="math inline">\(\approx\)</span> -5 kg/cm para un largo de pico de 5.5</li>
</ul>
<p>Si deseas esta información en forma tabular, podés usar: la función <code>bmb.interpret.slopes</code> y obtendrás un DataFrame en lugar de un gráfico.</p>
<div class="cell" data-execution_count="39">
<details>
<summary>Mostrar Código</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1"></a>bmb.interpret.slopes(model_int, idata_int,</span>
<span id="cb64-2"><a href="#cb64-2"></a>                     wrt<span class="op">=</span>{<span class="st">"bill_depth"</span>:<span class="fl">1.8</span>},</span>
<span id="cb64-3"><a href="#cb64-3"></a>                     conditional<span class="op">=</span>{<span class="st">"bill_length"</span>:[<span class="fl">3.5</span>, <span class="fl">4.5</span>, <span class="fl">5.5</span>]})</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="39">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>term</th>
      <th>estimate_type</th>
      <th>value</th>
      <th>bill_length</th>
      <th>estimate</th>
      <th>lower_3.0%</th>
      <th>upper_97.0%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>bill_depth</td>
      <td>dydx</td>
      <td>(1.8, 1.8001)</td>
      <td>3.5</td>
      <td>1.919289</td>
      <td>1.258048</td>
      <td>2.589967</td>
    </tr>
    <tr>
      <th>1</th>
      <td>bill_depth</td>
      <td>dydx</td>
      <td>(1.8, 1.8001)</td>
      <td>4.5</td>
      <td>-1.417951</td>
      <td>-1.669811</td>
      <td>-1.139338</td>
    </tr>
    <tr>
      <th>2</th>
      <td>bill_depth</td>
      <td>dydx</td>
      <td>(1.8, 1.8001)</td>
      <td>5.5</td>
      <td>-4.755192</td>
      <td>-5.428310</td>
      <td>-4.130645</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>En esta sección, apenas hemos arañado la superficie de lo que podemos hacer con las herramientas del módulo <code>bmb.interpret</code>. Este módulo es una característica muy útil de Bambi, especialmente para modelos con interacciones y/o modelos con funciones de enlace distintas a la función de identidad. Les recomiendo que lea la <a href="https://bambinos.github.io/bambi/notebooks/#tools-to-interpret-model-outputs">documentación</a> de Bambi para obtener más ejemplos y detalles que no se tratan aquí.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./05_Regresión_lineal.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Regresión lineal</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./07_Comparación_de_modelos.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Comparación de modelos</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center"><a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Licencia Creative Commons" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png"></a><br>Este obra está bajo <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">licencia Creative Commons Reconocimiento 4.0 Internacional</a>.</div>
  </div>
</footer>



</body></html>